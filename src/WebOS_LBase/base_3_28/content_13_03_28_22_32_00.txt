首页 | 互联网 | IT动态 | IT培训 | Cisco | Windows | Linux | Java | .Net | Oracle | 软件测试 | C/C++ | 嵌入式开发 | 存储世界 | 服务器 
网络设备 | IDC | 安全 | 求职招聘 | 数字网校 | 笔记本电脑 | 北大青鸟 | 技术专题 | 电子书下载 | 教学视频 | 源码下载 | 搜索 | 博客 | 论坛
 
 
  	
  
首 页认 证教 材路 由交 换网 管协 议无 线安 全综 合产 品方 案动 态RSS订阅专 题
您现在的位置： 中国IT实验室 >> Cisco >> 网络管理 >> 网络配置 >> 正文
NAT的原理及其注意事项
【央邦】考试通过，才付培训费
Cisco远程课堂足不出户 随即学习考证！ 
探访CCIE黄埔军校 解密IT金领造梦工厂
【安博亚威】CCIE考试通过率第一！
Cisco网络技术系列讲座
贺深圳北大青鸟信狮学校学员100%就业
ChinaItLab    2002-7-26 10:06:00  保存本文  推荐给好友  收藏本页

　　IP地址耗尽促成了CIDR的开发，但CIDR开发的主要目的是为了有效的使用现有的internet地址。而同时根据RFC 1631（IP Network Address Translator）开发的NAT却可以在多重的internet子网中使用相同的IP，用来减少注册IP地址的使用。
　　NAT技术使得一个私有网络可以通过internet注册IP连接到外部世界，位于inside网络和outside网络中的NAT路由器在发送数据包之前，负责把内部IP翻译成外部合法地址。内部网络的主机不可能同时于外部网络通信，所以只有一部分内部地址需要翻译。
　　NAT的翻译可以采取静态翻译（static translation）和动态翻译（dynamic translation）两种。静态翻译将内部地址和外部地址一对一对应。当NAT需要确认哪个地址需要翻译，翻译时采用哪个地址pool时，就使用了动态翻译。采用port
　　multiplexing技术，或改变外出数据的源port技术可以将多个内部IP地址影射到同一个外部地址，这就是PAT（port address translator）。
　　当影射一个外部IP到内部地址时，可以利用TCP的load distribution技术。使用这个特征时，内部主机基于round-robin机制，将外部进来的新连接定向到不同的主机上去。注意：load distributiong只有在影射外部地址到内部的时候才有效。
　　
　　NAT使用的几种情况：
　　a，连接到internet，但却没有足够的合法地址分配给内部主机。
　　b，更改到一个需要重新分配地址的ISP。
　　c，有相同的IP地址的两个internat合并。
　　d，想支持负载均衡（主机）。
　　
　　采用NAT后，一个最主要的改变就是你失去了端对端IP的traceability，也就是说，从此
　　你不能再经过NAT使用ping和traceroute，其次就是曾经的一些IP对IP的程序不再可以正常运行，潜在的不易被观察到的缺点就是增加了网络延时。
　　
　　NAT可以支持大部分IP协议，但有几个协议需要注意，首先tftp，rlogin,rsh,rcp和ip
　　multicast都被NAT支持，其次就是bootp，snmp和路由表更新全部给拒绝了。
　　
　　NAT的几个相关概念：
　　Inside Local IP address: 指定于内部网络的主机地址，全局唯一，但为私有地址。
　　Inside Global IP address: 代表一个或更多内部IP到外部世界的合法IP。
　　Outside Global IP address: 外部网络主机的合法IP。
　　Outside Local IP address: 外部网络的主机地址，看起来是内部网络的，私有地址。
　　Simple Translation Entry: 影射IP到另一个地址的Entry。
　　Extended Translation Entry:影射IP地址和端口到另一个pair的Entry。
　　采用NAT，可以实现以下几个功能：
　　a，Translation inside local addresses
　　b，Overloading inside global addresses
　　c，TCP load distribution
　　d，Handing overlapping networks
　　下面我们一一叙述它们的工作原理。
　　
　　a，内部地址翻译（Translation inside local addresses)：
　　这是比较通用的一种方法，将内部IP一对一的翻译成外部地址。
　　在内部主机连接到外部网络时，当第一个数据包到达NAT路由器时，router检查它的NAT表，因为是NAT是静态配置的，故可以查询出来（simply entry），然后router将数据包的内部局部IP（源地址）更换成内部全局地址，再转发出去。外部主机接受到数据包用接受到的内部全局地址来响应，NAT接受到外部回来的数据包，再根据NAT表把地址翻译成内部局部IP，转发过去。
　　b，内部全局地址复用（overloading inside glogal addresses）
　　使用地址和端口pair将多个内部地址影射到比较少的外部地址。这也是所谓的PAT。和内部地址翻译一样，NAT router同样也负责查表和翻译内部IP地址，唯一的区别就是由于使用了overloading，router将复用同样的内部全局IP地址，并存储足够的信息以区分它和其他地址，这样查询出来的是extended entry。
　　NAT router和外部主机的通讯采用翻译过的内部全局地址，故同一般的通信没有差别，router到内部主机通讯时，同样要查NAT表。
　　
　　c，TCP负载重分配（TCP load distributing）和以上两种操作不同，这是NAT由外到内的翻译，所以那种以为WEB server一定要放置到
　　NAT外部的说法是错误的。
　　工作原理：外部主机向虚拟主机（定义为内部全局地址）通讯，NAT router接受外部主机的请求并依据NAT表建立与内部主机的连接，把内部全局地址（目的地址）翻译成内部局部地址，并转发数据包到内部主机，内部主机接受包并作出响应。NAT router再使用内部局部地址和端口查询数据表，根据查询到的外部地址和端口做出响应。
　　此时，如果同一主机再做第二个连接，NAT router将根据NAT表将建立与另一虚拟主机的连接，并转发数据。
　　
　　d，处理重叠网络。
　　这种方法主要用于两个intranet的互连，同样给我们处理两个重叠网络提供了方法。它的实现要求DNS server的支持（用于区别两个不同的主机）。
　　1，主机A要求向主机C建立连接，先象DNS server做地址查询。
　　2，NAT router截获DNS的响应，如果地址有重叠，将翻译返回的地址。它将创建一个simply entry把重叠的外部全局地址（目的地址）翻译成外部局部地址。
　　3，路由器转发DNS响应到主机A，它已经把主机C的地址（外部全局地址）翻译成外部局部地址。
　　4，当路由器接受到主机C的数据包时，它将建立内部局部、全局，外部全局、局部地址间的转换，主机A将由内部局部地址（源地址）翻译成内部全局地址，主机C将由外部全局地址（目的地址）翻译成外部局部地址。
　　5，主机C接受数据包并继续通讯。
　　
　　=NAT的具体配置和校验不再叙述
　　
　　测试题目：
　　1，请问NAT实现四种功能时查询的NAT表格是否相同，如果不同，说出它们的区别。
　　2，在使用动态地址翻译时，要使用ACL，请问标准的和扩展的ACL都可以使用吗？
　　3，在配置NAT后，所有数据包的交换可以走fast-switch吗？
　　4，如果NAT router没有在NAT表格中查询到NAT地址影射，它如何处理发自内部主机的数据包？
　　5，NAT操作时，由外到内和由外到内的翻译是否相同？
　　6，我们是否可以将我们的WEB SERVER放置到配置了NAT的router后的LAN里？
　　7，使用simply entry的是NAT的哪种操作方式？
　　8，在哪种操作中更换IP数据包的目的地址，又在实现什么功能时更改源地址？
　　
 
   【责编:admin】
文章评论

相关文章
关于cisco设备privilege的配置经验谈
各显神通，更改网络配置信手拈来
Tunnel链路的帧中继网络配置
服务器虚拟化对网络配置有何影响？
网络部署实战：合理配置企业帧中继网络
借用外力，让网络配置随人而动
广播型多路访问网络配置OSPF
顺藤摸瓜 揪出网络堵塞幕后黑手
新鲜不复杂，电力线上网实现指南(图)
网络基础：机房内网络设备布局设计(图)
编辑推荐
· [交换基础]cisco交换机端口隔离的实现方法
· [交换基础]以太网交换机真正核心在哪
· [其他协议]广域网协议的交换和路由设定
· [其他协议]网络层次协议和结构体系之间的关系
· [路由配置]通过路由器基础设置 使网络更加安全
· [故障排除]路由器升级错误 引发网页打开失败故障
· [交换基础]cisco交换机端口隔离的实现方法
· [路由配置]在路由器上配置自反访问控制列表
· [路由配置]在路由器上配置动态访问控制列表
· [防火墙]ARP协议的概念和防火墙

相关产品和培训

　友情推荐精华
·Asp源码 PHP源码
·CGI源码 JSP源码
·建站书籍教程
·服务器软件 .net源码
·建站工具软件 
·IDC资讯大全
·机房品质万里行
·IDC托管必备知识
·网站推广优化
·全国IDC报价
 
 　专题推荐

　·看思科认证发展未来
　·职业规划从高考专业选择开始
　·从菜鸟到专家 cisco认证系列问答
　·循序渐进认识WEB服务器
　·如何走出高考的失意园
　·邮件系统--从原理到应用
　·无名英雄--组播的世界
　·如何做一个合格的Oracle DBA？
　·网管员：网络机房机房管理应杜绝空白
　·高速宽带不是梦 了解光纤接入技术
　今日更新
· 森林防火无线监控
· CDN和P2P技术融合组网方案探讨
· 无线点菜餐饮管理系统组网方案
· 村村通电信语音组网方案
· 思科Catalyst交换机升级
· 未来数据网络关键设备—光交换机
· 软交换技术与H.323协议
· EIGRP路由协议简介
· 如何学习CCNP
· 新版CCNP认证的新考点难点解析
　认证培训
· 亚威七周年庆--报NP送NA，更多优惠
· 5万年薪起送WEB2.0企业级项目!限招!
· No.1高薪热门 网络系统集成
· 全能网管思科微软黄金组合
· 浙江杭州CISCO培训
· [上海]交大慧谷CCNP培训特价3990元
　频道精选
· 新版CCNA考试大纲 07年8月1日生效
· 新手学习宝典：Linux常用命令全集
· 知已知彼，深入了解系统安全知识
· 从入门到精通 java初学者实践系列教程
· 共同学习——Oracle入门基础专题
· ADO.net与PowerBuilder的综合比较
· 评论：中国互联网“钱”途何在？
· 中科院：龙芯要成"中国奔腾" 能卖1亿颗
　思科频道导航
资讯动态
解决方案：
组网方案 | 配置实例 | 案例分析
综合技术：
多播 | MPLS | VOIP | Qos | 传输介质 
路由技术：
路由配置 | 路由应用 | IOS | 路由基础
交换技术：
交换基础 | 三层交换 | 配置 | 交换故障
网络管理：
VLan | 网管 | 故障排除 | 布线
网络协议：
OSPF | RIP | TCP／IP | 其他协议
安全技术：
VPN | 防火墙 | 攻防 | ACL | 安全 | IDS
无线技术：
802.11 | WLAN | 无线通信

