分享
应用程序
公共主页
人人生活
人人小组
同名同姓
校园百科
大学百科
人人热点
人人小站
人人逛街
人人校招

注册
登录
帮助
给我们提建议
更多
加入人人网，找回老朋友，结交新朋友。
加入人人网
分享 返回分享首页»
分享
VB程序
来源： 張天奇❤Q﹏的日志
1. 

 
 	 
子程序

 
 	 
 

 

 

 
 	 
2. 变量及变量说明

#01   Sub  Command1_Click()

    #02     Dim  r,a,s  As  Double

    #03     r = Val(Text1.Text)

    #04     a = Val(Text2.Text)

    #05     s = 3.1416 * r * r * a / 360

    #06     Text3.Text = Str(s)

    #07   End Sub

3. 语句与表达式

 

 

 

 

 

 

r = Val(Text1.Text)

把用户在文本框Text1中输入的数据（一个数字串，表示半径），变换为双精度实数类型的数据后，存入变量r中，#04行的语句

                a = Val(Text2.Text)

从文本框Text2中获得扇形的圆心角度数存储到变量a，这样，事件处理过程获得了计算所需的原始数据。#05行的语句

                s = 3.1416 * r * r * a / 360

4. VB结构

VB应用程序是按照“工程”的形式组织起来的。一个应用程序的窗体、与窗体上的对象有关的信息以及程序设计者编制的事件处理过程的代码，都存储在窗体文件中（窗体文件的扩展名为“.frm”），与该应用程序的构造相关的信息则存储到工程文件中（工程文件的扩展名为“.vbp”）。

 

 

 

5.几种程序:

(1) 计算并联电阻

用VB实现计算n个电阻并联的总电阻值。程序要求：依次输入各电阻值，最后输出总电阻值。

分析与设计：

在第2章的例2-3中，已经分析并设计了计算并联电阻的算法。根据图2.5所示的流程图，在不考虑界面设计的情况下，只用一个Label控件显示运行结果，其VB程序代码如下：

Private Sub Form_Load()

Dim r, rs As Double

rs = 0

r = Val(InputBox("输入一个电阻值（0结束）："))

Do While r > 0

  rs = rs + 1 / r

r = Val(InputBox("输入一个电阻值（0结束）："))

Loop

Label1.Caption = "并联的阻值为：" + Str(1 / rs)

End Sub

 

图4.1 运行的输入窗口（InputBox）

上面的程序是调用窗体Form时执行的，执行时等待用户输入数据，如图4.1所示。由于InputBox接受用户输入的是字符串，与变量r的数据类型不一致，所以通过val(x)函数将字符转为数值。如用户依次输入10、10、0，执行效果如图4.2所示，Label1显示出结果5。

 

 

      图4.2 运行结果示例

 

  技术支持：

1. 选择语句

在算法中，某项处理或某些处理是有条件的，或者说是有选择的，程序设计语言都设置了相关的语句。如在计算并联电阻时，要先判断输出的电阻值是否用效（大于0），在有效的情况下再进行运算。

VB提供的选择语句主要形式是if语句，另外还有select case语句，这里介绍if语句。

If语句有两种格式，一是行if语句，二是块if语句，前者是在一行内完成，后者是多行内完成。前者主要是针对满足条件、不满足条件时选择的是一个语句的情况，后者是满足条件或不满足条件时选择的是多个语句的情况。当然不管是选择一个或多个，都可以用块if语句的格式。

 

 

 

 

 

 

 

 

 

 

 

 

 

 

上面格式说明中，中括号“[ ]”部分表示可选部分，也就是说在实际使用的过程中可以没有这部分。行if语句的两种格式其实也可并为一种，其中“else”是可选部分。

如计算并联电路电阻，如果输入的是有效值则进行运算并显示相关值，否则显示“结束输入”信息，相关VB代码为：

If Val(Text1.Text) > 0 Then

 Label3.Caption = ""

 r = r + 1 / Val(Text1.Text)

 Text2.Text = Str(1 / r)

Else

 Label3.Caption = "结束输入"

End If

   

If语句使用的关键有两点：一是条件是什么，二是满足条件或不满足条件执行的是什么语句。首先是要确定条件，条件通常是描述相等或大小关系，或者是多个关系通过and（且）、or（或）、not（否）等的复合。其次是确定满足条件后执行什么样的语句或语句块，不满足件后执行什么样的语句或语句块。

    

2. 循环语句

程序中实现重复控制的方法之一是循环，用循环语句来表示。在程序设计语言中，循环语句描述了一种重复计算的过程。

   VB语言提供的循环语句主要有如下两种形式：

（1） For语句：通过次数控制循环的执行过程，习惯上将其称为计数循环；

（2） Do语句：通过条件控制循环的执行过程。

For语句的一般格式：

 

 

 

 

 

 

For语句的执行过程是：首先把“初值”赋给“循环变量”，接着判定循环变量的值是否超出终值，这里所说的“超出”有两种含义，即大于或小于，如果步长为正值，超出是指循环变量的值已大于终值；如果步长为负值，超出是指循环变量的值已小于终值。当循环变量的值没有超出终值，就执行一次循环体中的语句块，然后把循环变量的值加上一个步长，再赋给循环变量。重复上述过程，直至循环变量的值超出终值就结束循环。

Do语句的格式有多种，常用的格式如下：

 

 

 

 

 

    上面的Do语句的执行过程是：先计算条件表达式的值，如果值为真（True），则执行一次循环体中语句块，遇到Loop语句后，再次计算条件表达式的值，如果仍为True，继续执行循环体中的语句块，如此不断重复，直到条件表达式的值为False时才终止Do语句的执行。    

   为是保证Do循环不是死循环（执行起来就不会停止），在循环体的语句块中一般要用相应的赋值语句来改变“条件表达式”中相关量的值，有可能使“条件表达式”为False。

如计算s=1+2+3+…+100  （即计算1到100的和，并存放在变量S里），通过For循环和Do循环的两个程序段如下：

 

 

 

 

 

 

 

 

 

 

 

 

 

源地址：http://blog.renren.com/GetEntry.do?id=733780451&owner=253243101

来源：張天奇❤Q﹏的日志 | 分享 8 | 浏览 59 评论 | 分享 | 赞 | 举报

王石：哈佛博士上《非诚勿扰》白赚200万广告费。
我们曾和杨Sir一起走过
被人问推荐相机怎么办?!!
外貌焦躁症
不孝顺的熊孩子
【一个来自洛杉矶的”技术男“，对蓝可儿及CECIL HOTE...
女PhD主妇来发个饭贴(长期更新, 2月24日已更)
其实，我们并不在同一起跑线。尽力就好。
显示更多 »
美国巴旦木 总是好心情


郭嘉死亡背后的真相
郭嘉死亡那年，正好诸葛亮出山，未免有些过于巧合，郭嘉的死和诸葛亮有关系，真相是…
喜欢
摩佳折叠无线鼠标48元
摩佳折叠无线鼠标，智能节能，便捷高效，银黑银白亮色任选！
喜欢
我要推广

关于 开放平台 人人游戏 公共主页 手机人人 团购 皆喜网 营销服务 招聘 友情链接 客服帮助 隐私 人人网©2013
北京千橡网景科技发展有限公司：
文网文[2009]169号·京ICP证090254号·京公网安备110000000009号·甲测资字11002066·文化部监督电子邮箱：wlwh@vip.sina.com·互联网药品信息服务资格证
文明办网文明上网举报电话：4000803580 举报邮箱：admin1@renren-inc.com    不良信息举报中心    网络110报警服务    北京文化市场举报热线    家长监护工程
返回顶部
