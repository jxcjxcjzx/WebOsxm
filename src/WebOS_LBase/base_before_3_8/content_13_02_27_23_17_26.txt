



技术频道：
┊
嵌入式系统
┊
模拟设计
┊
可编程逻辑
┊
电源技术
┊
测试测量
┊
通信与网络
┊
工业控制
 
登录注册
 




首 页┊
 资源下载┊
 技术应用┊
 资 讯┊
 数据手册┊
 博 客┊
 小 组
 





























ADI资源下载Keithley下载中心
 






   热门词：嵌入式系统 工业控制 模拟技术通信与网络
 







位置：首页 -> 嵌入式系统 -> 软件与开发工具 -> 正文
 





轻量级脚本引擎的设计与实现


张贝克，符盛宝 时间:2011年11月16日 来源：微型机与应用2011年第15期

字 体: 大 中 小

关键词:脚本引擎脚本语言可扩展可定制二次开发


摘  要： 通过嵌入脚本引擎为应用程序提供脚本支持是实现应用程序可定制和可扩展的有效方法，但现存的脚本语言难于掌握，引擎庞大使应用程序的效率降低。为了解决该问题，设计了语法简单易学的脚本语言Vblet，实现了Vblet的轻量级脚本引擎。该引擎支持脚本无缝地使用应用程序实现的类和函数，并具有很好的性能。
关键词： 脚本引擎；脚本语言；可扩展；可定制；二次开发
 
　脚本语言凭借强大的描述能力和灵活的语法结构，使得为应用程序提供脚本支持从而进行混合语言开发成为实现可扩展和可定制的有效方案[1]。出于稳定性和开发时间限制的考虑，开发人员倾向于嵌入现有脚本引擎的方法为应用程序提供脚本支持，如嵌入Python引擎为应用程序提供Python脚本支持，或使用Microsoft提供的ActiveX Scripting技术为应用程序嵌入VBScript引擎或JavaScript引擎提供相应的脚本支持。但是这样方法灵活性较差，应用程序必须接受现有脚本引擎的体积和性能要求，这对运行在低硬件条件下的应用程序，或者是只要求进行简单规则计算的小型应用程序来说，这种方法在效率上没有优势[2]。而且有些现有脚本语言比较难学，使得用户把太多时间花在语言的学习上。因此，需要一个轻型的脚本引擎，能够解释运行一门语法简单易学的脚本语言，该脚本语言对于工程应用领域的非正式程序员，可以经过短时间的学习培训或者不经过学习就能掌握并使用。
 　针对以上问题，本文在自行设计的脚本语言Vblet的基础上，开发实现了Vblet的轻型脚本引擎，支持脚本引擎被嵌入在C++实现的应用程序上。Vblet语言语法简单，继承了在非专业程序员中具有较高声誉的VBA语言，并且借鉴了Python语言的部分功能，使得用户能够专注于问题的解决而不是语法的学习上。
1 脚本引擎概述
 　脚本引擎[3]是一个加载、解释执行脚本，并负责与外界进行交互的程序。脚本引擎一般很少独立存在，而是要嵌入应用程序中以扩展应用程序的行为，这个被嵌入脚本引擎的应用程序称为宿主程序。
 　嵌入的脚本引擎如图1所示。图1中，脚本引擎通过某种交互接口，根据脚本源程序描述的逻辑来控制应用系统。根据宿主程序和脚本引擎之间的紧密层次不同，可将通信方式分为：(1)基于二进制接口的通信。(2)基于公共运行时环境的通信。(3)基于源码接口的通信。本文实现的基于源码的交互接口，即通信双方基于共同的实现语言，在源代码级上相互调用。
 


　除了交互接口，作为脚本的解释运行平台，脚本引擎包含了一个编译器前端程序，前端程序负责将脚本源代码经过词法分析、语法语义分析后生成字节码格式的指令序列，然而这些指令序列是不能在目标机器上执行的。因此，在脚本引擎的最底层还要一个执行字节码指令的程序，这个程序即称为虚拟机。
2 脚本语言的设计
 　在开发实现脚本引擎之前，先要确定引擎要解释执行的对象，即脚本语言。本文设计的脚本语言Vblet是VBA(Visual Basic for Applications)的子集，而VBA的语法简单易学，在非专业程序员中有很大的用户量，享有很高的声誉。Vblet简化了VBA语法，去掉了VBA语法中的一些限制，此外还根据需要扩展了部分功能。下面是Vblet不同于VBA的一些重要的语法特性：
 　(1)交互执行。这是借鉴了Python语言交互执行的语法特点，使得程序员可以单行执行语句或计算表达式，而不限于一定要把代码封装在代码块中。
 　(2)不需要变量和参数声明。VBlet是动态语言，变量的类型由脚本引擎从上下文中确定，变量可以不经过声明就可以使用。
 　(3)去掉了部分运算符，比如冒号运算符和逗号运算符。
 　为了提高性能，Vblet去除了VBA中一些库函数的支持，只保留一些在工程应用领域比较常用的数学计算函数。
3 脚本引擎实现方案
 　Vblet引擎除了IDE的开发使用了MFC类库之外，其他模块的实现都是使用标准C++编写的，这使得Vblet引擎只需要重新编写IDE，或者修改小部分的核心代码就能够移植到其他平台上。
3.1 前端编译程序的实现
 　前端编译程序将脚本源程序的字符流经过词法分析、语法分析和语义分析后，生成字节码表示的指令流，同时进行语法检查，对语法错误给出提示信息。另外，为了支持断点调试和异常信息显示，每行源程序和生成的字节码指令的对应关系也要在这里建立。
 　前端编译器一般可以通过一些自动生成工具生成，但是这些自动生成的代码效率都不够高或者不好阅读，因此本文采用手写的方式实现前端编译程序。前端程序由Scanner类和Compiler类两大主要模块组成。Scanner类主要负责源程序的词法分析，它根据规定的词法规则把源程序拆分成词法单元，并进行词法检查。Compiler类则充当语法分析、语义分析和字节码生成，而且这三者一步完成，中间不产生任何数据。另外，语法分析和语义分析出现的错误由类Parse_error负责处理。前端编译器序列图如图2所示。
 


 



还没注册？ 

现在免费注册，您即可：
•阅读所有技术文章及下载网站资料;
•定期获得业界最新资讯及设计实例;
•拥有个人空间参与网站及客户活动;
•撰写博客与业界朋友交流分享经验;


已经注册? 登录阅览全部精彩内容
用户名：
密码：
 








版权声明：凡本网注明“来源：电子技术应用”或“来源：微型机与应用”的所有作品，版权均属于电子技术应用或微型机与应用，未经允许不得转载。违反上述声明者，本网将追究其相关法律责任。 






推荐文章


·意法半导体（ST）微控制器推动汽车安全达到最高水平
·恩智浦以物理不可克隆技术(PUF)强化SmartMX2 安全芯片
·大数据催生新一代联络中心
·德州仪器推出最新基站SoftwarePac，为基于KeyStone的无线基础设施SoC提供生产就绪型PHY与传输软件
·Ceragon Networks 的新一代无线分组芯片采用 MIPS® 处理器
·ARM big.LITTLE处理技术获国际大厂竞相采用
·全球最低功耗移动设备语音识别解决方案现已面世
·Marvell推出耗材安全芯片PA800采用Cryptography Research最新的CryptoFirewall防伪技术
·英飞凌选用汉高新型导热膏——导热性能更出色的TIM
·Tensilica和Sensory携手提供最低功耗、基于DSP的语音激活解决方案
·Tensilica与华为为下一代产品深化战略合作伙伴关系
·意法•爱立信携手爱立信演示全球首个双模高清VoLTE
 








脚本引擎相关资讯 

德州仪器最新 MOVE 语音引擎支持新一代 I
拥有Java的JSP与使用VBScript 类脚本语言
ST推出iNEMO引擎传感器整合套件
引进智能系统功能二次开发的研究与实践
意法半导体（ST）发布iNEMO引擎传感器整
【视频】Xilinx可扩展处理平台Zynq

 

视 频





【视频】系统级ESD电
随着技术的发展，移动电子设备已成为我们生活和文...
 【视频】Engineer It系列（一）选择集成电机驱动应考虑的温度因素
【视频】克服模拟集成电路的电气过应力
【视频】Sitara AM335x 入门套件演示
【视频】TI针对Linux的AM335x入门套件
 


专 访





与ADI专家零距离接触
 一直以来，ADI公司都尤为重视小批量购买客... 
彰显性能和生产优势，Altera展示28nm全
测控平台化软件解决方案X-Designer应运
Teledyne LeCroy欲借12位ADC高精度示波
全新的Maxim Integrated带你走进模拟整

 

社区


 

更多
博 客

 新增奖品3块LX9和10块国产FPGA开发板！ChinaAET启动新一季博客大赛，赶快参加吧！
 【技术分享】【原创】从零入手Kinetis系统开发（十三）之PWM模块
 【技术分享】PET系统之幅度测量
 【电子人生】【原创】2013，新年开启新的旅程
 【技术分享】双向口的仿真

更多
小 组

Xilinx 将在3月12日，北京举办Vivado的应用培训，具体议程见附件
基于CPLD的田径训练运动学信息采集系统
说出您需要的驱动，CooCox帮助您开发
【视频】在Vivado中如何使用多周期路径（Multicycle Paths）？
信号完整性基本原理 (PDF)


叱咤飞思卡尔

FPGA/CPLD助学小组
 



友情链接: 开发工具网 | 21世纪电子网 | 嵌入式技术网 | 慧聪电子网 | 嵌入式在线 | 我爱研发网 | 中国国防科技网 | 瑞萨单片机论坛 | 西莫电机网 | 嵌入式linux中文站 | 艾米电子工作室 | 电子工程网 | 中华工控网 | 中国图像网 | 控制工程网 | 机器人智能网 | 视觉网 | 电子工程师之家 | 华清远见 | 电源网 | CSDN | 阿里巴巴电子 | 维库电子市场网 | 电源门户网 | LED环球在线 | 赛微电子世界 | 光电新闻网 | 测试仪器网 | RFID世界网 | 电子电路图 | 电子查询网 | 电子爱好者 | 中国电子网 | 中国测控网 | 与非网 | 世界电子通信网 | netCOMPONENTS 电子元件查询 | 酷搜ICQOSO | 易展工控展览网 | 宇航光电咨询网 | 我爱方案网 | 电子元件技术网 | 220v电源网 | 嵌入式系统联谊会 | 电子园 | EETOP | 电源论坛 | 飞锐泰克 | 电子展览网 | 电池英才网 | 

关于我们 会员服务 广告服务 投稿须知 网站地图 相关法律 联系我们 友情链接 

版权所有：《电子技术应用》 编辑部    地址：北京海淀区清华东路25号电子六所大厦 
联系电话：82306084 / 82306085 传真：62311179 京ICP备10017138号 




























