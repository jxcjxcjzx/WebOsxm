微学苑—编程语言学习第一站！ 我要爆料腾讯微博新浪微博
工具箱     资料下载     Shell教程C语言C++教程微学苑
主页   C++   C++基础教程   继承与派生  

一.C++初步知识
二.数据类型与表达式
三.程序设计初步
四.函数与预处理
五.数组
六.指针
七.结构体|共用体|枚举
八.类和对象
九.类和对象【进阶】
十.运算符重载
十一.继承与派生
1.继承与派生的概念
2.派生类的声明方式
3.派生类的构成
4.派生类成员的访问属性
5.公用继承
6.私有继承
7.保护成员和保护继承
8.多级派生时的访问属性
9.派生类的构造函数
10.有子对象的派生类的构造函数
11.多层派生时的构造函数
12.派生类构造函数的特殊形式
13.派生类的析构函数
14.多重继承
15.多重继承派生类的构造函数
16.虚基类
17.基类与派生类的转换
18.继承与组合
19.继承在软件开发中的重要意义
十二.多态性与虚函数
十三.输入输出
C++虚基类详解
上一节 下一节 返回目录编辑/纠错/意见关注(100)更新:2012-05-30
分享到3

 1、虚基类的作用从上面的介绍可知:如果一个派生类有多个直接基类，而这些直接基类又有一个共同的基类，则在最终的派生类中会保留该间接共同基类数据成员的多份同名成员。

在引用这些同名的成员时，必须在派生类对象名后增加直接基类名，以避免产生二义性，使其惟一地标识一个成员，如
    c1.A::display( )。
在一个类中保留间接共同基类的多份同名成员，这种现象是人们不希望出现的。C++提供虚基类(virtual base class )的方法，使得在继承间接共同基类时只保留一份成员。

现在，将类A声明为虚基类，方法如下:
class A//声明基类A
{…};
class B :virtual public A//声明类B是类A的公用派生类，A是B的虚基类
{…};
class C :virtual public A//声明类C是类A的公用派生类，A是C的虚基类
{…};

注意: 虚基类并不是在声明基类时声明的，而是在声明派生类时，指定继承方式时声明的。因为一个基类可以在生成一个派生类时作为虚基类，而在生成另一个派生类时不作为虚基类。

声明虚基类的一般形式为
   class 派生类名: virtual 继承方式 基类名
经过这样的声明后，当基类通过多条派生路径被一个派生类继承时，该派生类只继承该基类一次。

需要注意: 为了保证虚基类在派生类中只继承一次，应当在该基类的所有直接派生类中声明为虚基类。否则仍然会出现对基类的多次继承。

如果在派生类B和C中将类A声明为虚基类，而在派生类D中没有将类A声明为虚基类，则在派生类E中，虽然从类B和C路径派生的部分只保留一份基类成员，但从类D路径派生的部分还保留一份基类成员。

2、虚基类的初始化如果在虚基类中定义了带参数的构造函数，而且没有定义默认构造函数，则在其所有派生类(包括直接派生或间接派生的派生类)中，通过构造函数的初始化表对虚基类进行初始化。例如
class A//定义基类A
{
   A(int i){ } //基类构造函数，有一个参数};
class B :virtual public A //A作为B的虚基类
{
   B(int n):A(n){ } //B类构造函数，在初始化表中对虚基类初始化
};
class C :virtual public A //A作为C的虚基类
{
   C(int n):A(n){ } //C类构造函数，在初始化表中对虚基类初始化
};
class D :public B,public C //类D的构造函数，在初始化表中对所有基类初始化
{
   D(int n):A(n),B(n),C(n){ }
};
注意: 在定义类D的构造函数时，与以往使用的方法有所不同。规定: 在最后的派生类中不仅要负责对其直接基类进行初始化，还要负责对虚基类初始化。C++编译系统只执行最后的派生类对虚基类的构造函数的调用，而忽略虚基类的其他派生类(如类B和类C) 对虚基类的构造函数的调用，这就保证了虚基类的数据成员不会被多次初始化。

温馨提示：使用多重继承时要十分小心，经常会出现二义性问题。许多专业人员认为：不要提倡在程序中使用多重继承，只有在比较简单和不易出现二义性的情况或实在必要时才使用多重继承，能用单一继承解决的问题就不要使用多重继承。也是由于这个原因，有些面向对象的程序设计语言(如Java，Smalltalk)并不支持多重继承。
上一节 下一节 返回目录编辑/纠错/意见关注(100)更新:2012-05-30
社交帐号登录:
微博
QQ
人人
豆瓣
更多»


发布
最新最早最热
评论
还没有评论，沙发等你来抢
Powered by 多说

 
晒榜单 TOP10
1#200C++中用scanf和printf函数进行输入和输出
2#200C++变量的存储类别(动态存储、静态存储、自动变量、寄存器变量、
3#200什么是构造函数
4#199学习程序设计的方法和一些准备
5#198C++成员函数—C++成员函数的定义和重载
6#198什么是函数
7#197C++循环结构程序举例
8#197C++标准输入流详解
9#196再谈C++抽象类
10#195清除链表

 
随机教程 Rand
多态性的一个典型例子
C++单目运算符重载
C++对象成员的引用
C++指针变量的定义和使用
C++赋值运算符与赋值表达式
C++友元类讲解
C++变量的初始化
C++派生类的声明或定义方式
什么是面向对象的程序设计
使用默认参数的构造函数
关于微学苑 - C语言中文网 - 二级C语言 - Windows编程 - 数据结构 - VC6.0教程 - 正则表达式 - MySQL教程 - Shell教程 - 站长统计

Copyright @ 2010 微学苑 All rights reserved
回到顶部

