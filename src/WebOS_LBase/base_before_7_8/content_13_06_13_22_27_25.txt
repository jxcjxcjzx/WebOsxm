Chinaunix首页　| 　论坛　| 　博客 登录 | 注册
    
坚持到底
知其然而且要知其所以然！
五周年特别奉献：《IT架构实录》征文活动
【原创评选】2013年6-7月原创博文评选开始啦！
梦想之家大赛晒装修,四天三夜港澳双人游
首页　| 　博文目录　| 　关于我

zhm_sunboy
博客访问： 861320
博文数量： 379
博客积分： 10189
博客等级： 上将
技术积分： 2481
用 户 组： 普通用户
注册时间： 2008-08-05 19:46

文章分类
全部博文（379）

开源（2）
服务器（4）
协议（16）
数据结构与算法（4）
流媒体（31）
网络技术（7）
通信知识（34）
计算机原理（1）
网络编程（28）
人生励志（5）
软件设计（1）
软件测试（2）
技术心得（3）
Web（1）
UML学习（3）
Wiki使用（2）
公司培训（0）
Windows编程（26）
电信增值（16）
面试总结（2）
C/C++（98）
数据库（1）
UNIX（92）
未分配的博文（0）
文章存档
2013年（1）

2012年（4）

2011年（41）

2010年（81）

2009年（58）

2008年（194）

我的朋友

spyhjl

simiaoxi
最近访客

由与游

inoldday

guo_eric

teaco77

hot_111

libertin

xwjwh

des2008

whanga11
订阅
推荐博文
·定时备份oracle数据库脚本...
·linux文件系统日志(一)...
·mmap系统调用
·用vim看内核代码的配置流程...
·DB2 pureScale 特性举例
热词专题
·qlite c语言
·服务器无法通过系统非页面共...
·win8 邮件
·flex 监听 第一帧
·mysql cluster 添加 db
友情链接
 C++中友元详解 2008-09-01 21:28:47
分类： C/C++
问题的提出

　　我们已知道类具备封装和信息隐 藏的特性。只有类的成员函数才能访问类的私有成员，程式中的其他函数是无法访问私有成员的。非成员函数能够访问类中的公有成员，但是假如将数据成员都定义 为公有的，这又破坏了隐藏的特性。另外，应该看到在某些情况下，特别是在对某些成员函数多次调用时，由于参数传递，类型检查和安全性检查等都需要时间开 销，而影响程式的运行效率。

　　为了解决上述问题，提出一种使用友元的方案。友元是一种定义在类外部的普通函数，但他需要在类体内进行说 明，为了和该类的成员函数加以区别，在说明时前面加以关键字friend。友元不是成员函数，但是他能够访问类中的私有成员。友元的作用在于提高程式的运 行效率，但是，他破坏了类的封装性和隐藏性，使得非成员函数能够访问类的私有成员。

　　友元能够是个函数，该函数被称为友元函数；友元也能够是个类，该类被称为友元类。

　　友元函数

　　友元函数的特点是能够访问类中的私有成员的非成员函数。友元函数从语法上看，他和普通函数相同，即在定义上和调用上和普通函数相同。下面举一例子说明友元函数的应用。

　　#include 
　　#include 

　　class Point
　　{
　　public:
　　　　Point(double xx, double yy) { x=xx; y=yy; }
　　　　void Getxy();
　　　　friend double Distance(Point &a, Point &b);
　　private:
　　　　double x, y;
　　};

　　void Point::Getxy()
　　{
　　cout<<"("<<<","<<<")"<< FONT>
　　}

　　double Distance(Point &a, Point &b)
　　{
　　double dx = a.x - b.x;
　　double dy = a.y - b.y;
　　return sqrt(dx*dx+dy*dy);
　　}

　　void main()
　　{
　　Point p1(3.0, 4.0), p2(6.0, 8.0);
　　p1.Getxy();
　　p2.Getxy();
　　double d = Distance(p1, p2);
　　cout<<"Distance is"<<< FONT>
　　}

　 　说明：在该程式中的Point类中说明了一个友元函数Distance()，他在说明时前边加friend关键字，标识他不是成员函数，而是友元函数。 他的定义方法和普通函数定义相同，而不同于成员函数的定义，因为他无需指出所属的类。但是，他能够引用类中的私有成员，函数体中 a.x，b.x，a.y，b.y都是类的私有成员，他们是通过对象引用的。在调用友元函数时，也是同普通函数的调用相同，不要像成员函数那样调用。本例 中，p1.Getxy()和p2.Getxy()这是成员函数的调用，要用对象来表示。而Distance(p1, p2)是友元函数的调用，他直接调 用，无需对象表示，他的参数是对象。(该程式的功能是已知两点坐标，求出两点的距离。)

　　友元类

　　友元除了前面讲过的函数以外，友元还能够是类，即一个类能够作另一个类的友元。当一个类作为另一个类的友元时，这就意味着这个类的任何成员函数都是另一个类的友元函数。
---------------------------------------------------另一篇
采 用类的机制后实现了数据的隐藏与封装，类的数据成员一般定义为私有成员，成员函数一般定义为公有的，依此提供类与外界间的通信接口。但是，有时需要定义一 些函数，这些函数不是类的一部分，但又需要频繁地访问类的数据成员，这时可以将这些函数定义为该函数的友元函数。除了友元函数外，还有友元类，两者统称为 友元。友元的作用是提高了程序的运行效率（即减少了类型检查和安全性检查等都需要时间开销），但它破坏了类的封装性和隐藏性，使得非成员函数可以访问类的 私有成员。
友元函数 ： 
      友元函数是可以直接访问类的私有成员的非成员函数。它是定义在类外的普通函数，它不属于任何类，但需要在类的定义中加以声明，声明时只需在友元的名称前加上关键字friend，其格式如下：
      friend  类型 函数名(形式参数);

      友元函数的声明可以放在类的私有部分，也可以放在公有部分，它们是没有区别的，都说明是该类的一个友元函数。
      一个函数可以是多个类的友元函数，只需要在各个类中分别声明。
      友元函数的调用与一般函数的调用方式和原理一致。
友元类 ： 
      友元类的所有成员函数都是另一个类的友元函数，都可以访问另一个类中的隐藏信息（包括私有成员和保护成员）。       
      当希望一个类可以存取另一个类的私有成员时，可以将该类声明为另一类的友元类。定义友元类的语句格式如下：
      friend class 类名;
      其中：friend和class是关键字，类名必须是程序中的一个已定义过的类。

      例如，以下语句说明类B是类A的友元类：
      class A
      {
             …
      public:
             friend class B;
             …
      };
      经过以上说明后，类B的所有成员函数都是类A的友元函数，能存取类A的私有成员和保护成员。

      使用友元类时注意：
            (1) 友元关系不能被继承。 
            (2) 友元关系是单向的，不具有交换性。若类B是类A的友元，类A不一定是类B的友元，要看在类中是否有相应的声明。
            (3) 友元关系不具有传递性。若类B是类A的友元，类C是B的友元，类C不一定是类A的友元，同样要看类中是否有相应的申明
注意事项：
1.友元可以访问类的私有成员。
2.只能出现在类定义内部，友元声明可以在类中的任何地方，一般放在类定义的开始或结尾。
3.友元可以是普通的非成员函数，或前面定义的其他类的成员函数，或整个类。
4.类必须将重载函数集中每一个希望设为友元的函数都声明为友元。
5.友元关系不能继承，基类的友元对派生类的成员没有特殊的访问权限。如果基类被授予友元关系，则只有基类具有特殊的访问权限。该基类的派生类不能访问授予友元关系的类。
阅读(3852) | 评论(0) | 转发(0) |
0
上一篇：C++种static关键字的用途
下一篇：关于C++判断语句的思考
相关热门文章
Linux NAND FLASH驱动框架分析...
mini2440 usb摄像头程序详解 ...
MySQL中的mysqldump命令使用详...
详解帧内预测技术
MySQL5.5.x my.cnf参数配置优...
test123
编写安全代码——小心有符号数...
使用openssl api进行加密解密...
一段自己打印自己的c程序...
sql relay的c++接口
[读书笔记]基于归纳的算法设计...
Linux内核list/hlist解读
一步步编译ffmpeg+x264看看con...
Tuple-参数列表实现
linux下目录文件相关函数...
给主人留下些什么吧！~~
评论热议
请登录后评论。
登录 注册
关于我们 | 关于IT168 | 联系方式 | 广告合作 | 法律声明 | 免费注册
Copyright 2001-2010 ChinaUnix.net All Rights Reserved 北京皓辰网域网络信息技术有限公司. 版权所有
感谢所有关心和支持过ChinaUnix的朋友们
京ICP证041476号 京ICP证060528号

