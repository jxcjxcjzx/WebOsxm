!function(){window.egret={};(function(t){var e=function(){function t(){this._hashCode=t.hashCount++}Object.defineProperty(t.prototype,"hashCode",{get:function(){return this._hashCode},enumerable:!0,configurable:!0});t.hashCount=1;return t}();t.HashObject=e;e.prototype.__class__="egret.HashObject"})(egret);var t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(t){"undefined"===typeof t&&(t=300);e.call(this);this.objectPool=[];this._length=0;1>t&&(t=1);this.autoDisposeTime=t;this.frameCount=0}t(i,e);i.prototype._checkFrame=function(){this.frameCount--;0>=this.frameCount&&this.dispose()};Object.defineProperty(i.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0});i.prototype.push=function(t){var e=this.objectPool;-1==e.indexOf(t)&&(e.push(t),this._length++,0==this.frameCount&&(this.frameCount=this.autoDisposeTime,i._callBackList.push(this)))};i.prototype.pop=function(){if(0==this._length)return null;this._length--;return this.objectPool.pop()};i.prototype.dispose=function(){0<this._length&&(this.objectPool=[],this._length=0);this.frameCount=0;var t=i._callBackList,e=t.indexOf(this);-1!=e&&t.splice(e,1)};i._callBackList=[];return i}(e.HashObject);e.Recycler=i;i.prototype.__class__="egret.Recycler"})(egret);(function(t){t.__START_TIME;t.getTimer=function(){return Date.now()-t.__START_TIME}})(egret);(function(t){t.__callLaterFunctionList=[];t.__callLaterThisList=[];t.__callLaterArgsList=[];t.callLater=function(e,i){for(var n=[],r=0;r<arguments.length-2;r++)n[r]=arguments[r+2];t.__callLaterFunctionList.push(e);t.__callLaterThisList.push(i);t.__callLaterArgsList.push(n)}})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t,e,n){"undefined"===typeof e&&(e=!1);"undefined"===typeof n&&(n=!1);i.call(this);this._eventPhase=2;this._isPropagationImmediateStopped=this._isPropagationStopped=this._isDefaultPrevented=!1;this.isNew=!0;this._type=t;this._bubbles=e;this._cancelable=n}t(n,i);Object.defineProperty(n.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"bubbles",{get:function(){return this._bubbles},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"cancelable",{get:function(){return this._cancelable},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"eventPhase",{get:function(){return this._eventPhase},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"currentTarget",{get:function(){return this._currentTarget},enumerable:!0,configurable:!0});n.prototype._setCurrentTarget=function(t){this._currentTarget=t};Object.defineProperty(n.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0});n.prototype.isDefaultPrevented=function(){return this._isDefaultPrevented};n.prototype.preventDefault=function(){this._cancelable&&(this._isDefaultPrevented=!0)};n.prototype.stopPropagation=function(){this._bubbles&&(this._isPropagationStopped=!0)};n.prototype.stopImmediatePropagation=function(){this._bubbles&&(this._isPropagationImmediateStopped=!0)};n.prototype._reset=function(){this.isNew?this.isNew=!1:(this._isPropagationImmediateStopped=this._isPropagationStopped=this._isDefaultPrevented=!1,this._currentTarget=this._target=null,this._eventPhase=2)};n._dispatchByTarget=function(t,i,n,r,o,s){"undefined"===typeof o&&(o=!1);"undefined"===typeof s&&(s=!1);var a=t.eventRecycler;a||(a=t.eventRecycler=new e.Recycler);var h=a.pop();h?h._type=n:h=new t(n);h._bubbles=o;h._cancelable=s;if(r)for(var c in r)h[c]=r[c],null!==h[c]&&(r[c]=null);t=i.dispatchEvent(h);a.push(h);return t};n._getPropertyData=function(t){var e=t._props;e||(e=t._props={});return e};n.dispatchEvent=function(t,e,i,r){"undefined"===typeof i&&(i=!1);var o=n._getPropertyData(n);r&&(o.data=r);n._dispatchByTarget(n,t,e,o,i)};n.ADDED_TO_STAGE="addedToStage";n.REMOVED_FROM_STAGE="removedFromStage";n.ADDED="added";n.REMOVED="removed";n.COMPLETE="complete";n.ENTER_FRAME="enterFrame";n.RENDER="render";n.FINISH_RENDER="finishRender";n.FINISH_UPDATE_TRANSFORM="finishUpdateTransform";n.LEAVE_STAGE="leaveStage";n.RESIZE="resize";n.CHANGE="change";return n}(e.HashObject);e.Event=i;i.prototype.__class__="egret.Event"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t,e,n){"undefined"===typeof e&&(e=!1);"undefined"===typeof n&&(n=!1);i.call(this,t,e,n)}t(n,i);n.dispatchIOErrorEvent=function(t){e.Event._dispatchByTarget(n,t,n.IO_ERROR)};n.IO_ERROR="ioError";return n}(e.Event);e.IOErrorEvent=i;i.prototype.__class__="egret.IOErrorEvent"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t,e,n,r,o,s,a,h,c,u){"undefined"===typeof e&&(e=!0);"undefined"===typeof n&&(n=!0);"undefined"===typeof r&&(r=0);"undefined"===typeof o&&(o=0);"undefined"===typeof s&&(s=0);"undefined"===typeof a&&(a=!1);"undefined"===typeof h&&(h=!1);"undefined"===typeof u&&(u=!1);i.call(this,t,e,n);this._localY=this._localX=this._stageY=this._stageX=0;this.touchPointID=r;this._stageX=o;this._stageY=s;this.ctrlKey=a;this.altKey=h;this.touchDown=u}t(n,i);Object.defineProperty(n.prototype,"stageX",{get:function(){return this._stageX},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"stageY",{get:function(){return this._stageY},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"localX",{get:function(){return this._localX},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"localY",{get:function(){return this._localY},enumerable:!0,configurable:!0});n.prototype._setCurrentTarget=function(t){i.prototype._setCurrentTarget.call(this,t);t instanceof e.DisplayObject&&(t=t.globalToLocal(this._stageX,this._stageY,e.Point.identity),this._localX=t.x,this._localY=t.y)};n.dispatchTouchEvent=function(t,i,r,o,s,a,h,c,u){"undefined"===typeof r&&(r=0);"undefined"===typeof o&&(o=0);"undefined"===typeof s&&(s=0);"undefined"===typeof a&&(a=!1);"undefined"===typeof h&&(h=!1);"undefined"===typeof c&&(c=!1);"undefined"===typeof u&&(u=!1);var p=e.Event._getPropertyData(n);p.touchPointID=r;p._stageX=o;p._stageY=s;p.ctrlKey=a;p.altKey=h;p.shiftKey=c;p.touchDown=u;e.Event._dispatchByTarget(n,t,i,p,!0,!0)};n.TOUCH_TAP="touchTap";n.TOUCH_MOVE="touchMove";n.TOUCH_BEGIN="touchBegin";n.TOUCH_END="touchEnd";n.TOUCH_RELEASE_OUTSIDE="touchReleaseOutside";n.TOUCH_ROLL_OUT="touchRollOut";n.TOUCH_ROLL_OVER="touchRollOver";n.TOUCH_OUT="touchOut";n.TOUCH_OVER="touchOver";return n}(e.Event);e.TouchEvent=i;i.prototype.__class__="egret.TouchEvent"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t,e,n){"undefined"===typeof e&&(e=!1);"undefined"===typeof n&&(n=!1);i.call(this,t,e,n)}t(n,i);n.dispatchTimerEvent=function(t,i){e.Event._dispatchByTarget(n,t,i)};n.TIMER="timer";n.TIMER_COMPLETE="timerComplete";return n}(e.Event);e.TimerEvent=i;i.prototype.__class__="egret.TimerEvent"})(egret);(function(t){var e=function(){function t(){}t.CAPTURING_PHASE=1;t.AT_TARGET=2;t.BUBBLING_PHASE=3;return t}();t.EventPhase=e;e.prototype.__class__="egret.EventPhase"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t){"undefined"===typeof t&&(t=null);i.call(this);this._eventTarget=t?t:this}t(n,i);n.prototype.addEventListener=function(t,i,n,r,o){"undefined"===typeof r&&(r=!1);"undefined"===typeof o&&(o=0);"undefined"===typeof r&&(r=!1);"undefined"===typeof o&&(o=0);i||e.Logger.fatal("addEventListener侦听函数不能为空");r?(this._captureEventsMap||(this._captureEventsMap={}),r=this._captureEventsMap):(this._eventsMap||(this._eventsMap={}),r=this._eventsMap);var s=r[t];s||(s=r[t]=[]);this._insertEventBin(s,i,n,o)};n.prototype._insertEventBin=function(t,e,i,n){for(var r=-1,o=t.length,s=0;s<o;s++){var a=t[s];if(a.listener===e&&a.thisObject===i)return!1;-1==r&&a.priority<n&&(r=s)}e={listener:e,thisObject:i,priority:n};-1!=r?t.splice(r,0,e):t.push(e);return!0};n.prototype.removeEventListener=function(t,e,i,n){"undefined"===typeof n&&(n=!1);if(n=n?this._captureEventsMap:this._eventsMap){var r=n[t];r&&(this._removeEventBin(r,e,i),0==r.length&&delete n[t])}};n.prototype._removeEventBin=function(t,e,i){for(var n=t.length,r=0;r<n;r++){var o=t[r];if(o.listener===e&&o.thisObject===i)return t.splice(r,1),!0}return!1};n.prototype.hasEventListener=function(t){return this._eventsMap&&this._eventsMap[t]||this._captureEventsMap&&this._captureEventsMap[t]};n.prototype.willTrigger=function(t){return this.hasEventListener(t)};n.prototype.dispatchEvent=function(t){t._reset();t._target=this._eventTarget;t._setCurrentTarget(this._eventTarget);return this._notifyListener(t)};n.prototype._notifyListener=function(t){var e=1==t._eventPhase?this._captureEventsMap:this._eventsMap;if(!e)return!0;e=e[t.type];if(!e)return!0;for(var e=e.concat(),i=e.length,n=0;n<i;n++){var r=e[n];r.listener.call(r.thisObject,t);if(t._isPropagationImmediateStopped)break}return!t.isDefaultPrevented()};n.prototype.dispatchEventWith=function(t,i,n){"undefined"===typeof i&&(i=!1);e.Event.dispatchEvent(this,t,i,n)};return n}(e.HashObject);e.EventDispatcher=i;i.prototype.__class__="egret.EventDispatcher"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this.reuseEvent=new e.Event("")}t(n,i);n.prototype.run=function(){e.Ticker.getInstance().run();e.Ticker.getInstance().register(this.renderLoop,this,Number.NEGATIVE_INFINITY);e.Ticker.getInstance().register(this.broadcastEnterFrame,this,Number.POSITIVE_INFINITY);this.touchContext.run()};n.prototype.renderLoop=function(t){t=this.rendererContext;t.clearScreen();if(0<e.__callLaterFunctionList.length){var i=e.__callLaterFunctionList;e.__callLaterFunctionList=[];var n=e.__callLaterThisList;e.__callLaterThisList=[];var r=e.__callLaterArgsList;e.__callLaterArgsList=[]}this.dispatchEventWith(e.Event.RENDER);e.Stage._invalidateRenderFlag&&(this.broadcastRender(),e.Stage._invalidateRenderFlag=!1);i&&this.doCallLaterList(i,n,r);this.stage._updateTransform();this.dispatchEventWith(e.Event.FINISH_UPDATE_TRANSFORM);this.stage._draw(t);this.dispatchEventWith(e.Event.FINISH_RENDER)};n.prototype.broadcastEnterFrame=function(t){t=this.reuseEvent;t._type=e.Event.ENTER_FRAME;this.dispatchEvent(t);for(var i=e.DisplayObject._enterFrameCallBackList.concat(),n=i.length,r=0;r<n;r++){var o=i[r];t._target=o.display;t._setCurrentTarget(o.display);o.listener.call(o.thisObject,t)}i=e.Recycler._callBackList;for(r=i.length-1;0<=r;r--)i[r]._checkFrame()};n.prototype.broadcastRender=function(){var t=this.reuseEvent;t._type=e.Event.RENDER;for(var i=e.DisplayObject._renderCallBackList.concat(),n=i.length,r=0;r<n;r++){var o=i[r];t._target=o.display;t._setCurrentTarget(o.display);o.listener.call(o.thisObject,t)}};n.prototype.doCallLaterList=function(t,e,i){for(var n=t.length,r=0;r<n;r++){var o=t[r];null!=o&&o.apply(e[r],i[r])}};n.DEVICE_PC="web";n.DEVICE_MOBILE="native";return n}(e.EventDispatcher);e.MainContext=i;i.prototype.__class__="egret.MainContext"})(egret);var e=function(){if(!this.navigator)return!0;var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mobile")||-1!=t.indexOf("android")};egret.MainContext.instance=new egret.MainContext;egret.MainContext.deviceType=e()?egret.MainContext.DEVICE_MOBILE:egret.MainContext.DEVICE_PC;(function(t){var e=function(){function e(){this._tick=this._preDrawCount=this._updateTransformPerformanceCost=this._renderPerformanceCost=this._logicPerformanceCost=this._lastTime=0;this._maxDeltaTime=500;this._totalDeltaTime=0}e.getInstance=function(){null==e.instance&&(e.instance=new e);return e.instance};e.prototype.run=function(){t.Ticker.getInstance().register(this.update,this);null==this._txt&&(this._txt=new t.TextField,this._txt.size=28,t.MainContext.instance.stage.addChild(this._txt));var e=t.MainContext.instance;e.addEventListener(t.Event.ENTER_FRAME,this.onEnterFrame,this);e.addEventListener(t.Event.RENDER,this.onStartRender,this);e.addEventListener(t.Event.FINISH_RENDER,this.onFinishRender,this);e.addEventListener(t.Event.FINISH_UPDATE_TRANSFORM,this.onFinishUpdateTransform,this)};e.prototype.onEnterFrame=function(e){this._lastTime=t.getTimer()};e.prototype.onStartRender=function(e){e=t.getTimer();this._logicPerformanceCost=e-this._lastTime;this._lastTime=e};e.prototype.onFinishUpdateTransform=function(e){e=t.getTimer();this._updateTransformPerformanceCost=e-this._lastTime;this._lastTime=e};e.prototype.onFinishRender=function(e){e=t.getTimer();this._renderPerformanceCost=e-this._lastTime;this._lastTime=e};e.prototype.update=function(e){this._tick++;this._totalDeltaTime+=e;if(this._totalDeltaTime>=this._maxDeltaTime){e=(this._preDrawCount-1).toString();var i=Math.ceil(this._logicPerformanceCost).toString()+","+Math.ceil(this._updateTransformPerformanceCost).toString()+","+Math.ceil(this._renderPerformanceCost).toString()+","+Math.ceil(t.MainContext.instance.rendererContext.renderCost).toString();this._txt.text="draw:"+e+"\ncost:"+i+"\nFPS:"+Math.floor(1e3*this._tick/this._totalDeltaTime).toString();this._tick=this._totalDeltaTime=0}this._preDrawCount=0};e.prototype.onDrawImage=function(){this._preDrawCount++};return e}();t.Profiler=e;e.prototype.__class__="egret.Profiler"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.apply(this,arguments);this._timeScale=1;this._paused=!1;this.callBackList=[]}t(n,i);n.prototype.run=function(){e.__START_TIME=(new Date).getTime();e.MainContext.instance.deviceContext.executeMainLoop(this.update,this)};n.prototype.update=function(t){var e=this.callBackList.concat(),i=e.length;t*=this._timeScale;t*=this._timeScale;for(var n=0;n<i;n++){var r=e[n];r.listener.call(r.thisObject,t)}};n.prototype.register=function(t,e,i){"undefined"===typeof i&&(i=0);this._insertEventBin(this.callBackList,t,e,i)};n.prototype.unregister=function(t,e){this._removeEventBin(this.callBackList,t,e)};n.prototype.setTimeout=function(t,i,n){for(var r=[],o=0;o<arguments.length-3;o++)r[o]=arguments[o+3];e.Logger.warning("Ticker#setTimeout方法即将废弃,请使用egret.setTimeout");e.setTimeout.apply(null,[t,i,n].concat(r))};n.prototype.setTimeScale=function(t){this._timeScale=t};n.prototype.getTimeScale=function(){return this._timeScale};n.prototype.pause=function(){this._paused=!0};n.prototype.resume=function(){this._paused=!1};n.getInstance=function(){null==n.instance&&(n.instance=new n);return n.instance};return n}(e.EventDispatcher);e.Ticker=i;i.prototype.__class__="egret.Ticker"})(egret);(function(t){var e=function(){function t(){}t.LEFT="left";t.RIGHT="right";t.CENTER="center";t.JUSTIFY="justify";t.CONTENT_JUSTIFY="contentJustify";return t}();t.HorizontalAlign=e;e.prototype.__class__="egret.HorizontalAlign"})(egret);(function(t){var e=function(){function t(){}t.TOP="top";t.BOTTOM="bottom";t.MIDDLE="middle";t.JUSTIFY="justify";t.CONTENT_JUSTIFY="contentJustify";return t}();t.VerticalAlign=e;e.prototype.__class__="egret.VerticalAlign"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t,e){"undefined"===typeof e&&(e=0);i.call(this);this._currentCount=0;this.delay=t;this.repeatCount=e}t(n,i);n.prototype.currentCount=function(){return this._currentCount};Object.defineProperty(n.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0});n.prototype.reset=function(){this.stop();this._currentCount=0};n.prototype.start=function(){this._running||(this.lastTime=e.getTimer(),0!=this._currentCount&&(this._currentCount=0),e.Ticker.getInstance().register(this.onEnterFrame,this),this._running=!0)};n.prototype.stop=function(){this._running&&(e.Ticker.getInstance().unregister(this.onEnterFrame,this),this._running=!1)};n.prototype.onEnterFrame=function(t){t=e.getTimer();t-this.lastTime>this.delay&&(this.lastTime=t,this._currentCount++,e.TimerEvent.dispatchTimerEvent(this,e.TimerEvent.TIMER),0<this.repeatCount&&this._currentCount>=this.repeatCount&&(this.stop(),e.TimerEvent.dispatchTimerEvent(this,e.TimerEvent.TIMER_COMPLETE)))};return n}(e.EventDispatcher);e.Timer=i;i.prototype.__class__="egret.Timer"})(egret);(function(t){t.getQualifiedClassName=function(t){t=t.prototype?t.prototype:t.__proto__;if(t.hasOwnProperty("__class__"))return t.__class__;var e=t.constructor.toString(),i=e.indexOf("("),e=e.substring(9,i);return t.__class__=e}})(egret);(function(t){var e={};t.getDefinitionByName=function(t){if(!t)return null;var n=e[t];if(n)return n;for(var r=t.split("."),o=r.length,n=i,s=0;s<o;s++)if(n=n[r[s]],!n)return null;return e[t]=n}})(egret);var i=i||this;(function(t){function e(t){for(var e in i){var n=i[e];n.delay-=t;0>=n.delay&&(n.listener.apply(n.thisObject,n.params),delete i[e])}}var i={},n=0;t.setTimeout=function(r,o,s){for(var a=[],h=0;h<arguments.length-3;h++)a[h]=arguments[h+3];a={listener:r,thisObject:o,delay:s,params:a};0==n&&t.Ticker.getInstance().register(e,null);n++;i[n]=a;return n};t.clearTimeout=function(t){delete i[t]}})(egret);(function(t){t.hasDefinition=function(e){return t.getDefinitionByName(e)?!0:!1}})(egret);(function(t){t.toColorString=function(t){if(isNaN(t)||0>t)t=0;16777215<t&&(t=16777215);for(t=t.toString(16).toUpperCase();6>t.length;)t="0"+t;return"#"+t}})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t,e,n,r,o,s){"undefined"===typeof t&&(t=1);"undefined"===typeof e&&(e=0);"undefined"===typeof n&&(n=0);"undefined"===typeof r&&(r=1);"undefined"===typeof o&&(o=0);"undefined"===typeof s&&(s=0);i.call(this);this.a=t;this.b=e;this.c=n;this.d=r;this.tx=o;this.ty=s}t(n,i);n.prototype.prepend=function(t,e,i,n,r,o){var s=this.tx;if(1!=t||0!=e||0!=i||1!=n){var a=this.a,h=this.c;this.a=a*t+this.b*i;this.b=a*e+this.b*n;this.c=h*t+this.d*i;this.d=h*e+this.d*n}this.tx=s*t+this.ty*i+r;this.ty=s*e+this.ty*n+o;return this};n.prototype.append=function(t,e,i,n,r,o){var s=this.a,a=this.b,h=this.c,c=this.d;this.a=t*s+e*h;this.b=t*a+e*c;this.c=i*s+n*h;this.d=i*a+n*c;this.tx=r*s+o*h+this.tx;this.ty=r*a+o*c+this.ty;return this};n.prototype.prependMatrix=function(t){this.prepend(t.a,t.b,t.c,t.d,t.tx,t.ty);return this};n.prototype.appendMatrix=function(t){this.append(t.a,t.b,t.c,t.d,t.tx,t.ty);return this};n.prototype.prependTransform=function(t,e,i,r,o,s,a,h,c){if(o%360){var u=o*n.DEG_TO_RAD;o=Math.cos(u);u=Math.sin(u)}else o=1,u=0;if(h||c)this.tx-=h,this.ty-=c;s||a?(s*=n.DEG_TO_RAD,a*=n.DEG_TO_RAD,this.prepend(o*i,u*i,-u*r,o*r,0,0),this.prepend(Math.cos(a),Math.sin(a),-Math.sin(s),Math.cos(s),t,e)):this.prepend(o*i,u*i,-u*r,o*r,t,e);return this};n.prototype.appendTransform=function(t,e,i,r,o,s,a,h,c){if(o%360){var u=o*n.DEG_TO_RAD;o=Math.cos(u);u=Math.sin(u)}else o=1,u=0;s||a?(s*=n.DEG_TO_RAD,a*=n.DEG_TO_RAD,this.append(Math.cos(a),Math.sin(a),-Math.sin(s),Math.cos(s),t,e),this.append(o*i,u*i,-u*r,o*r,0,0)):this.append(o*i,u*i,-u*r,o*r,t,e);if(h||c)this.tx-=h*this.a+c*this.c,this.ty-=h*this.b+c*this.d;return this};n.prototype.rotate=function(t){var e=Math.cos(t);t=Math.sin(t);var i=this.a,n=this.c,r=this.tx;this.a=i*e-this.b*t;this.b=i*t+this.b*e;this.c=n*e-this.d*t;this.d=n*t+this.d*e;this.tx=r*e-this.ty*t;this.ty=r*t+this.ty*e;return this};n.prototype.skew=function(t,e){t*=n.DEG_TO_RAD;e*=n.DEG_TO_RAD;this.append(Math.cos(e),Math.sin(e),-Math.sin(t),Math.cos(t),0,0);return this};n.prototype.scale=function(t,e){this.a*=t;this.d*=e;this.c*=t;this.b*=e;this.tx*=t;this.ty*=e;return this};n.prototype.translate=function(t,e){this.tx+=t;this.ty+=e;return this};n.prototype.identity=function(){this.a=this.d=1;this.b=this.c=this.tx=this.ty=0;return this};n.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,o=t*n-e*i;this.a=n/o;this.b=-e/o;this.c=-i/o;this.d=t/o;this.tx=(i*this.ty-n*r)/o;this.ty=-(t*this.ty-e*r)/o;return this};n.transformCoords=function(t,i,n){var r=e.Point.identity;r.x=t.a*i+t.c*n+t.tx;r.y=t.d*n+t.b*i+t.ty;return r};n.prototype.toArray=function(t){this.array||(this.array=new Float32Array(9));t?(this.array[0]=this.a,this.array[1]=this.b,this.array[2]=0,this.array[3]=this.c,this.array[4]=this.d,this.array[5]=0,this.array[6]=this.tx,this.array[7]=this.ty):(this.array[0]=this.a,this.array[1]=this.b,this.array[2]=this.tx,this.array[3]=this.c,this.array[4]=this.d,this.array[5]=this.ty,this.array[6]=0,this.array[7]=0);this.array[8]=1;return this.array};n.identity=new n;n.DEG_TO_RAD=Math.PI/180;return n}(e.HashObject);e.Matrix=i;i.prototype.__class__="egret.Matrix"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(t,i){"undefined"===typeof t&&(t=0);"undefined"===typeof i&&(i=0);e.call(this);this.x=t;this.y=i}t(i,e);i.prototype.clone=function(){return new i(this.x,this.y)};i.prototype.equals=function(t){return this.x==t.x&&this.y==t.y};i.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))};i.identity=new i(0,0);return i}(e.HashObject);e.Point=i;i.prototype.__class__="egret.Point"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(t,i,n,r){"undefined"===typeof t&&(t=0);"undefined"===typeof i&&(i=0);"undefined"===typeof n&&(n=0);"undefined"===typeof r&&(r=0);e.call(this);this.x=t;this.y=i;this.width=n;this.height=r}t(i,e);Object.defineProperty(i.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:!0,configurable:!0});Object.defineProperty(i.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:!0,configurable:!0});i.prototype.initialize=function(t,e,i,n){this.x=t;this.y=e;this.width=i;this.height=n;return this};i.prototype.contains=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e};i.prototype.intersects=function(t){return this.contains(t.x,t.y)||this.contains(t.x,t.bottom)||this.contains(t.right,t.y)||this.contains(t.right,t.bottom)?!0:!1};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height)};i.prototype.containsPoint=function(t){return this.x<t.x&&this.x+this.width>t.x&&this.y<t.y&&this.y+this.height>t.y?!0:!1};i.identity=new i(0,0,0,0);return i}(e.HashObject);e.Rectangle=i;i.prototype.__class__="egret.Rectangle"})(egret);(function(t){var e=function(){function e(){}e.fatal=function(e,i){"undefined"===typeof i&&(i=null);t.Logger.traceToConsole("Fatal",e,i);throw Error(t.Logger.getTraceCode("Fatal",e,i))};e.info=function(e,i){"undefined"===typeof i&&(i=null);t.Logger.traceToConsole("Info",e,i)};e.warning=function(e,i){"undefined"===typeof i&&(i=null);t.Logger.traceToConsole("Warning",e,i)};e.traceToConsole=function(e,i,n){console.log(t.Logger.getTraceCode(e,i,n))};e.getTraceCode=function(t,e,i){return"["+t+"]"+e+":"+(null==i?"":i)};return e}();t.Logger=e;e.prototype.__class__="egret.Logger"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this._isSupportDOMParser=this._xmlDict=this._parser=null;this._xmlDict={};window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):this._isSupportDOMParser=!1}t(n,i);n.getInstance=function(){n._instance||(n._instance=new n);return n._instance};n.prototype.parserXML=function(t){for(var i=0;"\n"==t.charAt(i)||"	"==t.charAt(i)||"\r"==t.charAt(i)||" "==t.charAt(i);)i++;0!=i&&(t=t.substring(i,t.length));this._isSupportDOMParser?i=this._parser.parseFromString(t,"text/xml"):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(t));null==i&&e.Logger.info("xml not found!");return i};n._instance=null;return n}(e.HashObject);e.SAXParser=i;i.prototype.__class__="egret.SAXParser"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this._designHeight=this._designWidth=0;this._scaleY=this._scaleX=1;var t=document.getElementById(n.canvas_name),e=t.height;this._designWidth=t.width;this._designHeight=e}t(n,i);n.getInstance=function(){null==n.instance&&(r.initialize(),n.instance=new n);return n.instance};n.prototype.setDesignSize=function(t,i,n){this._designWidth=t;this._designHeight=i;n&&(e.Logger.warning("该方法目前不应传入 resolutionPolicy 参数，请在 docs/1.0_Final_ReleaseNote中查看如何升级"),this._setResolutionPolicy(n))};n.prototype._setResolutionPolicy=function(t){this._resolutionPolicy=t;t.init(this);t._apply(this,this._designWidth,this._designHeight)};n.prototype.getScaleX=function(){return this._scaleX};n.prototype.getScaleY=function(){return this._scaleY};n.canvas_name="gameCanvas";n.canvas_div_name="gameDiv";return n}(e.HashObject);e.StageDelegate=i;i.prototype.__class__="egret.StageDelegate";var n=function(){function t(t,e){this.setContainerStrategy(t);this.setContentStrategy(e)}t.prototype.init=function(t){this._containerStrategy.init(t);this._contentStrategy.init(t)};t.prototype._apply=function(t,e,i){this._containerStrategy._apply(t,e,i);this._contentStrategy._apply(t,e,i)};t.prototype.setContainerStrategy=function(t){t instanceof r&&(this._containerStrategy=t)};t.prototype.setContentStrategy=function(t){t instanceof s&&(this._contentStrategy=t)};return t}();e.ResolutionPolicy=n;n.prototype.__class__="egret.ResolutionPolicy";var r=function(){function t(){}t.initialize=function(){t.EQUAL_TO_FRAME=new o};t.prototype.init=function(t){};t.prototype._apply=function(t,e,i){};t.prototype._setupContainer=function(){var t=document.body,e;t&&(e=t.style)&&(e.paddingTop=e.paddingTop||"0px",e.paddingRight=e.paddingRight||"0px",e.paddingBottom=e.paddingBottom||"0px",e.paddingLeft=e.paddingLeft||"0px",e.borderTop=e.borderTop||"0px",e.borderRight=e.borderRight||"0px",e.borderBottom=e.borderBottom||"0px",e.borderLeft=e.borderLeft||"0px",e.marginTop=e.marginTop||"0px",e.marginRight=e.marginRight||"0px",e.marginBottom=e.marginBottom||"0px",e.marginLeft=e.marginLeft||"0px")};return t}();e.ContainerStrategy=r;r.prototype.__class__="egret.ContainerStrategy";var o=function(e){function i(){e.apply(this,arguments)}t(i,e);i.prototype._apply=function(t){this._setupContainer()};return i}(r);e.EqualToFrame=o;o.prototype.__class__="egret.EqualToFrame";var s=function(){function t(){}t.prototype.init=function(t){};t.prototype._apply=function(t,e,i){};return t}();e.ContentStrategy=s;s.prototype.__class__="egret.ContentStrategy";n=function(e){function n(t){"undefined"===typeof t&&(t=0);e.call(this);this.minWidth=t}t(n,e);n.prototype._apply=function(t,e,n){e=document.getElementById(i.canvas_name);var r=document.getElementById(i.canvas_div_name),o=document.documentElement.clientWidth,s=document.documentElement.clientHeight,a=s/n,h=o/a,c=1;0!=this.minWidth&&(c=Math.min(1,h/this.minWidth));e.width=h/c;e.height=n;e.style.width=o+"px";e.style.height=s*c+"px";r.style.width=o+"px";r.style.height=s*c+"px";t._scaleX=a*c;t._scaleY=a*c};return n}(s);e.FixedHeight=n;n.prototype.__class__="egret.FixedHeight";n=function(e){function n(t){"undefined"===typeof t&&(t=0);e.call(this);this.minHeight=t}t(n,e);n.prototype._apply=function(t,e,n){n=document.getElementById(i.canvas_name);var r=document.getElementById(i.canvas_div_name),o=document.documentElement.clientWidth,s=document.documentElement.clientHeight,a=o/e,h=s/a,c=1;0!=this.minHeight&&(c=Math.min(1,h/this.minHeight));n.width=e;n.height=h/c;n.style.width=o*c+"px";n.style.height=s+"px";r.style.width=o*c+"px";r.style.height=s+"px";t._scaleX=a*c;t._scaleY=a*c};return n}(s);e.FixedWidth=n;n.prototype.__class__="egret.FixedWidth";n=function(e){function n(t,i){e.call(this);this.width=t;this.height=i}t(n,e);n.prototype._apply=function(t,e,n){n=document.getElementById(i.canvas_name);var r=document.getElementById(i.canvas_div_name),o=this.width,s=this.height,a=o/e;n.width=e;n.height=s/a;n.style.width=o+"px";n.style.height=s+"px";r.style.width=o+"px";r.style.height=s+"px";t._scaleX=a;t._scaleY=a};return n}(s);e.FixedSize=n;n.prototype.__class__="egret.FixedSize";n=function(e){function n(){e.call(this)}t(n,e);n.prototype._apply=function(t,e,n){e=document.getElementById(i.canvas_name);e.style.width=e.width+"px";e.style.height=e.height+"px";t._scaleX=1;t._scaleY=1};return n}(s);e.NoScale=n;n.prototype.__class__="egret.NoScale"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this._originalData={};this._drawAreaList=[]}t(n,i);n.getInstance=function(){null==n.instance&&(n.instance=new n);return n.instance};n.prototype.addDrawArea=function(t){this._drawAreaList.push(t)};n.prototype.clearDrawArea=function(){this._drawAreaList=[]};n.prototype.drawImage=function(t,i,n,r,o,s,a,h,c,u){a=a||0;h=h||0;var p=i._texture_to_render;if(null!=p&&0!=s&&0!=o&&0!=c&&0!=u)if(i._worldBounds){var l=this._originalData;l.sourceX=n;l.sourceY=r;l.sourceWidth=o;l.sourceHeight=s;l.destX=a;l.destY=h;l.destWidth=c;l.destHeight=u;for(var d=this.getDrawAreaList(),f=0;f<d.length;f++){var _=d[f];if(!this.ignoreRender(i,_,l.destX,l.destY)){if(0!=this._drawAreaList.length)if(0!=i._worldTransform.b||0!=i._worldTransform.c){if(i._worldBounds.x+l.destX<_.x||i._worldBounds.y+l.destY<_.y||i._worldBounds.x+i._worldBounds.width+l.destX>_.x+_.width||i._worldBounds.y+i._worldBounds.height+l.destY>_.y+_.height){e.Logger.fatal("请不要让带有旋转和斜切的显示对象跨过重绘区域");break}}else{var y=i._worldTransform.a,g=i._worldTransform.d,m;i._worldBounds.x+l.destX<_.x&&(m=(_.x-i._worldBounds.x)/y-l.destX,n+=m/(c/o),o-=m/(c/o),c-=m,a+=m);i._worldBounds.y+l.destY<_.y&&(m=(_.y-i._worldBounds.y)/g-l.destY,r+=m/(u/s),s-=m/(u/s),u-=m,h+=m);i._worldBounds.x+i._worldBounds.width+l.destX>_.x+_.width&&(m=(i._worldBounds.x+i._worldBounds.width-_.x-_.width)/y+l.destX,o-=m/(c/o),c-=m);i._worldBounds.y+i._worldBounds.height+l.destY>_.y+_.height&&(m=(i._worldBounds.y+i._worldBounds.height-_.y-_.height)/g+l.destY,s-=m/(u/s),u-=m)}t.drawImage(p,n,r,o,s,a,h,c,u)}}}else t.drawImage(p,n,r,o,s,a,h,c,u)};n.prototype.ignoreRender=function(t,e,i,n){var r=t._worldBounds;i*=t._worldTransform.a;n*=t._worldTransform.d;return r.x+r.width+i<=e.x||r.x+i>=e.x+e.width||r.y+r.height+n<=e.y||r.y+n>=e.y+e.height?!0:!1};n.prototype.getDrawAreaList=function(){var t;0==this._drawAreaList.length?(this._defaultDrawAreaList||(this._defaultDrawAreaList=[new e.Rectangle(0,0,e.MainContext.instance.stage.stageWidth,e.MainContext.instance.stage.stageHeight)]),t=this._defaultDrawAreaList):t=this._drawAreaList;return t};return n}(e.HashObject);e.RenderFilter=i;
i.prototype.__class__="egret.RenderFilter"})(egret);(function(t){var e=function(){function e(){}e.mapClass=function(t,e,i){"undefined"===typeof i&&(i="");t=this.getKey(t)+"#"+i;this.mapClassDic[t]=e};e.getKey=function(e){return"string"==typeof e?e:t.getQualifiedClassName(e)};e.mapValue=function(t,e,i){"undefined"===typeof i&&(i="");t=this.getKey(t)+"#"+i;this.mapValueDic[t]=e};e.hasMapRule=function(t,e){"undefined"===typeof e&&(e="");var i=this.getKey(t)+"#"+e;return this.mapValueDic[i]||this.mapClassDic[i]?!0:!1};e.getInstance=function(t,e){"undefined"===typeof e&&(e="");var i=this.getKey(t)+"#"+e;if(this.mapValueDic[i])return this.mapValueDic[i];var n=this.mapClassDic[i];if(n)return n=new n,this.mapValueDic[i]=n,delete this.mapClassDic[i],n;throw Error("调用了未配置的注入规则:"+i+"。 请先在项目初始化里配置指定的注入规则，再调用对应单例。")};e.mapClassDic={};e.mapValueDic={};return e}();t.Injector=e;e.prototype.__class__="egret.Injector"})(egret);(function(t){var e=function(){function t(){}t.NORMAL="normal";t.ADD="add";t.LAYER="layer";return t}();t.BlendMode=e;e.prototype.__class__="egret.BlendMode"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this._sizeDirty=this._normalDirty=!0;this._parent=null;this._cacheAsBitmap=!1;this._y=this._x=0;this._scaleY=this._scaleX=1;this._anchorY=this._anchorX=this._anchorOffsetY=this._anchorOffsetX=0;this._visible=!0;this._rotation=0;this._alpha=1;this._skewY=this._skewX=0;this._hasHeightSet=this._hasWidthSet=!1;this.worldAlpha=1;this._rectH=this._rectW=0;this._worldTransform=new e.Matrix;this._cacheBounds=new e.Rectangle(0,0,0,0)}t(n,i);n.prototype._setDirty=function(){this._normalDirty=!0};n.prototype.getDirty=function(){return this._normalDirty||this._sizeDirty};n.prototype._setParentSizeDirty=function(){!this.parent||this.parent._hasWidthSet||this.parent._hasHeightSet||this.parent._setSizeDirty()};n.prototype._setSizeDirty=function(){this._sizeDirty||(this._sizeDirty=!0,this._setDirty(),this._setParentSizeDirty())};n.prototype._clearDirty=function(){this._normalDirty=!1};n.prototype._clearSizeDirty=function(){this._sizeDirty=!1};Object.defineProperty(n.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0});n.prototype._parentChanged=function(t){this._parent=t};Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(t){e.NumberUtils.isNumber(t)&&(this._x=t,this._setDirty(),this._setParentSizeDirty())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(t){e.NumberUtils.isNumber(t)&&(this._y=t,this._setDirty(),this._setParentSizeDirty())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"scaleX",{get:function(){return this._scaleX},set:function(t){e.NumberUtils.isNumber(t)&&(this._scaleX=t,this._setDirty(),this._setParentSizeDirty())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"scaleY",{get:function(){return this._scaleY},set:function(t){e.NumberUtils.isNumber(t)&&(this._scaleY=t,this._setDirty(),this._setParentSizeDirty())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"anchorOffsetX",{get:function(){return this._anchorOffsetX},set:function(t){e.NumberUtils.isNumber(t)&&(this._anchorOffsetX=t,this._setDirty(),this._setParentSizeDirty())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"anchorOffsetY",{get:function(){return this._anchorOffsetY},set:function(t){e.NumberUtils.isNumber(t)&&(this._anchorOffsetY=t,this._setDirty(),this._setParentSizeDirty())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"anchorX",{get:function(){return this._anchorX},set:function(t){e.NumberUtils.isNumber(t)&&(this._anchorX=t,this._setDirty(),this._setParentSizeDirty())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"anchorY",{get:function(){return this._anchorY},set:function(t){e.NumberUtils.isNumber(t)&&(this._anchorY=t,this._setDirty(),this._setParentSizeDirty())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t;this._setSizeDirty()},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"rotation",{get:function(){return this._rotation},set:function(t){e.NumberUtils.isNumber(t)&&(this._rotation=t,this._setSizeDirty())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"alpha",{get:function(){return this._alpha},set:function(t){e.NumberUtils.isNumber(t)&&(this._alpha=t,this._setDirty())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"skewX",{get:function(){return this._skewX},set:function(t){e.NumberUtils.isNumber(t)&&(this._skewX=t,this._setSizeDirty())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"skewY",{get:function(){return this._skewY},set:function(t){e.NumberUtils.isNumber(t)&&(this._skewY=t,this._setSizeDirty())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"touchEnabled",{get:function(){return this._touchEnabled},set:function(t){this._touchEnabled=t},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"scrollRect",{get:function(){return this._scrollRect},set:function(t){this._scrollRect=t;this._setSizeDirty()},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"measuredWidth",{get:function(){return this._measureBounds().width},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"measuredHeight",{get:function(){return this._measureBounds().height},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"explicitWidth",{get:function(){return this._explicitWidth},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"explicitHeight",{get:function(){return this._explicitHeight},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"width",{get:function(){return this._getSize(e.Rectangle.identity).width},set:function(t){this._setWidth(t)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"height",{get:function(){return this._getSize(e.Rectangle.identity).height},set:function(t){this._setHeight(t)},enumerable:!0,configurable:!0});n.prototype._setWidth=function(t){this._setSizeDirty();this._explicitWidth=t;this._hasWidthSet=e.NumberUtils.isNumber(t)};n.prototype._setHeight=function(t){this._setSizeDirty();this._explicitHeight=t;this._hasHeightSet=e.NumberUtils.isNumber(t)};n.prototype._draw=function(t){if(this.visible&&!this.drawCacheTexture(t)){t.setAlpha(this.worldAlpha,this.blendMode);t.setTransform(this._worldTransform);var e=this.mask||this._scrollRect;e&&t.pushMask(e);this._render(t);e&&t.popMask()}this.destroyCacheBounds()};n.prototype.drawCacheTexture=function(t){if(this._cacheAsBitmap){var i=this._texture_to_render,n=i._offsetX,r=i._offsetY,o=i._textureWidth,i=i._textureHeight;this._updateTransform();t.setAlpha(this.worldAlpha,this.blendMode);t.setTransform(this._worldTransform);var s=e.MainContext.instance.rendererContext.texture_scale_factor;e.RenderFilter.getInstance().drawImage(t,this,0,0,o*s,i*s,n,r,o,i);return!0}return!1};n.prototype._updateTransform=function(){this._worldTransform.identity().appendMatrix(this._parent._worldTransform);var t=this._getOffsetPoint();this._worldTransform.appendTransform(this._x,this._y,this._scaleX,this._scaleY,this._rotation,this._skewX,this._skewY,t.x,t.y);this._scrollRect&&this._worldTransform.append(1,0,0,1,-this._scrollRect.x,-this._scrollRect.y);this.worldAlpha=this._parent.worldAlpha*this._alpha};n.prototype._render=function(t){};n.prototype.getBounds=function(t){var i=this._measureBounds(),n=this._hasWidthSet?this._explicitWidth:i.width,r=this._hasHeightSet?this._explicitHeight:i.height,o=i.x,i=i.y,s,a;0!=this._anchorX||0!=this._anchorY?(s=n*this._anchorX,a=r*this._anchorY):(s=this._anchorOffsetX,a=this._anchorOffsetY);this._cacheBounds.initialize(o-s,i-a,n,r);n=this._cacheBounds;t||(t=new e.Rectangle);return t.initialize(n.x,n.y,n.width,n.height)};n.prototype.destroyCacheBounds=function(){this._cacheBounds.x=0;this._cacheBounds.y=0;this._cacheBounds.width=0;this._cacheBounds.height=0};n.prototype._getConcatenatedMatrix=function(){for(var t=n.identityMatrixForGetConcatenated.identity(),i=this;null!=i;){if(0!=i._anchorX||0!=i._anchorY){var r=i._getSize(e.Rectangle.identity);t.prependTransform(i._x,i._y,i._scaleX,i._scaleY,i._rotation,i._skewX,i._skewY,r.width*i._anchorX,r.height*i._anchorY)}else t.prependTransform(i._x,i._y,i._scaleX,i._scaleY,i._rotation,i._skewX,i._skewY,i._anchorOffsetX,i._anchorOffsetY);i=i._parent}return t};n.prototype.localToGlobal=function(t,i,n){"undefined"===typeof t&&(t=0);"undefined"===typeof i&&(i=0);var r=this._getConcatenatedMatrix();r.append(1,0,0,1,t,i);n||(n=new e.Point);n.x=r.tx;n.y=r.ty;return n};n.prototype.globalToLocal=function(t,i,n){"undefined"===typeof t&&(t=0);"undefined"===typeof i&&(i=0);var r=this._getConcatenatedMatrix();r.invert();r.append(1,0,0,1,t,i);n||(n=new e.Point);n.x=r.tx;n.y=r.ty;return n};n.prototype.hitTest=function(t,i,n){"undefined"===typeof n&&(n=!1);if(!this.visible||!n&&!this._touchEnabled)return null;n=this._getSize(e.Rectangle.identity);return 0<=t&&t<n.width&&0<=i&&i<n.height?this.mask||this._scrollRect?this._scrollRect&&t<this._scrollRect.width&&i<this._scrollRect.height||this.mask&&this.mask.x<=t&&t<this.mask.x+this.mask.width&&this.mask.y<=i&&i<this.mask.y+this.mask.height?this:null:this:null};n.prototype.hitTestPoint=function(t,i,n){t=this.globalToLocal(t,i);return n?(this._hitTestPointTexture||(this._hitTestPointTexture=new e.RenderTexture),n=this._hitTestPointTexture,n.drawToTexture(this),0!=n.getPixel32(t.x-this._hitTestPointTexture._offsetX,t.y-this._hitTestPointTexture._offsetY)[3]?!0:!1):!!this.hitTest(t.x,t.y,!0)};n.prototype._getMatrix=function(){var t=e.Matrix.identity.identity(),i=this._getOffsetPoint();t.appendTransform(this._x,this._y,this._scaleX,this._scaleY,this._rotation,this._skewX,this._skewY,i.x,i.y);return t};n.prototype._getSize=function(t){return this._hasHeightSet&&this._hasWidthSet?t.initialize(0,0,this._explicitWidth,this._explicitHeight):this._measureSize(e.Rectangle.identity)};n.prototype._measureSize=function(t){this._sizeDirty?(t=this._measureBounds(),this._rectW=t.width,this._rectH=t.height,this._clearSizeDirty()):(t.width=this._rectW,t.height=this._rectH);return t};n.prototype._measureBounds=function(){return e.Rectangle.identity.initialize(0,0,0,0)};n.prototype._getOffsetPoint=function(){var t=this._anchorOffsetX,i=this._anchorOffsetY;if(0!=this._anchorX||0!=this._anchorY)i=this._getSize(e.Rectangle.identity),t=this._anchorX*i.width,i=this._anchorY*i.height;var n=e.Point.identity;n.x=t;n.y=i;return n};n.prototype._onAddToStage=function(){this._stage=e.MainContext.instance.stage;e.DisplayObjectContainer.__EVENT__ADD_TO_STAGE_LIST.push(this)};n.prototype._onRemoveFromStage=function(){this._stage=null;e.DisplayObjectContainer.__EVENT__REMOVE_FROM_STAGE_LIST.push(this)};Object.defineProperty(n.prototype,"stage",{get:function(){return this._stage},enumerable:!0,configurable:!0});n.prototype.addEventListener=function(t,r,o,s,a){"undefined"===typeof s&&(s=!1);"undefined"===typeof a&&(a=0);i.prototype.addEventListener.call(this,t,r,o,s,a);((s=t==e.Event.ENTER_FRAME)||t==e.Event.RENDER)&&this._insertEventBin(s?n._enterFrameCallBackList:n._renderCallBackList,r,o,a)};n.prototype.removeEventListener=function(t,r,o,s){"undefined"===typeof s&&(s=!1);i.prototype.removeEventListener.call(this,t,r,o,s);((s=t==e.Event.ENTER_FRAME)||t==e.Event.RENDER)&&this._removeEventBin(s?n._enterFrameCallBackList:n._renderCallBackList,r,o)};n.prototype.dispatchEvent=function(t){if(!t._bubbles)return i.prototype.dispatchEvent.call(this,t);for(var e=[],n=this;n;)e.unshift(n),n=n.parent;for(var r=e.length,n=r-1,r=r-2;0<=r;r--)e.push(e[r]);t._reset();this._dispatchPropagationEvent(t,e,n);return!t.isDefaultPrevented()};n.prototype._dispatchPropagationEvent=function(t,e,i){for(var n=e.length,r=0;r<n;r++){var o=e[r];t._setCurrentTarget(o);t._target=this;t._eventPhase=r<i?1:r==i?2:3;o._notifyListener(t);if(t._isPropagationStopped||t._isPropagationImmediateStopped)break}};n.prototype.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e._parent}return!1};Object.defineProperty(n.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){(this._cacheAsBitmap=t)?(this.renderTexture||(this.renderTexture=new e.RenderTexture),this.renderTexture.drawToTexture(this),this._texture_to_render=this.renderTexture):this._texture_to_render=null},enumerable:!0,configurable:!0});n.getTransformBounds=function(t,e){var i,n,r=t.width,o=t.height,s=r*e.a,r=r*e.b,a=o*e.c,o=o*e.d,h=e.tx,c=e.ty,u=h,p=h,l=c,d=c;(i=s+h)<u?u=i:i>p&&(p=i);(i=s+a+h)<u?u=i:i>p&&(p=i);(i=a+h)<u?u=i:i>p&&(p=i);(n=r+c)<l?l=n:n>d&&(d=n);(n=r+o+c)<l?l=n:n>d&&(d=n);(n=o+c)<l?l=n:n>d&&(d=n);return t.initialize(u,l,p-u,d-l)};n.identityMatrixForGetConcatenated=new e.Matrix;n._enterFrameCallBackList=[];n._renderCallBackList=[];return n}(e.EventDispatcher);e.DisplayObject=i;i.prototype.__class__="egret.DisplayObject"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this._touchChildren=!0;this._children=[]}t(n,i);Object.defineProperty(n.prototype,"touchChildren",{get:function(){return this._touchChildren},set:function(t){this._touchChildren=t},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"numChildren",{get:function(){return this._children.length},enumerable:!0,configurable:!0});n.prototype.setChildIndex=function(t,e){this.doSetChildIndex(t,e)};n.prototype.doSetChildIndex=function(t,i){var n=this._children.indexOf(t);0>n&&e.Logger.fatal("child不在当前容器内");this._children.splice(n,1);0>i||this._children.length<=i?this._children.push(t):this._children.splice(i,0,t)};n.prototype.addChild=function(t){var e=this.numChildren;t._parent==this&&e--;return this._doAddChild(t,e)};n.prototype.addChildAt=function(t,e){return this._doAddChild(t,e)};n.prototype._doAddChild=function(t,i,r){"undefined"===typeof r&&(r=!0);if(t==this)return t;if(0>i||i>this._children.length)return e.Logger.fatal("提供的索引超出范围"),t;var o=t.parent;if(o==this)return this.doSetChildIndex(t,i),t;o&&o.removeChild(t);this._children.splice(i,0,t);t._parentChanged(this);r&&t.dispatchEventWith(e.Event.ADDED,!0);if(this._stage)for(t._onAddToStage(),i=n.__EVENT__ADD_TO_STAGE_LIST;0<i.length;)i.shift().dispatchEventWith(e.Event.ADDED_TO_STAGE);t._setDirty();this._setSizeDirty();return t};n.prototype.removeChild=function(t){t=this._children.indexOf(t);if(0<=t)return this._doRemoveChild(t);e.Logger.fatal("child未被addChild到该parent");return null};n.prototype.removeChildAt=function(t){if(0<=t&&t<this._children.length)return this._doRemoveChild(t);e.Logger.fatal("提供的索引超出范围");return null};n.prototype._doRemoveChild=function(t,i){"undefined"===typeof i&&(i=!0);var r=this._children,o=r[t];i&&o.dispatchEventWith(e.Event.REMOVED,!0);if(this._stage){o._onRemoveFromStage();for(var s=n.__EVENT__REMOVE_FROM_STAGE_LIST;0<s.length;)s.shift().dispatchEventWith(e.Event.REMOVED_FROM_STAGE)}o._parentChanged(null);r.splice(t,1);this._setSizeDirty();return o};n.prototype.getChildAt=function(t){if(0<=t&&t<this._children.length)return this._children[t];e.Logger.fatal("提供的索引超出范围");return null};n.prototype.contains=function(t){for(;t;){if(t==this)return!0;t=t._parent}return!1};n.prototype.swapChildrenAt=function(t,i){0<=t&&t<this._children.length&&0<=i&&i<this._children.length?this._swapChildrenAt(t,i):e.Logger.fatal("提供的索引超出范围")};n.prototype.swapChildren=function(t,i){var n=this._children.indexOf(t),r=this._children.indexOf(i);-1==n||-1==r?e.Logger.fatal("child未被addChild到该parent"):this._swapChildrenAt(n,r)};n.prototype._swapChildrenAt=function(t,e){if(t!=e){var i=this._children,n=i[t];i[t]=i[e];i[e]=n}};n.prototype.getChildIndex=function(t){return this._children.indexOf(t)};n.prototype.removeChildren=function(){for(var t=this._children.length-1;0<=t;t--)this._doRemoveChild(t)};n.prototype._updateTransform=function(){if(this.visible){i.prototype._updateTransform.call(this);for(var t=0,e=this._children.length;t<e;t++)this._children[t]._updateTransform()}};n.prototype._render=function(t){for(var e=0,i=this._children.length;e<i;e++)this._children[e]._draw(t)};n.prototype._measureBounds=function(){for(var t=0,i=0,n=0,r=0,o=this._children.length,s=0;s<o;s++){var a=this._children[s],h;if(a.visible&&(h=e.DisplayObject.getTransformBounds(a._getSize(e.Rectangle.identity),a._getMatrix()))){var a=h.x,c=h.y,u=h.width+h.x,p=h.height+h.y;if(a<t||0==s)t=a;if(u>i||0==s)i=u;if(c<n||0==s)n=c;if(p>r||0==s)r=p}}return e.Rectangle.identity.initialize(t,n,i-t,r-n)};n.prototype.hitTest=function(t,n,r){"undefined"===typeof r&&(r=!1);var o;if(!this.visible)return null;if(this._scrollRect){if(0>t||0>n||t>this._scrollRect.width||n>this._scrollRect.height)return null}else if(this.mask&&(this.mask.x>t||t>this.mask.x+this.mask.width||this.mask.y>n||n>this.mask.y+this.mask.height))return null;for(var s=this._children,a=this._touchChildren,h=s.length-1;0<=h;h--){var c=s[h],u=c,p=u._getOffsetPoint(),l=u._x,d=u._y;this._scrollRect&&(l-=this._scrollRect.x,d-=this._scrollRect.y);u=e.Matrix.identity.identity().prependTransform(l,d,u._scaleX,u._scaleY,u._rotation,0,0,p.x,p.y);u.invert();u=e.Matrix.transformCoords(u,t,n);if(c=c.hitTest(u.x,u.y,!0)){if(c._touchEnabled&&a)return c;if(this._touchEnabled)return this;null==o&&(o=c)}}return o?o:i.prototype.hitTest.call(this,t,n,r)};n.prototype._onAddToStage=function(){i.prototype._onAddToStage.call(this);for(var t=this.numChildren,e=0;e<t;e++)this._children[e]._onAddToStage()};n.prototype._onRemoveFromStage=function(){i.prototype._onRemoveFromStage.call(this);for(var t=this.numChildren,e=0;e<t;e++)this._children[e]._onRemoveFromStage()};n.prototype.getChildByName=function(t){for(var e=this._children,i=this.numChildren,n,r=0;r<i;r++)if(n=e[r],n.name==t)return n;return null};n.__EVENT__ADD_TO_STAGE_LIST=[];n.__EVENT__REMOVE_FROM_STAGE_LIST=[];return n}(e.DisplayObject);e.DisplayObjectContainer=i;i.prototype.__class__="egret.DisplayObjectContainer"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t,e){"undefined"===typeof t&&(t=480);"undefined"===typeof e&&(e=800);i.call(this);this.touchEnabled=!0;this._stage=this;this._stageWidth=t;this._stageHeight=e}t(n,i);n.prototype.invalidate=function(){n._invalidateRenderFlag=!0};Object.defineProperty(n.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){if(this._scaleMode!=t){this._scaleMode=t;var i={};i[e.StageScaleMode.NO_SCALE]=new e.NoScale;i[e.StageScaleMode.SHOW_ALL]=new e.FixedWidth;t=i[t];if(!t)throw Error("使用了尚未实现的ScaleMode");i=new e.EqualToFrame;t=new e.ResolutionPolicy(i,t);e.StageDelegate.getInstance()._setResolutionPolicy(t);t=document.getElementById(e.StageDelegate.canvas_name);this._stageWidth=t.width;this._stageHeight=t.height;this.dispatchEventWith(e.Event.RESIZE)}},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"stageWidth",{get:function(){return this._stageWidth},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"stageHeight",{get:function(){return this._stageHeight},enumerable:!0,configurable:!0});n.prototype.hitTest=function(t,i){if(!this.touchEnabled)return null;var n;if(!this.visible)return this;for(var r=this._children,o=r.length-1;0<=o;o--){var s=n=r[o],a=s._getOffsetPoint(),s=e.Matrix.identity.identity().prependTransform(s.x,s.y,s.scaleX,s.scaleY,s.rotation,0,0,a.x,a.y);s.invert();s=e.Matrix.transformCoords(s,t,i);if((n=n.hitTest(s.x,s.y,!0))&&n.touchEnabled)return n}return this};n.prototype.getBounds=function(t){t||(t=new e.Rectangle);return t.initialize(0,0,this._stageWidth,this._stageHeight)};n.prototype._updateTransform=function(){for(var t=0,e=this._children.length;t<e;t++)this._children[t]._updateTransform()};n._invalidateRenderFlag=!1;return n}(e.DisplayObjectContainer);e.Stage=i;i.prototype.__class__="egret.Stage"})(egret);(function(t){var e=function(){function t(){}t.NO_SCALE="noScale";t.SHOW_ALL="showAll";return t}();t.StageScaleMode=e;e.prototype.__class__="egret.StageScaleMode"})(egret);(function(t){var e=function(){function t(){}t.REPEAT="repeat";t.SCALE="scale";return t}();t.BitmapFillMode=e;e.prototype.__class__="egret.BitmapFillMode"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t){i.call(this);this.debug=!1;this.debugColor=16711680;this.fillMode="scale";t&&(this._texture=t,this._setSizeDirty())}t(n,i);Object.defineProperty(n.prototype,"texture",{get:function(){return this._texture},set:function(t){t!=this._texture&&(this._setSizeDirty(),this._texture=t)},enumerable:!0,configurable:!0});n.prototype._render=function(t){var e=this._texture;e?(this._texture_to_render=e,n._drawBitmap(t,this._hasWidthSet?this._explicitWidth:e._textureWidth,this._hasHeightSet?this._explicitHeight:e._textureHeight,this)):this._texture_to_render=null};n._drawBitmap=function(t,i,r,o){var s=o._texture_to_render;if(s){var a=s._textureWidth,h=s._textureHeight;if("scale"==o.fillMode){var c=o.scale9Grid||s.scale9Grid;if(c&&a-c.width<i&&h-c.height<r)n.drawScale9GridImage(t,o,c,i,r);else{var c=s._offsetX,u=s._offsetY,p=s._bitmapWidth||a,l=s._bitmapHeight||h;i/=a;c=Math.round(c*i);i=Math.round(p*i);r/=h;u=Math.round(u*r);r=Math.round(l*r);e.RenderFilter.getInstance().drawImage(t,o,s._bitmapX,s._bitmapY,p,l,c,u,i,r)}}else n.drawRepeatImage(t,o,i,r)}};n.drawRepeatImage=function(t,i,n,r){var o=i._texture_to_render;if(o)for(var s=o._textureWidth,a=o._textureHeight,h=o._bitmapX,c=o._bitmapY,u=o._bitmapWidth||s,p=o._bitmapHeight||a,l=o._offsetX,o=o._offsetY,d=e.RenderFilter.getInstance();l<n;l+=s)for(var f=o;f<r;f+=a){var _=Math.min(u,n-l),y=Math.min(p,r-f);d.drawImage(t,i,h,c,u,p,l,f,_,y)}};n.drawScale9GridImage=function(t,i,n,r,o){var s=i._texture_to_render;if(s&&n){var a=e.RenderFilter.getInstance(),h=s._textureWidth,c=s._textureHeight,u=s._bitmapX,p=s._bitmapY,l=s._bitmapWidth||h,d=s._bitmapHeight||c,f=s._offsetX,s=s._offsetY;n=e.Rectangle.identity.initialize(n.x-Math.round(f),n.y-Math.round(f),n.width,n.height);f=Math.round(f);s=Math.round(s);r-=h-l;o-=c-d;n.y==n.bottom&&(n.bottom<d?n.bottom++:n.y--);n.x==n.right&&(n.right<l?n.right++:n.x--);var h=u+n.x,c=u+n.right,_=l-n.right,y=p+n.y,g=p+n.bottom,m=d-n.bottom,v=f+n.x,x=s+n.y,d=o-(d-n.bottom),l=r-(l-n.right);a.drawImage(t,i,u,p,n.x,n.y,f,s,n.x,n.y);a.drawImage(t,i,h,p,n.width,n.y,v,s,l-n.x,n.y);a.drawImage(t,i,c,p,_,n.y,f+l,s,r-l,n.y);a.drawImage(t,i,u,y,n.x,n.height,f,x,n.x,d-n.y);a.drawImage(t,i,h,y,n.width,n.height,v,x,l-n.x,d-n.y);a.drawImage(t,i,c,y,_,n.height,f+l,x,r-l,d-n.y);a.drawImage(t,i,u,g,n.x,m,f,s+d,n.x,o-d);a.drawImage(t,i,h,g,n.width,m,v,s+d,l-n.x,o-d);a.drawImage(t,i,c,g,_,m,f+l,s+d,r-l,o-d)}};n.prototype._measureBounds=function(){var t=this._texture;return t?e.Rectangle.identity.initialize(t._offsetX,t._offsetY,t._textureWidth,t._textureHeight):i.prototype._measureBounds.call(this)};n.debug=!1;return n}(e.DisplayObject);e.Bitmap=i;i.prototype.__class__="egret.Bitmap"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this._text="";this._textChanged=!1;this._bitmapPool=[]}t(n,i);Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(t){this._textChanged=!0;this._text=t},enumerable:!0,configurable:!0});n.prototype._updateTransform=function(){this.visible&&(this._textChanged&&this._renderText(),i.prototype._updateTransform.call(this))};n.prototype._renderText=function(t){var i=t=0;this._textChanged&&this.removeChildren();for(var n=0,r=this.text.length;n<r;n++){var o=this.text.charAt(n),s=this.spriteSheet.getTexture(o);if(null==s)console.log("当前没有位图文字："+o);else{var o=s._offsetX,a=s._offsetY,h=s._textureWidth;if(this._textChanged){var c=this._bitmapPool[n];c||(c=new e.Bitmap,this._bitmapPool.push(c));c.texture=s;this.addChild(c);c.x=t}t+=h+o;a+s._textureHeight>i&&(i=a+s._textureHeight)}}this._textChanged=!1;return e.Rectangle.identity.initialize(0,0,t,i)};n.prototype._measureBounds=function(){return this._renderText(!0)};return n}(e.DisplayObjectContainer);e.BitmapText=i;i.prototype.__class__="egret.BitmapText"})(egret);(function(t){var e=function(){function t(){this.commandQueue=[]}t.prototype.beginFill=function(t,e){};t.prototype._setStyle=function(t){};t.prototype.drawRect=function(t,e,i,n){};t.prototype.drawCircle=function(t,e,i){};t.prototype.lineStyle=function(t,e,i,n,r,o,s,a){};t.prototype.lineTo=function(t,e){};t.prototype.curveTo=function(t,e,i,n){};t.prototype.moveTo=function(t,e){};t.prototype.clear=function(){};t.prototype.endFill=function(){};t.prototype._draw=function(t){};return t}();t.Graphics=e;e.prototype.__class__="egret.Graphics";(function(){var t=function(t,e,i){this.method=t;this.thisObject=e;this.args=i};t.prototype.__class__="Command";return t})()})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this)}t(n,i);Object.defineProperty(n.prototype,"graphics",{get:function(){this._graphics||(this._graphics=new e.Graphics);return this._graphics},enumerable:!0,configurable:!0});n.prototype._render=function(t){this._graphics&&this._graphics._draw(t)};return n}(e.DisplayObject);e.Shape=i;i.prototype.__class__="egret.Shape"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this)}t(n,i);Object.defineProperty(n.prototype,"graphics",{get:function(){this._graphics||(this._graphics=new e.Graphics);return this._graphics},enumerable:!0,configurable:!0});n.prototype._render=function(t){this._graphics&&this._graphics._draw(t);i.prototype._render.call(this,t)};return n}(e.DisplayObjectContainer);e.Sprite=i;i.prototype.__class__="egret.Sprite"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this._fontFamily="Arial";this._size=30;this._textColorString="#FFFFFF";this._textColor=16777215;this._strokeColorString="#000000";this._stroke=this._strokeColor=0;this._textAlign="left";this._verticalAlign="top";this._numLines=this._lineSpacing=0;this.measuredWidths=[]}t(n,i);Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(t){this._text!=t&&(this._setTextDirty(),this._text=t)},enumerable:!0,configurable:!0});n.prototype._setTextDirty=function(){this._setSizeDirty()};Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this._fontFamily!=t&&(this._setTextDirty(),this._fontFamily=t)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"size",{get:function(){return this._size},set:function(t){this._size!=t&&(this._setTextDirty(),this._size=t)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"italic",{get:function(){return this._italic},set:function(t){this._italic!=t&&(this._setTextDirty(),this._italic=t)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"bold",{get:function(){return this._bold},set:function(t){this._bold!=t&&(this._setTextDirty(),this._bold=t)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"textColor",{get:function(){return this._textColor},set:function(t){this._textColor!=t&&(this._setTextDirty(),this._textColor=t,this._textColorString=e.toColorString(t))},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(t){this._strokeColor!=t&&(this._setTextDirty(),this._strokeColor=t,this._strokeColorString=e.toColorString(t))},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"stroke",{get:function(){return this._stroke},set:function(t){this._stroke!=t&&(this._setTextDirty(),this._stroke=t)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"textAlign",{get:function(){return this._textAlign},set:function(t){this._textAlign!=t&&(this._setTextDirty(),this._textAlign=t)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._setTextDirty(),this._verticalAlign=t)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(t){this._lineSpacing!=t&&(this._setTextDirty(),this._lineSpacing=t)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"numLines",{get:function(){return this._numLines},enumerable:!0,configurable:!0});n.prototype._render=function(t){this.drawText(t,!1);this._clearDirty()};n.prototype._measureBounds=function(){return this.drawText(e.MainContext.instance.rendererContext,!0)};n.prototype.drawText=function(t,i){var n=this.getTextLines(t);if(!n)return e.Rectangle.identity.initialize(0,0,0,0);var r=n.length,o=.5*this._size,s=this._size+this._lineSpacing,a=r*s-this._lineSpacing;this._textHeight=a;var h=this._hasHeightSet?this._explicitHeight:Number.POSITIVE_INFINITY;if(this._hasHeightSet&&a<h){var c=0;this._verticalAlign==e.VerticalAlign.MIDDLE?c=.5:this._verticalAlign==e.VerticalAlign.BOTTOM&&(c=1);o+=c*(h-a)}var c=o=Math.round(o),u=0;this._textAlign==e.HorizontalAlign.CENTER?u=.5:this._textAlign==e.HorizontalAlign.RIGHT&&(u=1);var p=this.measuredWidths,l;l=this._hasWidthSet?this._explicitWidth:this._textWidth;for(var d=Number.POSITIVE_INFINITY,f=0;f<r;f++){var _=n[f],y=Math.round((l-p[f])*u);y<d&&(d=y);!i&&o<h&&t.drawText(this,_,y,o,l);o+=s}return e.Rectangle.identity.initialize(d,c,l,a)};n.prototype.getTextLines=function(t){var e=this.text?this.text.toString():"";if(!e)return null;var i=this.measuredWidths;i.length=0;t.setupFont(this);var e=e.split(/(?:\r\n|\r|\n)/),n=e.length,r=0;if(this._hasWidthSet)for(var o=this._explicitWidth,s=0;s<n;s++){var a=e[s],h=t.measureText(a);if(h>o){for(var c="",u=0,p=a.length,l=0;l<p;l++){var d=a.charAt(l),h=t.measureText(d);u+h>o&&(0==u?(e.splice(s,0,d),i[s]=h,r<h&&(r=h),h=0,d=""):(e.splice(s,0,c),i[s]=u,r<u&&(r=u),c="",u=0),s++,n++);u+=h;c+=d}e[s]=c;i[s]=u}else i[s]=h,r<h&&(r=h)}else for(s=0;s<n;s++)a=e[s],h=t.measureText(a),i[s]=h,r<h&&(r=h);this._textWidth=r;return e};return n}(e.DisplayObject);e.TextField=i;i.prototype.__class__="egret.TextField"})(egret);(function(t){var e=function(){function t(){}t.DYNAMIC="dynamic";t.INPUT="input";return t}();t.TextFieldType=e;e.prototype.__class__="egret.TextFieldType"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t){i.call(this);var e=t.bitmapData;this.bitmapData=e;this._textureMap={};this._sourceWidth=e.width;this._sourceHeight=e.height;this._bitmapX=t._bitmapX-t._offsetX;this._bitmapY=t._bitmapY-t._offsetY}t(n,i);n.prototype.getTexture=function(t){return this._textureMap[t]};n.prototype.createTexture=function(t,i,n,r,o,s,a,h,c){"undefined"===typeof s&&(s=0);"undefined"===typeof a&&(a=0);"undefined"===typeof h&&(h=s+r);
"undefined"===typeof c&&(c=a+o);var u=new e.Texture;u._bitmapData=this.bitmapData;u._bitmapX=this._bitmapX+i;u._bitmapY=this._bitmapY+n;u._bitmapWidth=r;u._bitmapHeight=o;u._offsetX=s;u._offsetY=a;u._textureWidth=h;u._textureHeight=c;u._sourceWidth=this._sourceWidth;u._sourceHeight=this._sourceHeight;return this._textureMap[t]=u};return n}(e.HashObject);e.SpriteSheet=i;i.prototype.__class__="egret.SpriteSheet"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.apply(this,arguments);this._placeholderText="";this._edFontSize=14;this._textColor=16711680;this._placeholderFontSize=14;this._placeholderColor=16776960;this._preY=this._preX=0}t(n,i);n.prototype._onAddToStage=function(){i.prototype._onAddToStage.call(this);var t=this.localToGlobal(),n=new e.StageText;n._open(t.x,t.y,this._explicitWidth,this._explicitHeight);this.addEventListener(e.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this);this.stageText=n};n.prototype.setText=function(t){this.stageText._setText(t)};n.prototype.getText=function(){return this.stageText._getText()};n.prototype.setTextType=function(t){this.stageText._setTextType(t)};n.prototype.getTextType=function(){return this.stageText._getTextType()};n.prototype.onMouseDownHandler=function(t){};n.prototype._onRemoveFromStage=function(){this.stageText._remove()};n.prototype._measureBounds=function(){return e.Rectangle.identity};n.prototype.hitTest=function(t,e,i){return null};return n}(e.DisplayObject);e.TextInput=i;i.prototype.__class__="egret.TextInput";i=function(){function t(){}t.prototype.editBoxEditingDidBegin=function(t){};t.prototype.editBoxEditingDidEnd=function(t){};t.prototype.editBoxTextChanged=function(t,e){};t.prototype.editBoxReturn=function(t){};return t}();e.TextInputDegelete=i;i.prototype.__class__="egret.TextInputDegelete"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(t,i){e.call(this,t);this.charList=this.parseConfig(i)}t(i,e);i.prototype.getTexture=function(t){var e=this._textureMap[t];if(!e){e=this.charList[t];if(!e)return null;e=this.createTexture(t,e.x,e.y,e.width,e.height,e.offsetX,e.offsetY);this._textureMap[t]=e}return e};i.prototype.parseConfig=function(t){t=t.split("\r\n").join("\n");t=t.split("\n");for(var e=this.getConfigByKey(t[3],"count"),i={},n=4;n<4+e;n++){var r=t[n],o=String.fromCharCode(this.getConfigByKey(r,"id")),s={};i[o]=s;s.x=this.getConfigByKey(r,"x");s.y=this.getConfigByKey(r,"y");s.width=this.getConfigByKey(r,"width");s.height=this.getConfigByKey(r,"height");s.offsetX=this.getConfigByKey(r,"xoffset");s.offsetY=this.getConfigByKey(r,"yoffset")}return i};i.prototype.getConfigByKey=function(t,e){for(var i=t.split(" "),n=0,r=i.length;n<r;n++){var o=i[n];if(e==o.substring(0,e.length))return i=o.substring(e.length+1),parseInt(i)}return 0};return i}(e.SpriteSheet);e.BitmapTextSpriteSheet=i;i.prototype.__class__="egret.BitmapTextSpriteSheet"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function r(t,r){i.call(this);this.frameRate=60;t instanceof n?(e.Logger.warning("MovieClip#constructor接口参数已经变更，请尽快调整用法为 new MovieClip(data,texture)"),this.delegate=t):this.delegate=new n(t,r);this.delegate.setMovieClip(this)}t(r,i);r.prototype.gotoAndPlay=function(t){this.delegate.gotoAndPlay(t)};r.prototype.gotoAndStop=function(t){this.delegate.gotoAndStop(t)};r.prototype.stop=function(){this.delegate.stop()};r.prototype.dispose=function(){this.delegate.dispose()};r.prototype.release=function(){e.Logger.warning("MovieClip#release方法即将废弃");this.dispose()};r.prototype.getCurrentFrameIndex=function(){e.Logger.warning("MovieClip#getCurrentFrameIndex方法即将废弃");return this.delegate._currentFrameIndex};r.prototype.getTotalFrame=function(){e.Logger.warning("MovieClip#getTotalFrame方法即将废弃");return this.delegate._totalFrame};r.prototype.setInterval=function(t){e.Logger.warning("MovieClip#setInterval方法即将废弃,请使用MovieClip#frameRate代替");this.frameRate=60/t};r.prototype.getIsPlaying=function(){e.Logger.warning("MovieClip#getIsPlaying方法即将废弃");return this.delegate.isPlaying};return r}(e.DisplayObjectContainer);e.MovieClip=i;i.prototype.__class__="egret.MovieClip";var n=function(){function t(t,i){this.data=t;this._currentFrameIndex=this._passTime=this._totalFrame=0;this._isPlaying=!1;this._frameData=t;this._spriteSheet=new e.SpriteSheet(i)}t.prototype.setMovieClip=function(t){this.movieClip=t;this.bitmap=new e.Bitmap;this.movieClip.addChild(this.bitmap)};t.prototype.gotoAndPlay=function(t){this.checkHasFrame(t);this._isPlaying=!0;this._currentFrameIndex=0;this._currentFrameName=t;this._totalFrame=this._frameData.frames[t].totalFrame;this.playNextFrame();this._passTime=0;e.Ticker.getInstance().register(this.update,this)};t.prototype.gotoAndStop=function(t){this.checkHasFrame(t);this.stop();this._currentFrameIndex=this._passTime=0;this._currentFrameName=t;this._totalFrame=this._frameData.frames[t].totalFrame;this.playNextFrame()};t.prototype.stop=function(){this._isPlaying=!1;e.Ticker.getInstance().unregister(this.update,this)};t.prototype.dispose=function(){};t.prototype.checkHasFrame=function(t){void 0==this._frameData.frames[t]&&e.Logger.fatal("MovieClip没有对应的frame：",t)};t.prototype.update=function(t){for(var e=1e3/this.movieClip.frameRate,e=Math.floor((this._passTime%e+t)/e);1<=e;)1==e?this.playNextFrame():this.playNextFrame(!1),e--;this._passTime+=t};t.prototype.playNextFrame=function(t){"undefined"===typeof t&&(t=!0);var e=this._frameData.frames[this._currentFrameName].childrenFrame[this._currentFrameIndex];if(t){t=this.getTexture(e.res);var i=this.bitmap;i.x=e.x;i.y=e.y;i.texture=t}null!=e.action&&this.movieClip.dispatchEventWith(e.action);this._currentFrameIndex++;this._currentFrameIndex==this._totalFrame&&(this._currentFrameIndex=0)};t.prototype.getTexture=function(t){var e=this._frameData.res[t],i=this._spriteSheet.getTexture(t);i||(i=this._spriteSheet.createTexture(t,e.x,e.y,e.w,e.h));return i};return t}();e.DefaultMovieClipDelegate=n;n.prototype.__class__="egret.DefaultMovieClipDelegate"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this)}t(n,i);n.prototype._getText=function(){return this.inputElement.value};n.prototype._setText=function(t){this.inputElement.value=t};n.prototype._setTextType=function(t){this.inputElement.type=t};n.prototype._getTextType=function(){return this.inputElement.type};n.prototype._open=function(t,i,n,r){"undefined"===typeof n&&(n=160);"undefined"===typeof r&&(r=21);var o=e.StageDelegate.getInstance().getScaleX(),s=e.StageDelegate.getInstance().getScaleY(),a=document.createElement("input");a.type="text";a.style.fontSize="20px";a.style.color="#FFFFFF";a.style.borderStyle="none";a.style.background="none";a.style.width=n*o+"px";a.style.height=r*s+"px";a.style.outline="medium";var h=e.Browser.getInstance().$new("div");h.style.position="absolute";h.position.x=t*o;h.style.width=n*o+"px";h.style.height=r*s+"px";h.position.y=i*s;h.transforms();h.appendChild(a);t=e.Browser.getInstance().$("#StageDelegateDiv");t||(n=document.getElementById(e.StageDelegate.canvas_div_name),r=n.clientHeight,n=n.clientWidth,t=e.Browser.getInstance().$new("div"),t.id="StageDelegateDiv",t.style.position="absolute",t.style.width=n+"px",t.style.maxHeight=r+"px",t.style.margin="0px",document.getElementById(e.StageDelegate.canvas_div_name).appendChild(t),t.position.y=-r,t.transforms());t.appendChild(h);this.div=h;this.inputElement=a};n.prototype._remove=function(){var t=this.div;t&&t.parentNode&&t.parentNode.removeChild(t)};return n}(e.HashObject);e.StageText=i;i.prototype.__class__="egret.StageText"})(egret||(egret={}));(function(t){var e=function(){function t(){}t.GET="GET";t.POST="POST";return t}();t.URLRequestMethod=e;e.prototype.__class__="egret.URLRequestMethod"})(egret);(function(t){var e=function(){function t(){}t.BINARY="binary";t.TEXT="text";t.VARIABLES="variables";t.TEXTURE="texture";t.SOUND="sound";return t}();t.URLLoaderDataFormat=e;e.prototype.__class__="egret.URLLoaderDataFormat"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(t){"undefined"===typeof t&&(t=null);e.call(this);null!==t&&this.decode(t)}t(i,e);i.prototype.decode=function(t){this.variables||(this.variables={});t=t.split("+").join(" ");for(var e,i=/[?&]?([^=]+)=([^&]*)/g;e=i.exec(t);)this.variables[decodeURIComponent(e[1])]=decodeURIComponent(e[2])};i.prototype.toString=function(){if(!this.variables)return"";var t=this.variables,e="",i=!0,n;for(n in t)i?i=!1:e+="&",e+=n+"="+t[n];return e};return i}(e.HashObject);e.URLVariables=i;i.prototype.__class__="egret.URLVariables"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t){"undefined"===typeof t&&(t=null);i.call(this);this.method=e.URLRequestMethod.GET;this.url=t}t(n,i);return n}(e.HashObject);e.URLRequest=i;i.prototype.__class__="egret.URLRequest"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t){"undefined"===typeof t&&(t=null);i.call(this);this.dataFormat=e.URLLoaderDataFormat.TEXT;t&&this.load(t)}t(n,i);n.prototype.load=function(t){this._request=t;this.data=null;e.MainContext.instance.netContext.proceed(this)};return n}(e.EventDispatcher);e.URLLoader=i;i.prototype.__class__="egret.URLLoader"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this._textureHeight=this._textureWidth=this._offsetY=this._offsetX=this._bitmapHeight=this._bitmapWidth=this._bitmapY=this._bitmapX=0}t(n,i);Object.defineProperty(n.prototype,"textureWidth",{get:function(){return this._textureWidth},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"textureHeight",{get:function(){return this._textureHeight},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"bitmapData",{get:function(){return this._bitmapData},enumerable:!0,configurable:!0});n.prototype._setBitmapData=function(t){var i=e.MainContext.instance.rendererContext.texture_scale_factor;this._bitmapData=t;this._sourceWidth=t.width;this._sourceHeight=t.height;this._textureWidth=this._sourceWidth*i;this._textureHeight=this._sourceHeight*i;this._bitmapWidth=this._textureWidth;this._bitmapHeight=this._textureHeight;this._offsetX=this._offsetY=this._bitmapX=this._bitmapY=0};n.prototype.getPixel32=function(t,e){return this._bitmapData.getContext("2d").getImageData(t,e,1,1).data};return n}(e.HashObject);e.Texture=i;i.prototype.__class__="egret.Texture"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this._bitmapData=document.createElement("canvas");this.renderContext=e.RendererContext.createRendererContext(this._bitmapData)}t(n,i);n.prototype.drawToTexture=function(t){var i=this._bitmapData,n=t.getBounds(e.Rectangle.identity);i.width=n.width;i.height=n.height;t._worldTransform.identity();t.worldAlpha=1;if(t instanceof e.DisplayObjectContainer){this._offsetX=n.x;this._offsetY=n.y;t._worldTransform.append(1,0,0,1,-n.x,-n.y);for(var i=t._children,n=0,r=i.length;n<r;n++)i[n]._updateTransform()}i=e.RenderFilter.getInstance();n=i._drawAreaList.concat();i._drawAreaList.length=0;this.renderContext.clearScreen();this.webGLTexture=null;(r=t.mask||t._scrollRect)&&this.renderContext.pushMask(r);t._render(this.renderContext);r&&this.renderContext.popMask();i._drawAreaList=n;this._textureWidth=this._bitmapData.width;this._textureHeight=this._bitmapData.height;this._sourceWidth=this._textureWidth;this._sourceHeight=this._textureHeight};return n}(e.Texture);e.RenderTexture=i;i.prototype.__class__="egret.RenderTexture"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this.renderCost=0;this.texture_scale_factor=1}t(n,i);n.prototype.clearScreen=function(){};n.prototype.clearRect=function(t,e,i,n){};n.prototype.drawImage=function(t,i,n,r,o,s,a,h,c){e.Profiler.getInstance().onDrawImage()};n.prototype.setTransform=function(t){};n.prototype.setAlpha=function(t,e){};n.prototype.setupFont=function(t){};n.prototype.measureText=function(t){return 0};n.prototype.drawText=function(t,i,n,r,o){e.Profiler.getInstance().onDrawImage()};n.prototype.strokeRect=function(t,e,i,n,r){};n.prototype.pushMask=function(t){};n.prototype.popMask=function(){};n.createRendererContext=function(t){return null};return n}(e.HashObject);e.RendererContext=i;i.prototype.__class__="egret.RendererContext"})(egret);(function(t){var e=function(){function t(){}t.MOUSE="mouse";t.TOUCH="touch";t.mode="touch";return t}();t.InteractionMode=e;e.prototype.__class__="egret.InteractionMode"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this._currentTouchTarget={};this.maxTouches=2;this.touchDownTarget={};this.lastTouchY=this.lastTouchX=-1}t(n,i);n.prototype.run=function(){};n.prototype.getTouchData=function(t,e,i){var n=this._currentTouchTarget[t];null==n&&(n={},this._currentTouchTarget[t]=n);n.stageX=e;n.stageY=i;n.identifier=t;return n};n.prototype.dispatchEvent=function(t,i){e.TouchEvent.dispatchTouchEvent(i.target,t,i.identifier,i.stageX,i.stageY,!1,!1,!1,!0==this.touchDownTarget[i.identifier])};n.prototype.onTouchBegan=function(t,i,n){var r=e.MainContext.instance.stage.hitTest(t,i);r&&(t=this.getTouchData(n,t,i),this.touchDownTarget[n]=!0,t.target=r,t.beginTarget=r,this.dispatchEvent(e.TouchEvent.TOUCH_BEGIN,t))};n.prototype.onTouchMove=function(t,i,n){if(t!=this.lastTouchX||i!=this.lastTouchY){this.lastTouchX=t;this.lastTouchY=i;var r=e.MainContext.instance.stage.hitTest(t,i);r&&(t=this.getTouchData(n,t,i),t.target=r,this.dispatchEvent(e.TouchEvent.TOUCH_MOVE,t))}};n.prototype.onTouchEnd=function(t,i,n){var r=e.MainContext.instance.stage.hitTest(t,i);r&&(t=this.getTouchData(n,t,i),delete this.touchDownTarget[n],n=t.beginTarget,t.target=r,this.dispatchEvent(e.TouchEvent.TOUCH_END,t),n==r?this.dispatchEvent(e.TouchEvent.TOUCH_TAP,t):t.beginTarget&&(t.target=t.beginTarget,this.dispatchEvent(e.TouchEvent.TOUCH_RELEASE_OUTSIDE,t)),delete this._currentTouchTarget[t.identifier])};return n}(e.HashObject);e.TouchContext=i;i.prototype.__class__="egret.TouchContext"})(egret||(egret={}));t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(){e.call(this)}t(i,e);i.prototype.proceed=function(t){};return i}(e.HashObject);e.NetContext=i;i.prototype.__class__="egret.NetContext"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(){e.call(this);this.frameRate=60}t(i,e);i.prototype.executeMainLoop=function(t,e){};return i}(e.HashObject);e.DeviceContext=i;i.prototype.__class__="egret.DeviceContext"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this.translate=this.isHD?function(t){return"translate3d("+t.x+"px, "+(t.y-e.MainContext.instance.stage.stageHeight)+"px, 0) "}:function(t){return"translate("+t.x+"px, "+t.y+"px) "};this.rotate=this.isHD?function(t){return"rotateZ("+t+"deg) "}:function(t){return"rotate("+t+"deg) "};this.ua=navigator.userAgent.toLowerCase();var t=this.ua.match(/micromessenger|qqbrowser|mqqbrowser|ucbrowser|360browser|baidubrowser|maxthon|ie|opera|firefox/)||this.ua.match(/chrome|safari/);t&&0<t.length&&(t=t[0],"micromessenger"==t&&(this.type="wechat"),this.type=t);this.type="unknow";switch(this.type){case"firefox":this.pfx="Moz";this.isHD=!0;break;case"chrome":case"safari":this.pfx="webkit";this.isHD=!0;break;case"opera":this.pfx="O";this.isHD=!1;break;case"ie":this.pfx="ms";this.isHD=!1;break;default:this.pfx="webkit",this.isHD=!0}this.trans=this.pfx+"Transform"}t(n,i);n.getInstance=function(){null==n.instance&&(n.instance=new n);return n.instance};Object.defineProperty(n.prototype,"isMobile",{get:function(){e.Logger.warning("Browser.isMobile接口参数已经变更，请尽快调整用法为 egret.MainContext.deviceType == egret.MainContext.DEVICE_MOBILE ");return e.MainContext.deviceType==e.MainContext.DEVICE_MOBILE},enumerable:!0,configurable:!0});n.prototype.$new=function(t){return this.$(document.createElement(t))};n.prototype.$=function(t){var i=document;if(t=t instanceof HTMLElement?t:i.querySelector(t))t.find=t.find||this.$,t.hasClass=t.hasClass||function(t){return this.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},t.addClass=t.addClass||function(t){this.hasClass(t)||(this.className&&(this.className+=" "),this.className+=t);return this},t.removeClass=t.removeClass||function(t){this.hasClass(t)&&(this.className=this.className.replace(t,""));return this},t.remove=t.remove||function(){},t.appendTo=t.appendTo||function(t){t.appendChild(this);return this},t.prependTo=t.prependTo||function(t){t.childNodes[0]?t.insertBefore(this,t.childNodes[0]):t.appendChild(this);return this},t.transforms=t.transforms||function(){this.style[n.getInstance().trans]=n.getInstance().translate(this.position)+n.getInstance().rotate(this.rotation)+n.getInstance().scale(this.scale)+n.getInstance().skew(this.skew);return this},t.position=t.position||{x:0,y:0},t.rotation=t.rotation||0,t.scale=t.scale||{x:1,y:1},t.skew=t.skew||{x:0,y:0},t.translates=function(t,i){this.position.x=t;this.position.y=i-e.MainContext.instance.stage.stageHeight;this.transforms();return this},t.rotate=function(t){this.rotation=t;this.transforms();return this},t.resize=function(t,e){this.scale.x=t;this.scale.y=e;this.transforms();return this},t.setSkew=function(t,e){this.skew.x=t;this.skew.y=e;this.transforms();return this};return t};n.prototype.scale=function(t){return"scale("+t.x+", "+t.y+") "};n.prototype.skew=function(t){return"skewX("+-t.x+"deg) skewY("+t.y+"deg)"};return n}(e.HashObject);e.Browser=i;i.prototype.__class__="egret.Browser"})(egret);(function(t){var e=function(){function e(){}e.parse=function(i){i=t.SAXParser.getInstance().parserXML(i);if(!i||!i.childNodes)return null;for(var n=i.childNodes.length,r=!1,o=0;o<n;o++){var s=i.childNodes[o];if(1==s.nodeType){r=!0;break}}return r?e.parseNode(s):null};e.parseNode=function(t){if(!t||1!=t.nodeType)return null;var i={};i.localName=t.localName;i.name=t.nodeName;t.namespaceURI&&(i.namespace=t.namespaceURI);t.prefix&&(i.prefix=t.prefix);for(var n=t.attributes,r=n.length,o=0;o<r;o++){var s=n[o],a=s.name;0!=a.indexOf("xmlns:")&&(i["$"+a]=s.value)}n=t.childNodes;r=n.length;for(o=0;o<r;o++)if(s=e.parseNode(n[o]))i.children||(i.children=[]),s.parent=i,i.children.push(s);!i.children&&(t=t.textContent.trim())&&(i.text=t);return i};e.findChildren=function(t,i,n){n?n.length=0:n=[];e.findByPath(t,i,n);return n};e.findByPath=function(t,i,n){var r=i.indexOf("."),o;-1==r?(o=i,r=!0):(o=i.substring(0,r),i=i.substring(r+1),r=!1);if(t=t.children)for(var s=t.length,a=0;a<s;a++){var h=t[a];h.localName==o&&(r?n.push(h):e.findByPath(h,i,n))}};e.getAttributes=function(t,e){e?e.length=0:e=[];for(var i in t)"$"==i.charAt(0)&&e.push(i.substring(1));return e};return e}();t.XML=e;e.prototype.__class__="egret.XML"})(egret);(function(t){var e=function(){function t(){}t.LITTLE_ENDIAN="LITTLE_ENDIAN";t.BIG_ENDIAN="BIG_ENDIAN";return t}();t.Endian=e;e.prototype.__class__="egret.Endian";var i=function(){function t(){this.length=this.position=0;this._mode="";this.maxlength=0;this._endian=e.LITTLE_ENDIAN;this.isLittleEndian=!1;this._mode="Typed array";this.maxlength=4;this.arraybytes=new ArrayBuffer(this.maxlength);this.unalignedarraybytestemp=new ArrayBuffer(16);this.endian=t.DEFAULT_ENDIAN}Object.defineProperty(t.prototype,"endian",{get:function(){return this._endian},set:function(t){this._endian=t;this.isLittleEndian=t==e.LITTLE_ENDIAN},enumerable:!0,configurable:!0});t.prototype.ensureWriteableSpace=function(t){this.ensureSpace(t+this.position)};t.prototype.setArrayBuffer=function(t){this.ensureSpace(t.byteLength);this.length=t.byteLength;t=new Int8Array(t);new Int8Array(this.arraybytes,0,this.length).set(t);this.position=0};Object.defineProperty(t.prototype,"bytesAvailable",{get:function(){return this.length-this.position},enumerable:!0,configurable:!0});t.prototype.ensureSpace=function(t){if(t>this.maxlength){t=t+255&-256;var e=new ArrayBuffer(t),i=new Uint8Array(this.arraybytes,0,this.length);new Uint8Array(e,0,this.length).set(i);this.arraybytes=e;this.maxlength=t}};t.prototype.writeByte=function(t){this.ensureWriteableSpace(1);new Int8Array(this.arraybytes)[this.position++]=~~t;this.position>this.length&&(this.length=this.position)};t.prototype.readByte=function(){if(this.position>=this.length)throw"ByteArray out of bounds read. Positon="+this.position+", Length="+this.length;return new Int8Array(this.arraybytes)[this.position++]};t.prototype.readBytes=function(t,e,i){"undefined"===typeof e&&(e=0);"undefined"===typeof i&&(i=0);null==i&&(i=t.length);t.ensureWriteableSpace(e+i);var n=new Int8Array(t.arraybytes),r=new Int8Array(this.arraybytes);n.set(r.subarray(this.position,this.position+i),e);this.position+=i;i+e>t.length&&(t.length+=i+e-t.length)};t.prototype.writeUnsignedByte=function(t){this.ensureWriteableSpace(1);new Uint8Array(this.arraybytes)[this.position++]=~~t&255;this.position>this.length&&(this.length=this.position)};t.prototype.readUnsignedByte=function(){if(this.position>=this.length)throw"ByteArray out of bounds read. Positon="+this.position+", Length="+this.length;return new Uint8Array(this.arraybytes)[this.position++]};t.prototype.writeUnsignedShort=function(t){this.ensureWriteableSpace(2);if(0==(this.position&1)){var e=new Uint16Array(this.arraybytes);e[this.position>>1]=~~t&65535}else e=new Uint16Array(this.unalignedarraybytestemp,0,1),e[0]=~~t&65535,t=new Uint8Array(this.arraybytes,this.position,2),e=new Uint8Array(this.unalignedarraybytestemp,0,2),t.set(e);this.position+=2;this.position>this.length&&(this.length=this.position)};t.prototype.readUTFBytes=function(t){var e="";t=this.position+t;for(var i=new DataView(this.arraybytes);this.position<t;){var n=i.getUint8(this.position++);if(128>n){if(0==n)break;e+=String.fromCharCode(n)}else if(224>n)e+=String.fromCharCode((n&63)<<6|i.getUint8(this.position++)&127);else if(240>n)var r=i.getUint8(this.position++),e=e+String.fromCharCode((n&31)<<12|(r&127)<<6|i.getUint8(this.position++)&127);else var r=i.getUint8(this.position++),o=i.getUint8(this.position++),e=e+String.fromCharCode((n&15)<<18|(r&127)<<12|o<<6&127|i.getUint8(this.position++)&127)}return e};t.prototype.readInt=function(){var t=new DataView(this.arraybytes).getInt32(this.position,this.isLittleEndian);this.position+=4;return t};t.prototype.readShort=function(){var t=new DataView(this.arraybytes).getInt16(this.position,this.isLittleEndian);this.position+=2;return t};t.prototype.readDouble=function(){var t=new DataView(this.arraybytes).getFloat64(this.position,this.isLittleEndian);this.position+=8;return t};t.prototype.readUnsignedShort=function(){if(this.position>this.length+2)throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length;if(0==(this.position&1)){var t=new Uint16Array(this.arraybytes),e=this.position>>1;this.position+=2;return t[e]}t=new Uint16Array(this.unalignedarraybytestemp,0,1);e=new Uint8Array(this.arraybytes,this.position,2);new Uint8Array(this.unalignedarraybytestemp,0,2).set(e);this.position+=2;return t[0]};t.prototype.writeUnsignedInt=function(t){this.ensureWriteableSpace(4);if(0==(this.position&3)){var e=new Uint32Array(this.arraybytes);e[this.position>>2]=~~t&4294967295}else e=new Uint32Array(this.unalignedarraybytestemp,0,1),e[0]=~~t&4294967295,t=new Uint8Array(this.arraybytes,this.position,4),e=new Uint8Array(this.unalignedarraybytestemp,0,4),t.set(e);this.position+=4;this.position>this.length&&(this.length=this.position)};t.prototype.readUnsignedInt=function(){if(this.position>this.length+4)throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length;if(0==(this.position&3)){var t=new Uint32Array(this.arraybytes),e=this.position>>2;this.position+=4;return t[e]}t=new Uint32Array(this.unalignedarraybytestemp,0,1);e=new Uint8Array(this.arraybytes,this.position,4);new Uint8Array(this.unalignedarraybytestemp,0,4).set(e);this.position+=4;return t[0]};t.prototype.writeFloat=function(t){this.ensureWriteableSpace(4);if(0==(this.position&3)){var e=new Float32Array(this.arraybytes);e[this.position>>2]=t}else e=new Float32Array(this.unalignedarraybytestemp,0,1),e[0]=t,t=new Uint8Array(this.arraybytes,this.position,4),e=new Uint8Array(this.unalignedarraybytestemp,0,4),t.set(e);this.position+=4;this.position>this.length&&(this.length=this.position)};t.prototype.readFloat=function(){if(this.position>this.length+4)throw"ByteArray out of bounds read. Positon="+this.position+", Length="+this.length;if(0==(this.position&3)){var t=new Float32Array(this.arraybytes),e=this.position>>2;this.position+=4;return t[e]}t=new Float32Array(this.unalignedarraybytestemp,0,1);e=new Uint8Array(this.arraybytes,this.position,4);new Uint8Array(this.unalignedarraybytestemp,0,4).set(e);this.position+=4;return t[0]};t.DEFAULT_ENDIAN=e.BIG_ENDIAN;return t}();t.ByteArray=i;i.prototype.__class__="egret.ByteArray"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t,e,n){i.call(this);this._target=null;this.loop=this.ignoreGlobalPause=this._useTicks=!1;this._actions=this._steps=this.pluginData=null;this.paused=!1;this.duration=0;this._prevPos=-1;this.position=null;this._stepPosition=this._prevPosition=0;this.passive=!1;this.initialize(t,e,n)}t(n,i);n.get=function(t,e,i,r){"undefined"===typeof e&&(e=null);"undefined"===typeof i&&(i=null);"undefined"===typeof r&&(r=!1);r&&n.removeTweens(t);return new n(t,e,i)};n.removeTweens=function(t){if(t.tween_count){for(var e=n._tweens,i=e.length-1;0<=i;i--)e[i]._target==t&&(e[i].paused=!0,e.splice(i,1));t.tween_count=0}};n.tick=function(t,e){"undefined"===typeof e&&(e=!1);for(var i=n._tweens.concat(),r=i.length-1;0<=r;r--){var o=i[r];e&&!o.ignoreGlobalPause||o.paused||o.tick(o._useTicks?1:t)}};n._register=function(t,i){var r=t._target,o=n._tweens;if(i)r&&(r.tween_count=r.tween_count?r.tween_count+1:1),o.push(t),n._inited||(e.Ticker.getInstance().register(n.tick,null),n._inited=!0);else for(r&&r.tween_count--,r=o.length;r--;)if(o[r]==t){o.splice(r,1);break}};n.removeAllTweens=function(){for(var t=n._tweens,e=0,i=t.length;e<i;e++){var r=t[e];r.paused=!0;r._target.tweenjs_count=0}t.length=0};n.prototype.initialize=function(t,e,i){this._target=t;e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&n.removeTweens(t));this.pluginData=i||{};this._curQueueProps={};this._initQueueProps={};this._steps=[];this._actions=[];e&&e.paused?this.paused=!0:n._register(this,!0);e&&null!=e.position&&this.setPosition(e.position,n.NONE)};n.prototype.setPosition=function(t,e){"undefined"===typeof e&&(e=1);0>t&&(t=0);var i=t,n=!1;i>=this.duration&&(this.loop?i%=this.duration:(i=this.duration,n=!0));if(i==this._prevPos)return n;var r=this._prevPos;this.position=this._prevPos=i;this._prevPosition=t;if(this._target)if(n)this._updateTargetProps(null,1);else if(0<this._steps.length){for(var o=0,s=this._steps.length;o<s&&!(this._steps[o].t>i);o++);o=this._steps[o-1];this._updateTargetProps(o,(this._stepPosition=i-o.t)/o.d)}0!=e&&0<this._actions.length&&(this._useTicks?this._runActions(i,i):1==e&&i<r?(r!=this.duration&&this._runActions(r,this.duration),this._runActions(0,i,!0)):this._runActions(r,i));n&&this.setPaused(!0);this.dispatchEventWith("change");return n};n.prototype._runActions=function(t,e,i){"undefined"===typeof i&&(i=!1);var n=t,r=e,o=-1,s=this._actions.length,a=1;t>e&&(n=e,r=t,o=s,s=a=-1);for(;(o+=a)!=s;){e=this._actions[o];var h=e.t;(h==r||h>n&&h<r||i&&h==t)&&e.f.apply(e.o,e.p)}};n.prototype._updateTargetProps=function(t,e){var i,r,o,s;if(t||1!=e){if(this.passive=!!t.v)return;t.e&&(e=t.e(e,0,1,1));i=t.p0;r=t.p1}else this.passive=!1,i=r=this._curQueueProps;for(var a in this._initQueueProps){null==(o=i[a])&&(i[a]=o=this._initQueueProps[a]);null==(s=r[a])&&(r[a]=s=o);o=o==s||0==e||1==e||"number"!=typeof o?1==e?s:o:o+(s-o)*e;var h=!1;if(s=n._plugins[a])for(var c=0,u=s.length;c<u;c++){var p=s[c].tween(this,a,o,i,r,e,!!t&&i==r,!t);p==n.IGNORE?h=!0:o=p}h||(this._target[a]=o)}};n.prototype.setPaused=function(t){this.paused=t;n._register(this,!t);return this};n.prototype._cloneProps=function(t){var e={},i;for(i in t)e[i]=t[i];return e};n.prototype._addStep=function(t){0<t.d&&(this._steps.push(t),t.t=this.duration,this.duration+=t.d);return this};n.prototype._appendQueueProps=function(t){var e,i,r,o,s,a;for(a in t)if(void 0===this._initQueueProps[a]){i=this._target[a];if(e=n._plugins[a])for(r=0,o=e.length;r<o;r++)i=e[r].init(this,a,i);this._initQueueProps[a]=this._curQueueProps[a]=void 0===i?null:i}for(a in t){i=this._curQueueProps[a];if(e=n._plugins[a])for(s=s||{},r=0,o=e.length;r<o;r++)e[r].step&&e[r].step(this,a,i,t[a],s);this._curQueueProps[a]=t[a]}s&&this._appendQueueProps(s);return this._curQueueProps};n.prototype._addAction=function(t){t.t=this.duration;this._actions.push(t);return this};n.prototype._set=function(t,e){for(var i in t)e[i]=t[i]};n.prototype.wait=function(t,e){if(null==t||0>=t)return this;var i=this._cloneProps(this._curQueueProps);return this._addStep({d:t,p0:i,p1:i,v:e})};n.prototype.to=function(t,e,i){"undefined"===typeof i&&(i=void 0);if(isNaN(e)||0>e)e=0;return this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:i,p1:this._cloneProps(this._appendQueueProps(t))})};n.prototype.call=function(t,e,i){"undefined"===typeof e&&(e=void 0);"undefined"===typeof i&&(i=void 0);return this._addAction({f:t,p:i?i:[],o:e?e:this._target})};n.prototype.set=function(t,e){"undefined"===typeof e&&(e=null);return this._addAction({f:this._set,o:this,p:[t,e?e:this._target]})};n.prototype.play=function(t){t||(t=this);return this.call(t.setPaused,t,[!1])};n.prototype.pause=function(t){t||(t=this);return this.call(t.setPaused,t,[!0])};n.prototype.tick=function(t){this.paused||this.setPosition(this._prevPosition+t)};n.NONE=0;n.LOOP=1;n.REVERSE=2;n._tweens=[];n.IGNORE={};n._plugins={};n._inited=!1;return n}(e.EventDispatcher);e.Tween=i;i.prototype.__class__="egret.Tween"})(egret||(egret={}));(function(t){var e=function(){function e(){t.Logger.fatal("Ease不能被实例化")}e.get=function(t){-1>t&&(t=-1);1<t&&(t=1);return function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))
}};e.getPowIn=function(t){return function(e){return Math.pow(e,t)}};e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}};e.getPowInOut=function(t){return function(e){return 1>(e*=2)?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}};e.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)};e.sineOut=function(t){return Math.sin(t*Math.PI/2)};e.sineInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)};e.getBackIn=function(t){return function(e){return e*e*((t+1)*e-t)}};e.getBackOut=function(t){return function(e){e-=1;return e*e*((t+1)*e+t)+1}};e.getBackInOut=function(t){t*=1.525;return function(e){return 1>(e*=2)?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)}};e.circIn=function(t){return-(Math.sqrt(1-t*t)-1)};e.circOut=function(t){return Math.sqrt(1-t*t)};e.circInOut=function(t){return 1>(t*=2)?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)};e.bounceIn=function(t){return 1-e.bounceOut(1-t)};e.bounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375};e.bounceInOut=function(t){return.5>t?.5*e.bounceIn(2*t):.5*e.bounceOut(2*t-1)+.5};e.getElasticIn=function(t,e){var i=2*Math.PI;return function(n){if(0==n||1==n)return n;var r=e/i*Math.asin(1/t);return-(t*Math.pow(2,10*(n-=1))*Math.sin((n-r)*i/e))}};e.getElasticOut=function(t,e){var i=2*Math.PI;return function(n){if(0==n||1==n)return n;var r=e/i*Math.asin(1/t);return t*Math.pow(2,-10*n)*Math.sin((n-r)*i/e)+1}};e.getElasticInOut=function(t,e){var i=2*Math.PI;return function(n){var r=e/i*Math.asin(1/t);return 1>(n*=2)?-.5*t*Math.pow(2,10*(n-=1))*Math.sin((n-r)*i/e):t*Math.pow(2,-10*(n-=1))*Math.sin((n-r)*i/e)*.5+1}};e.quadIn=e.getPowIn(2);e.quadOut=e.getPowOut(2);e.quadInOut=e.getPowInOut(2);e.cubicIn=e.getPowIn(3);e.cubicOut=e.getPowOut(3);e.cubicInOut=e.getPowInOut(3);e.quartIn=e.getPowIn(4);e.quartOut=e.getPowOut(4);e.quartInOut=e.getPowInOut(4);e.quintIn=e.getPowIn(5);e.quintOut=e.getPowOut(5);e.quintInOut=e.getPowInOut(5);e.backIn=e.getBackIn(1.7);e.backOut=e.getBackOut(1.7);e.backInOut=e.getBackInOut(1.7);e.elasticIn=e.getElasticIn(1,.3);e.elasticOut=e.getElasticOut(1,.3);e.elasticInOut=e.getElasticInOut(1,.3*1.5);return e}();t.Ease=e;e.prototype.__class__="egret.Ease"})(egret);(function(t){var e=function(){function t(){}t.prototype.play=function(t){"undefined"===typeof t&&(t=!1);var e=this.audio;e&&(isNaN(e.duration)||(e.currentTime=0),e.loop=t,e.play())};t.prototype.pause=function(){var t=this.audio;t&&t.pause()};t.prototype.load=function(){var t=this.audio;t&&t.load()};t.prototype.addEventListener=function(t,e){this.audio&&this.audio.addEventListener(t,e,!1)};t.prototype.removeEventListener=function(t,e){this.audio&&this.audio.removeEventListener(t,e,!1)};t.prototype.setVolume=function(t){var e=this.audio;e&&(e.volume=t)};t.prototype.getVolume=function(){return this.audio?this.audio.volume:0};return t}();t.Sound=e;e.prototype.__class__="egret.Sound"})(egret);(function(t){var e=function(){function t(){}t.isNumber=function(t){return"number"===typeof t&&!isNaN(t)};return t}();t.NumberUtils=e;e.prototype.__class__="egret.NumberUtils"})(egret);var t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i},n;(function(e){var i=function(e){function i(t,i,n){"undefined"===typeof i&&(i=!1);"undefined"===typeof n&&(n=!1);e.call(this,t,i,n);this.itemsTotal=this.itemsLoaded=0}t(i,e);i.dispatchResourceEvent=function(t,e,n,r,o,s){"undefined"===typeof n&&(n="");"undefined"===typeof r&&(r=null);"undefined"===typeof o&&(o=0);"undefined"===typeof s&&(s=0);var a=egret.Event._getPropertyData(i);a.groupName=n;a.resItem=r;a.itemsLoaded=o;a.itemsTotal=s;egret.Event._dispatchByTarget(i,t,e,a)};i.ITEM_LOAD_ERROR="itemLoadError";i.CONFIG_COMPLETE="configComplete";i.GROUP_PROGRESS="groupProgress";i.GROUP_COMPLETE="groupComplete";return i}(egret.Event);e.ResourceEvent=i;i.prototype.__class__="RES.ResourceEvent"})(n||(n={}));(function(t){var e=function(){function t(t,e,i){this._loaded=!1;this.name=t;this.url=e;this.type=i}Object.defineProperty(t.prototype,"loaded",{get:function(){return this.data?this.data.loaded:this._loaded},set:function(t){this.data&&(this.data.loaded=t);this._loaded=t},enumerable:!0,configurable:!0});t.prototype.toString=function(){return'[ResourceItem name="'+this.name+'" url="'+this.url+'" type="'+this.type+'"]'};t.TYPE_XML="xml";t.TYPE_IMAGE="image";t.TYPE_BIN="bin";t.TYPE_TEXT="text";t.TYPE_JSON="json";t.TYPE_SHEET="sheet";t.TYPE_FONT="font";t.TYPE_SOUND="sound";return t}();t.ResourceItem=e;e.prototype.__class__="RES.ResourceItem"})(n||(n={}));(function(t){var e=function(){function e(){this.keyMap={};this.groupDic={}}e.prototype.getGroupByName=function(t){var e=[];if(!this.groupDic[t])return e;t=this.groupDic[t];for(var i=t.length,n=0;n<i;n++)e.push(this.parseResourceItem(t[n]));return e};e.prototype.getRawGroupByName=function(t){return this.groupDic[t]?this.groupDic[t]:[]};e.prototype.createGroup=function(t,e,i){"undefined"===typeof i&&(i=!1);if(!i&&this.groupDic[t]||!e||0==e.length)return!1;i=this.groupDic;for(var n=[],r=e.length,o=0;o<r;o++){var s=e[o],a=i[s];if(a)for(var s=a.length,h=0;h<s;h++){var c=a[h];-1==n.indexOf(c)&&n.push(c)}else(c=this.keyMap[s])&&-1==n.indexOf(c)&&n.push(c)}if(0==n.length)return!1;this.groupDic[t]=n;return!0};e.prototype.parseConfig=function(t,e){if(t){var i=t.resources;if(i)for(var n=i.length,r=0;r<n;r++){var o=i[r],s=o.url;s&&-1==s.indexOf("://")&&(o.url=e+s);this.addItemToKeyMap(o)}if(i=t.groups)for(n=i.length,r=0;r<n;r++){for(var s=i[r],a=[],h=s.keys.split(","),c=h.length,u=0;u<c;u++)o=h[u].trim(),(o=this.keyMap[o])&&-1==a.indexOf(o)&&a.push(o);this.groupDic[s.name]=a}}};e.prototype.addItemToKeyMap=function(t){this.keyMap[t.name]||(this.keyMap[t.name]=t);if(t.hasOwnProperty("subkeys")){var e=t.subkeys.split(",");t.subkeys=e;for(var i=e.length,n=0;n<i;n++){var r=e[n];null==this.keyMap[r]&&(this.keyMap[r]=t)}}};e.prototype.getName=function(t){return(t=this.keyMap[t])?t.name:""};e.prototype.getType=function(t){return(t=this.keyMap[t])?t.type:""};e.prototype.getRawResourceItem=function(t){return this.keyMap[t]};e.prototype.getResourceItem=function(t){return(t=this.keyMap[t])?this.parseResourceItem(t):null};e.prototype.parseResourceItem=function(e){var i=new t.ResourceItem(e.name,e.url,e.type);i.data=e;return i};return e}();t.ResourceConfig=e;e.prototype.__class__="RES.ResourceConfig"})(n||(n={}));t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this.thread=2;this.loadingCount=0;this.groupTotalDic={};this.numLoadedDic={};this.itemListDic={};this.priorityQueue={};this.lazyLoadList=[];this.analyzerDic={};this.queueIndex=0}t(n,i);n.prototype.isGroupInLoading=function(t){return void 0!==this.itemListDic[t]};n.prototype.loadGroup=function(t,i,n){"undefined"===typeof n&&(n=0);if(!this.itemListDic[i]&&i)if(t&&0!=t.length){this.priorityQueue[n]?this.priorityQueue[n].push(i):this.priorityQueue[n]=[i];this.itemListDic[i]=t;n=t.length;for(var r=0;r<n;r++)t[r].groupName=i;this.groupTotalDic[i]=t.length;this.numLoadedDic[i]=0;this.next()}else t=new e.ResourceEvent(e.ResourceEvent.GROUP_COMPLETE),t.groupName=i,this.dispatchEvent(t)};n.prototype.loadItem=function(t){this.lazyLoadList.push(t);t.groupName="";this.next()};n.prototype.next=function(){for(;this.loadingCount<this.thread;){var t=this.getOneResourceItem();if(!t)break;this.loadingCount++;if(t.loaded)this.onItemComplete(t);else{var i=this.analyzerDic[t.type];i||(i=this.analyzerDic[t.type]=egret.Injector.getInstance(e.AnalyzerBase,t.type));i.loadFile(t,this.onItemComplete,this)}}};n.prototype.getOneResourceItem=function(){var t=Number.NEGATIVE_INFINITY,e;for(e in this.priorityQueue)t=Math.max(t,e);t=this.priorityQueue[t];if(!t||0==t.length)return 0==this.lazyLoadList.length?null:this.lazyLoadList.pop();e=t.length;for(var i,n=0;n<e;n++){this.queueIndex>=e&&(this.queueIndex=0);i=this.itemListDic[t[this.queueIndex]];if(0<i.length)break;this.queueIndex++}return 0==i.length?null:i.shift()};n.prototype.onItemComplete=function(t){this.loadingCount--;var i=t.groupName;t.loaded||e.ResourceEvent.dispatchResourceEvent(this.resInstance,e.ResourceEvent.ITEM_LOAD_ERROR,i,t);if(i){this.numLoadedDic[i]++;var n=this.numLoadedDic[i],r=this.groupTotalDic[i];e.ResourceEvent.dispatchResourceEvent(this.resInstance,e.ResourceEvent.GROUP_PROGRESS,i,t,n,r);n==r&&(this.removeGroupName(i),delete this.groupTotalDic[i],delete this.numLoadedDic[i],delete this.itemListDic[i],e.ResourceEvent.dispatchResourceEvent(this,e.ResourceEvent.GROUP_COMPLETE,i))}else this.callBack.call(this.resInstance,t);this.next()};n.prototype.removeGroupName=function(t){for(var e in this.priorityQueue){for(var i=this.priorityQueue[e],n=i.length,r=0,o=!1,n=i.length,s=0;s<n;s++){if(i[s]==t){i.splice(r,1);o=!0;break}r++}if(o){0==i.length&&delete this.priorityQueue[e];break}}};return n}(egret.EventDispatcher);e.ResourceLoader=i;i.prototype.__class__="RES.ResourceLoader"})(n||(n={}));t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(){e.call(this)}t(i,e);i.prototype.loadFile=function(t,e,i){};i.prototype.getRes=function(t){};i.prototype.destroyRes=function(t){return!1};i.getStringPrefix=function(t){if(!t)return"";var e=t.indexOf(".");return-1!=e?t.substring(0,e):""};i.getStringTail=function(t){if(!t)return"";var e=t.indexOf(".");return-1!=e?t.substring(e+1):""};return i}(egret.HashObject);e.AnalyzerBase=i;i.prototype.__class__="RES.AnalyzerBase"})(n||(n={}));t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(){e.call(this);this.fileDic={};this.resItemDic=[];this._dataFormat=egret.URLLoaderDataFormat.BINARY;this.recycler=new egret.Recycler}t(i,e);i.prototype.loadFile=function(t,e,i){if(this.fileDic[t.name])e.call(i,t);else{var n=this.getLoader();this.resItemDic[n.hashCode]={item:t,func:e,thisObject:i};n.load(new egret.URLRequest(t.url))}};i.prototype.getLoader=function(){var t=this.recycler.pop();t||(t=new egret.URLLoader,t.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this));t.dataFormat=this._dataFormat;return t};i.prototype.onLoadFinish=function(t){var e=t.target,i=this.resItemDic[e.hashCode];delete this.resItemDic[e.hashCode];this.recycler.push(e);var n=i.item,r=i.func;n.loaded=t.type==egret.Event.COMPLETE;n.loaded&&this.analyzeData(n,e.data);r.call(i.thisObject,n)};i.prototype.analyzeData=function(t,e){var i=t.name;!this.fileDic[i]&&e&&(this.fileDic[i]=e)};i.prototype.getRes=function(t){return this.fileDic[t]};i.prototype.hasRes=function(t){return null!=this.getRes(t)};i.prototype.destroyRes=function(t){return this.fileDic[t]?(delete this.fileDic[t],!0):!1};return i}(e.AnalyzerBase);e.BinAnalyzer=i;i.prototype.__class__="RES.BinAnalyzer"})(n||(n={}));t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(){e.call(this);this._dataFormat=egret.URLLoaderDataFormat.TEXTURE}t(i,e);i.prototype.analyzeData=function(t,e){var i=t.name;!this.fileDic[i]&&e&&(this.fileDic[i]=e,(i=t.data)&&i.scale9grid&&(i=i.scale9grid.split(","),e.scale9Grid=new egret.Rectangle(parseInt(i[0]),parseInt(i[1]),parseInt(i[2]),parseInt(i[3]))))};return i}(e.BinAnalyzer);e.ImageAnalyzer=i;i.prototype.__class__="RES.ImageAnalyzer"})(n||(n={}));t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(){e.call(this);this._dataFormat=egret.URLLoaderDataFormat.TEXT}t(i,e);i.prototype.analyzeData=function(t,e){var i=t.name;if(!this.fileDic[i]&&e)try{this.fileDic[i]=JSON.parse(e)}catch(n){egret.Logger.warning("JSON文件格式不正确: "+t.url)}};return i}(e.BinAnalyzer);e.JsonAnalyzer=i;i.prototype.__class__="RES.JsonAnalyzer"})(n||(n={}));t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(){e.call(this);this._dataFormat=egret.URLLoaderDataFormat.TEXT}t(i,e);return i}(e.BinAnalyzer);e.TextAnalyzer=i;i.prototype.__class__="RES.TextAnalyzer"})(n||(n={}));t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this);this.sheetMap={};this.textureMap={};this._dataFormat=egret.URLLoaderDataFormat.TEXT}t(n,i);n.prototype.getRes=function(t){var i=this.fileDic[t];i||(i=this.textureMap[t]);!i&&(i=e.AnalyzerBase.getStringPrefix(t),i=this.fileDic[i])&&(t=e.AnalyzerBase.getStringTail(t),i=i.getTexture(t));return i};n.prototype.onLoadFinish=function(t){var e=t.target,i=this.resItemDic[e.hashCode];delete this.resItemDic[e.hashCode];this.recycler.push(e);var n=i.item,r=i.func;n.loaded=t.type==egret.Event.COMPLETE;n.loaded&&this.analyzeData(n,e.data);"string"==typeof e.data?(this._dataFormat=egret.URLLoaderDataFormat.TEXTURE,this.loadFile(n,r,i.thisObject),this._dataFormat=egret.URLLoaderDataFormat.TEXT):r.call(i.thisObject,n)};n.prototype.analyzeData=function(t,e){var i=t.name;if(!this.fileDic[i]&&e){var n;if("string"==typeof e){try{n=JSON.parse(e)}catch(r){egret.Logger.warning("JSON文件格式不正确: "+t.url)}n&&(this.sheetMap[i]=n,t.loaded=!1,t.url=this.getRelativePath(t.url,n.file))}else n=this.sheetMap[i],delete this.sheetMap[i],e&&(n=this.parseSpriteSheet(e,n),this.fileDic[i]=n)}};n.prototype.getRelativePath=function(t,e){t=t.split("\\").join("/");var i=t.lastIndexOf("/");return t=-1!=i?t.substring(0,i+1)+e:e};n.prototype.parseSpriteSheet=function(t,e){var i=e.frames;if(!i)return null;var n=new egret.SpriteSheet(t),r=this.textureMap,o;for(o in i){var s=i[o];t=n.createTexture(o,s.x,s.y,s.w,s.h,s.offX,s.offY,s.sourceW,s.sourceH);null==r[o]&&(r[o]=t)}return n};return n}(e.BinAnalyzer);e.SheetAnalyzer=i;i.prototype.__class__="RES.SheetAnalyzer"})(n||(n={}));t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(){e.call(this)}t(i,e);i.prototype.analyzeData=function(t,e){var i=t.name;if(!this.fileDic[i]&&e){var n;"string"==typeof e?(n=e,this.sheetMap[i]=n,t.loaded=!1,t.url=this.getTexturePath(t.url,n)):(n=this.sheetMap[i],delete this.sheetMap[i],e&&(n=new egret.BitmapTextSpriteSheet(e,n),this.fileDic[i]=n))}};i.prototype.getTexturePath=function(t,e){var i="",n=e.split("\n")[2],r=n.indexOf('file="');-1!=r&&(n=n.substring(r+6),r=n.indexOf('"'),i=n.substring(0,r));t=t.split("\\").join("/");r=t.lastIndexOf("/");return t=-1!=r?t.substring(0,r+1)+i:i};return i}(e.SheetAnalyzer);e.FontAnalyzer=i;i.prototype.__class__="RES.FontAnalyzer"})(n||(n={}));t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(){e.call(this);this._dataFormat=egret.URLLoaderDataFormat.SOUND}t(i,e);return i}(e.BinAnalyzer);e.SoundAnalyzer=i;i.prototype.__class__="RES.SoundAnalyzer"})(n||(n={}));t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(e){function i(){e.call(this);this._dataFormat=egret.URLLoaderDataFormat.TEXT}t(i,e);i.prototype.analyzeData=function(t,e){var i=t.name;if(!this.fileDic[i]&&e)try{var n=egret.XML.parse(e);this.fileDic[i]=n}catch(r){}};return i}(e.BinAnalyzer);e.XMLAnalyzer=i;i.prototype.__class__="RES.XMLAnalyzer"})(n||(n={}));t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){e.loadConfig=function(t,e,i){"undefined"===typeof e&&(e="");"undefined"===typeof i&&(i="json");n.loadConfig(t,e,i)};e.loadGroup=function(t,e){"undefined"===typeof e&&(e=0);n.loadGroup(t,e)};e.isGroupLoaded=function(t){return n.isGroupLoaded(t)};e.getGroupByName=function(t){return n.getGroupByName(t)};e.createGroup=function(t,e,i){"undefined"===typeof i&&(i=!1);return n.createGroup(t,e,i)};e.hasRes=function(t){return n.hasRes(t)};e.getRes=function(t){return n.getRes(t)};e.getResAsync=function(t,e,i){n.getResAsync(t,e,i)};e.getResByUrl=function(t,e,i,r){"undefined"===typeof r&&(r="");n.getResByUrl(t,e,i,r)};e.destroyRes=function(t){return n.destroyRes(t)};e.setMaxLoadingThread=function(t){n.setMaxLoadingThread(t)};e.addEventListener=function(t,e,i,r,o){"undefined"===typeof r&&(r=!1);"undefined"===typeof o&&(o=0);n.addEventListener(t,e,i,r,o)};e.removeEventListener=function(t,e,i,r){"undefined"===typeof r&&(r=!1);n.removeEventListener(t,e,i,r)};var i=function(i){function n(){i.call(this);this.analyzerDic={};this.configItemList=[];this.configComplete=this.callLaterFlag=!1;this.loadedGroups=[];this.groupNameList=[];this.asyncDic={};this.init()}t(n,i);n.prototype.getAnalyzerByType=function(t){var i=this.analyzerDic[t];i||(i=this.analyzerDic[t]=egret.Injector.getInstance(e.AnalyzerBase,t));return i};n.prototype.init=function(){egret.Injector.hasMapRule(e.AnalyzerBase,e.ResourceItem.TYPE_BIN)||egret.Injector.mapClass(e.AnalyzerBase,e.BinAnalyzer,e.ResourceItem.TYPE_BIN);egret.Injector.hasMapRule(e.AnalyzerBase,e.ResourceItem.TYPE_IMAGE)||egret.Injector.mapClass(e.AnalyzerBase,e.ImageAnalyzer,e.ResourceItem.TYPE_IMAGE);egret.Injector.hasMapRule(e.AnalyzerBase,e.ResourceItem.TYPE_TEXT)||egret.Injector.mapClass(e.AnalyzerBase,e.TextAnalyzer,e.ResourceItem.TYPE_TEXT);egret.Injector.hasMapRule(e.AnalyzerBase,e.ResourceItem.TYPE_JSON)||egret.Injector.mapClass(e.AnalyzerBase,e.JsonAnalyzer,e.ResourceItem.TYPE_JSON);egret.Injector.hasMapRule(e.AnalyzerBase,e.ResourceItem.TYPE_SHEET)||egret.Injector.mapClass(e.AnalyzerBase,e.SheetAnalyzer,e.ResourceItem.TYPE_SHEET);egret.Injector.hasMapRule(e.AnalyzerBase,e.ResourceItem.TYPE_FONT)||egret.Injector.mapClass(e.AnalyzerBase,e.FontAnalyzer,e.ResourceItem.TYPE_FONT);egret.Injector.hasMapRule(e.AnalyzerBase,e.ResourceItem.TYPE_SOUND)||egret.Injector.mapClass(e.AnalyzerBase,e.SoundAnalyzer,e.ResourceItem.TYPE_SOUND);egret.Injector.hasMapRule(e.AnalyzerBase,e.ResourceItem.TYPE_XML)||egret.Injector.mapClass(e.AnalyzerBase,e.XMLAnalyzer,e.ResourceItem.TYPE_XML);this.resConfig=new e.ResourceConfig;this.resLoader=new e.ResourceLoader;this.resLoader.callBack=this.onResourceItemComp;this.resLoader.resInstance=this;this.resLoader.addEventListener(e.ResourceEvent.GROUP_COMPLETE,this.onGroupComp,this)};n.prototype.loadConfig=function(t,e,i){"undefined"===typeof i&&(i="json");this.configItemList.push({url:t,resourceRoot:e,type:i});this.callLaterFlag||(egret.callLater(this.startLoadConfig,this),this.callLaterFlag=!0)};n.prototype.startLoadConfig=function(){this.callLaterFlag=!1;var t=this.configItemList;this.configItemList=[];this.loadingConfigList=t;for(var i=t.length,r=[],o=0;o<i;o++){var s=t[o],s=new e.ResourceItem(s.url,s.url,s.type);r.push(s)}this.resLoader.loadGroup(r,n.GROUP_CONFIG,Number.MAX_VALUE)};n.prototype.isGroupLoaded=function(t){return-1!=this.loadedGroups.indexOf(t)};n.prototype.getGroupByName=function(t){return this.resConfig.getGroupByName(t)};n.prototype.loadGroup=function(t,e){"undefined"===typeof e&&(e=0);if(-1==this.loadedGroups.indexOf(t)&&!this.resLoader.isGroupInLoading(t))if(this.configComplete){var i=this.resConfig.getGroupByName(t);this.resLoader.loadGroup(i,t,e)}else this.groupNameList.push({name:t,priority:e})};n.prototype.createGroup=function(t,e,i){"undefined"===typeof i&&(i=!1);if(i){var n=this.loadedGroups.indexOf(t);-1!=n&&this.loadedGroups.splice(n,1)}return this.resConfig.createGroup(t,e,i)};n.prototype.onGroupComp=function(t){if(t.groupName==n.GROUP_CONFIG){t=this.loadingConfigList.length;for(var i=0;i<t;i++){var r=this.loadingConfigList[i],o=this.getAnalyzerByType(r.type),s=o.getRes(r.url);o.destroyRes(r.url);this.resConfig.parseConfig(s,r.resourceRoot)}this.configComplete=!0;this.loadingConfigList=null;e.ResourceEvent.dispatchResourceEvent(this,e.ResourceEvent.CONFIG_COMPLETE);r=this.groupNameList;t=r.length;for(i=0;i<t;i++)o=r[i],this.loadGroup(o.name,o.priority);this.groupNameList=[]}else this.loadedGroups.push(t.groupName),this.dispatchEvent(t)};n.prototype.hasRes=function(t){var i=this.resConfig.getType(t);return""==i&&(t=e.AnalyzerBase.getStringPrefix(t),i=this.resConfig.getType(t),""==i)?!1:!0};n.prototype.getRes=function(t){var i=this.resConfig.getType(t);return""==i&&(i=e.AnalyzerBase.getStringPrefix(t),i=this.resConfig.getType(i),""==i)?null:this.getAnalyzerByType(i).getRes(t)};n.prototype.getResAsync=function(t,i,n){var r=this.resConfig.getType(t),o=this.resConfig.getName(t);if(""==r&&(o=e.AnalyzerBase.getStringPrefix(t),r=this.resConfig.getType(o),""==r)){i.call(n,null);return}(r=this.getAnalyzerByType(r).getRes(t))?i.call(n,r):(t={key:t,compFunc:i,thisObject:n},this.asyncDic[o]?this.asyncDic[o].push(t):(this.asyncDic[o]=[t],o=this.resConfig.getResourceItem(o),this.resLoader.loadItem(o)))};n.prototype.getResByUrl=function(t,i,n,r){"undefined"===typeof r&&(r="");if(t){r||(r=this.getTypeByUrl(t));var o=this.getAnalyzerByType(r).getRes(t);o?i.call(n,o):(i={key:t,compFunc:i,thisObject:n},this.asyncDic[t]?this.asyncDic[t].push(i):(this.asyncDic[t]=[i],t=new e.ResourceItem(t,t,r),this.resLoader.loadItem(t)))}else i.call(n,null)};n.prototype.getTypeByUrl=function(t){(t=t.substr(t.lastIndexOf(".")+1))&&(t=t.toLowerCase());switch(t){case e.ResourceItem.TYPE_XML:case e.ResourceItem.TYPE_JSON:case e.ResourceItem.TYPE_SHEET:break;case"png":case"jpg":case"gif":t=e.ResourceItem.TYPE_IMAGE;break;case"fnt":t=e.ResourceItem.TYPE_FONT;break;case"txt":t=e.ResourceItem.TYPE_TEXT;break;case"mp3":case"ogg":case"mpeg":case"wav":case"m4a":case"mp4":case"aiff":case"wma":case"mid":t=e.ResourceItem.TYPE_SOUND;break;default:t=e.ResourceItem.TYPE_BIN}return t};n.prototype.onResourceItemComp=function(t){var e=this.asyncDic[t.name];delete this.asyncDic[t.name];t=this.getAnalyzerByType(t.type);for(var i=e.length,n=0;n<i;n++){var r=e[n],o=t.getRes(r.key);r.compFunc.call(r.thisObject,o)}};n.prototype.destroyRes=function(t){var e=this.resConfig.getRawGroupByName(t);if(e){var i=this.loadedGroups.indexOf(t);-1!=i&&this.loadedGroups.splice(i,1);t=e.length;for(var n=0;n<t;n++){i=e[n];i.loaded=!1;var r=this.getAnalyzerByType(i.type);r.destroyRes(i.name)}return!0}e=this.resConfig.getType(t);if(""==e)return!1;i=this.resConfig.getRawResourceItem(t);i.loaded=!1;r=this.getAnalyzerByType(e);return r.destroyRes(t)};n.prototype.setMaxLoadingThread=function(t){1>t&&(t=1);this.resLoader.thread=t};n.GROUP_CONFIG="RES__CONFIG";return n}(egret.EventDispatcher);i.prototype.__class__="Resource";var n=new i})(n||(n={}));t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t){"undefined"===typeof t&&(t=60);i.call(this);this.frameRate=t;this._time=0;60==t&&(n.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,n.cancelAnimationFrame=window.cancelAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame);n.requestAnimationFrame||(n.requestAnimationFrame=function(e){return window.setTimeout(e,1e3/t)});n.cancelAnimationFrame||(n.cancelAnimationFrame=function(t){return window.clearTimeout(t)});n.instance=this;this.registerListener()}t(n,i);n.prototype.enterFrame=function(){var t=n.instance,i=n._thisObject,r=n._callback,o=e.getTimer();r.call(i,o-t._time);t._time=o;t._requestAnimationId=n.requestAnimationFrame.call(window,n.prototype.enterFrame)};n.prototype.executeMainLoop=function(t,e){n._callback=t;n._thisObject=e;this.enterFrame()};n.prototype.reset=function(){var t=n.instance;t._requestAnimationId&&(t._time=e.getTimer(),n.cancelAnimationFrame.call(window,t._requestAnimationId),t.enterFrame())};n.prototype.registerListener=function(){var t=function(){n.instance.reset()},e=function(){document[i]||t()};window.onfocus=t;window.onblur=function(){};var i,r;"undefined"!==typeof document.hidden?(i="hidden",r="visibilitychange"):"undefined"!==typeof document.mozHidden?(i="mozHidden",r="mozvisibilitychange"):"undefined"!==typeof document.msHidden?(i="msHidden",r="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(i="webkitHidden",r="webkitvisibilitychange");"onpageshow"in window&&"onpagehide"in window&&window.addEventListener("pageshow",t,!1);i&&r&&document.addEventListener(r,e,!1)};return n}(e.DeviceContext);e.HTML5DeviceContext=i;i.prototype.__class__="egret.HTML5DeviceContext"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t){this.canvas=t;this.canvasContext=t.getContext("2d");var e=this.canvasContext.setTransform,n=this;this.canvasContext.setTransform=function(t,i,r,o,s,a){n._matrixA=t;n._matrixB=i;n._matrixC=r;n._matrixD=o;n._matrixTx=s;n._matrixTy=a;e.call(n.canvasContext,t,i,r,o,s,a)};this._matrixA=1;this._matrixC=this._matrixB=0;this._matrixD=1;this._transformTy=this._transformTx=this._matrixTy=this._matrixTx=0;i.call(this)}t(n,i);n.prototype.clearScreen=function(){this.setTransform(e.Matrix.identity.identity());for(var t=e.RenderFilter.getInstance().getDrawAreaList(),i=0,n=t.length;i<n;i++){var r=t[i];this.clearRect(r.x+this._transformTx,r.y+this._transformTy,r.width,r.height)}this.renderCost=0};n.prototype.clearRect=function(t,e,i,n){this.canvasContext.clearRect(t,e,i,n)};n.prototype.drawImage=function(t,n,r,o,s,a,h,c,u){n/=e.MainContext.instance.rendererContext.texture_scale_factor;r/=e.MainContext.instance.rendererContext.texture_scale_factor;o/=e.MainContext.instance.rendererContext.texture_scale_factor;s/=e.MainContext.instance.rendererContext.texture_scale_factor;t=t._bitmapData;a+=this._transformTx;h+=this._transformTy;var p=e.getTimer();this.canvasContext.drawImage(t,n,r,o,s,a,h,c,u);i.prototype.drawImage.call(this,t,n,r,o,s,a,h,c,u);this.renderCost+=e.getTimer()-p};n.prototype.setTransform=function(t){1==t.a&&0==t.b&&0==t.c&&1==t.d&&1==this._matrixA&&0==this._matrixB&&0==this._matrixC&&1==this._matrixD?(this._transformTx=t.tx-this._matrixTx,this._transformTy=t.ty-this._matrixTy):(this._transformTx=this._transformTy=0,this._matrixA==t.a&&this._matrixB==t.b&&this._matrixC==t.c&&this._matrixD==t.d&&this._matrixTx==t.tx&&this._matrixTy==t.ty||this.canvasContext.setTransform(t.a,t.b,t.c,t.d,t.tx,t.ty))};n.prototype.setAlpha=function(t,i){t!=this.canvasContext.globalAlpha&&(this.canvasContext.globalAlpha=t);i?(this.blendValue=i,this.canvasContext.globalCompositeOperation=i):this.blendValue!=e.BlendMode.NORMAL&&(this.blendValue=e.BlendMode.NORMAL,this.canvasContext.globalCompositeOperation=e.BlendMode.NORMAL)};n.prototype.setupFont=function(t){var e=this.canvasContext,i=t.italic?"italic ":"normal ",i=i+(t.bold?"bold ":"normal "),i=i+(t.size+"px "+t.fontFamily);e.font=i;e.textAlign="left";e.textBaseline="middle"};n.prototype.measureText=function(t){return this.canvasContext.measureText(t).width};n.prototype.drawText=function(t,e,n,r,o){var s=t._strokeColorString,a=t.stroke,h=this.canvasContext;h.fillStyle=t._textColorString;h.strokeStyle=s;a&&(h.lineWidth=2*a,h.strokeText(e,n+this._transformTx,r+this._transformTy,o||65535));h.fillText(e,n+this._transformTx,r+this._transformTy,o||65535);i.prototype.drawText.call(this,t,e,n,r,o)};n.prototype.strokeRect=function(t,e,i,n,r){this.canvasContext.strokeStyle=r;this.canvasContext.strokeRect(t,e,i,n)};n.prototype.pushMask=function(t){this.canvasContext.save();this.canvasContext.beginPath();this.canvasContext.rect(t.x+this._transformTx,t.y+this._transformTy,t.width,t.height);this.canvasContext.clip();this.canvasContext.closePath()};n.prototype.popMask=function(){this.canvasContext.restore();this.canvasContext.setTransform(1,0,0,1,0,0)};return n}(e.RendererContext);e.HTML5CanvasRenderer=i;i.prototype.__class__="egret.HTML5CanvasRenderer"})(egret);var r;(function(t){t.beginFill=function(t,i){"undefined"===typeof i&&(i=1);var n="rgba("+(t>>16)+","+((t&65280)>>8)+","+(t&255)+","+i+")";this.fillStyleColor=n;this.commandQueue.push(new e(this._setStyle,this,[n]))};t.drawRect=function(t,i,n,r){this.commandQueue.push(new e(function(t,e,i,n){var r=this.renderContext;this.canvasContext.beginPath();this.canvasContext.rect(r._transformTx+t,r._transformTy+e,i,n);this.canvasContext.closePath()},this,[t,i,n,r]));this._fill()};t.drawCircle=function(t,i,n){this.commandQueue.push(new e(function(t,e,i){var n=this.renderContext;this.canvasContext.beginPath();this.canvasContext.arc(n._transformTx+t,n._transformTy+e,i,0,2*Math.PI);this.canvasContext.closePath()},this,[t,i,n]));this._fill()};t.lineStyle=function(t,i,n,r,o,s,a,h){"undefined"===typeof t&&(t=NaN);"undefined"===typeof i&&(i=0);"undefined"===typeof n&&(n=1);"undefined"===typeof r&&(r=!1);"undefined"===typeof o&&(o="normal");"undefined"===typeof s&&(s=null);"undefined"===typeof a&&(a=null);"undefined"===typeof h&&(h=3);this.strokeStyleColor&&(this.createEndLineCommand(),this.commandQueue.push(this.endLineCommand));this.strokeStyleColor=i="rgba("+(i>>16)+","+((i&65280)>>8)+","+(i&255)+","+n+")";this.commandQueue.push(new e(function(t,e){this.canvasContext.lineWidth=t;this.canvasContext.strokeStyle=e;this.canvasContext.beginPath()},this,[t,i]));"undefined"===typeof this.lineX&&(this.lineY=this.lineX=0);this.moveTo(this.lineX,this.lineY)};t.lineTo=function(t,i){this.commandQueue.push(new e(function(t,e){var i=this.renderContext;this.canvasContext.lineTo(i._transformTx+t,i._transformTy+e)},this,[t,i]));this.lineX=t;this.lineY=i};t.curveTo=function(t,i,n,r){this.commandQueue.push(new e(function(t,e,i,n){var r=this.renderContext;this.canvasContext.quadraticCurveTo(r._transformTx+t,r._transformTy+e,i,n)},this,[t,i,n,r]));this.lineX=n;this.lineY=r};t.moveTo=function(t,i){this.commandQueue.push(new e(function(t,e){var i=this.renderContext;this.canvasContext.moveTo(i._transformTx+t,i._transformTy+e)},this,[t,i]))};t.clear=function(){this.lineY=this.lineX=this.commandQueue.length=0;this.fillStyleColor=this.strokeStyleColor=null};t.createEndFillCommand=function(){this.endFillCommand||(this.endFillCommand=new e(function(){this.canvasContext.fill();this.canvasContext.closePath()},this,null))};t.endFill=function(){null!=this.fillStyleColor&&this._fill();this.fillStyleColor=null};t._fill=function(){this.fillStyleColor&&(this.createEndFillCommand(),this.commandQueue.push(this.endFillCommand))};t.createEndLineCommand=function(){this.endLineCommand||(this.endLineCommand=new e(function(){this.canvasContext.stroke();this.canvasContext.closePath()},this,null))};t._draw=function(t){this.renderContext=t;t=this.canvasContext=this.renderContext.canvasContext;t.save();var e=this.commandQueue.length;this.strokeStyleColor&&0<e&&this.commandQueue[e-1]!=this.endLineCommand&&(this.createEndLineCommand(),this.commandQueue.push(this.endLineCommand),e=this.commandQueue.length);
for(var i=0;i<e;i++){var n=this.commandQueue[i];n.method.apply(n.thisObject,n.args)}t.restore()};var e=function(){return function(t,e,i){this.method=t;this.thisObject=e;this.args=i}}();e.prototype.__class__="Command";t._setStyle=function(t){this.canvasContext.fillStyle=t;this.canvasContext.beginPath()};t.init=function(){for(var e in t)egret.Graphics.prototype[e]=t[e];egret.RendererContext.createRendererContext=function(t){return new egret.HTML5CanvasRenderer(t)}}})(r||(r={}));r.init();t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t){i.call(this);this.size=2e3;this.vertSize=6;this.contextLost=!1;this.glContextId=0;this.currentBlendMode="";this.currentBaseTexture=null;this.currentBatchSize=0;this.maskList=[];this.maskDataFreeList=[];this.canvasContext=document.createElement("canvas").getContext("2d");console.log("使用WebGL模式");this.canvas=t;t.addEventListener("webglcontextlost",this.handleContextLost.bind(this),!1);t.addEventListener("webglcontextrestored",this.handleContextRestored.bind(this),!1);this.projectionX=t.width/2;this.projectionY=-t.height/2;t=6*this.size;this.vertices=new Float32Array(4*this.size*this.vertSize);this.indices=new Uint16Array(t);for(var n=0,r=0;n<t;n+=6,r+=4)this.indices[n+0]=r+0,this.indices[n+1]=r+1,this.indices[n+2]=r+2,this.indices[n+3]=r+0,this.indices[n+4]=r+2,this.indices[n+5]=r+3;this.initWebGL();this.shaderManager=new e.WebGLShaderManager(this.gl);this.worldTransform=new e.Matrix;this.initBlendMode();e.MainContext.instance.addEventListener(e.Event.FINISH_RENDER,this._draw,this);e.TextField.prototype._draw=function(t){this.getDirty()&&(this.cacheAsBitmap=!0);e.DisplayObject.prototype._draw.call(this,t)}}t(n,i);n.prototype.handleContextLost=function(){this.contextLost=!0};n.prototype.handleContextRestored=function(){this.initWebGL();this.shaderManager.setContext(this.gl);this.contextLost=!1};n.prototype.initWebGL=function(){for(var t={stencil:!0},e,i=["experimental-webgl","webgl"],n=0;n<i.length;n++){try{e=this.canvas.getContext(i[n],t)}catch(r){}if(e)break}if(!e)throw Error("当前浏览器不支持webgl");this.setContext(e)};n.prototype.setContext=function(t){this.gl=t;t.id=this.glContextId++;this.vertexBuffer=t.createBuffer();this.indexBuffer=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW);t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW);t.disable(t.DEPTH_TEST);t.disable(t.CULL_FACE);t.enable(t.BLEND);t.colorMask(!0,!0,!0,!0)};n.prototype.initBlendMode=function(){n.blendModesWebGL[e.BlendMode.NORMAL]=[this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA];n.blendModesWebGL[e.BlendMode.ADD]=[this.gl.SRC_ALPHA,this.gl.DST_ALPHA]};n.prototype.start=function(){if(!this.contextLost){var t=this.gl;t.activeTexture(t.TEXTURE0);t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.shaderManager.defaultShader;t.uniform2f(e.projectionVector,this.projectionX,this.projectionY);var i=4*this.vertSize;t.vertexAttribPointer(e.aVertexPosition,2,t.FLOAT,!1,i,0);t.vertexAttribPointer(e.aTextureCoord,2,t.FLOAT,!1,i,8);t.vertexAttribPointer(e.colorAttribute,2,t.FLOAT,!1,i,16)}};n.prototype.clearScreen=function(){var t=this.gl;t.colorMask(!0,!0,!0,!0);for(var i=e.RenderFilter.getInstance().getDrawAreaList(),n=0,r=i.length;n<r;n++){var o=i[n];t.viewport(o.x,o.y,o.width,o.height);t.bindFramebuffer(t.FRAMEBUFFER,null);t.clearColor(0,0,0,0);t.clear(t.COLOR_BUFFER_BIT)}this.renderCost=0};n.prototype.setBlendMode=function(t){t||(t=e.BlendMode.NORMAL);if(this.currentBlendMode!=t){var i=n.blendModesWebGL[t];i&&(this.gl.blendFunc(i[0],i[1]),this.currentBlendMode=t)}};n.prototype.drawImage=function(t,i,n,r,o,s,a,h,c){if(!this.contextLost){var u=e.MainContext.instance.rendererContext.texture_scale_factor;i/=u;n/=u;r/=u;o/=u;this.createWebGLTexture(t);if(t.webGLTexture!==this.currentBaseTexture||this.currentBatchSize>=this.size)this._draw(),this.currentBaseTexture=t.webGLTexture;var p=this.worldTransform,l=p.a,d=p.b,f=p.c,_=p.d,y=p.tx,g=p.ty;0==s&&0==a||p.append(1,0,0,1,s,a);1==r/h&&1==o/c||p.append(h/r,0,0,c/o,0,0);s=p.a;a=p.b;h=p.c;c=p.d;var u=p.tx,m=p.ty;p.a=l;p.b=d;p.c=f;p.d=_;p.tx=y;p.ty=g;l=t._sourceWidth;d=t._sourceHeight;t=r;p=o;i/=l;n/=d;r/=l;o/=d;l=this.vertices;d=4*this.currentBatchSize*this.vertSize;f=this.worldAlpha;l[d++]=u;l[d++]=m;l[d++]=i;l[d++]=n;l[d++]=f;l[d++]=16777215;l[d++]=s*t+u;l[d++]=a*t+m;l[d++]=r+i;l[d++]=n;l[d++]=f;l[d++]=16777215;l[d++]=s*t+h*p+u;l[d++]=c*p+a*t+m;l[d++]=r+i;l[d++]=o+n;l[d++]=f;l[d++]=16777215;l[d++]=h*p+u;l[d++]=c*p+m;l[d++]=i;l[d++]=o+n;l[d++]=f;l[d++]=16777215;this.currentBatchSize++}};n.prototype._draw=function(){if(0!=this.currentBatchSize&&!this.contextLost){var t=e.getTimer();this.start();var i=this.gl;i.bindTexture(i.TEXTURE_2D,this.currentBaseTexture);var n=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);i.bufferSubData(i.ARRAY_BUFFER,0,n);i.drawElements(i.TRIANGLES,6*this.currentBatchSize,i.UNSIGNED_SHORT,0);this.currentBatchSize=0;this.renderCost+=e.getTimer()-t;e.Profiler.getInstance().onDrawImage()}};n.prototype.setTransform=function(t){var e=this.worldTransform;e.a=t.a;e.b=t.b;e.c=t.c;e.d=t.d;e.tx=t.tx;e.ty=t.ty};n.prototype.setAlpha=function(t,e){this.worldAlpha=t;e&&this.setBlendMode(e)};n.prototype.createWebGLTexture=function(t){if(!t.webGLTexture){var e=this.gl;t.webGLTexture=e.createTexture();e.bindTexture(e.TEXTURE_2D,t.webGLTexture);e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t._bitmapData);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.bindTexture(e.TEXTURE_2D,null)}};n.prototype.pushMask=function(t){this._draw();var e=this.gl;0==this.maskList.length&&(e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,1));var i=this.maskDataFreeList.pop();i?(i.x=t.x,i.y=t.y,i.w=t.width,i.h=t.height):i={x:t.x,y:t.y,w:t.width,h:t.height};this.maskList.push(i);e.colorMask(!1,!1,!1,!1);e.stencilOp(e.KEEP,e.KEEP,e.INCR);this.renderGraphics(i);e.colorMask(!0,!0,!0,!0);e.stencilFunc(e.NOTEQUAL,0,this.maskList.length);e.stencilOp(e.KEEP,e.KEEP,e.KEEP)};n.prototype.popMask=function(){this._draw();var t=this.gl,e=this.maskList.pop();e&&(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),this.renderGraphics(e),t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.NOTEQUAL,0,this.maskList.length),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),this.maskDataFreeList.push(e));0==this.maskList.length&&t.disable(t.STENCIL_TEST)};n.prototype.setupFont=function(t){var e=this.canvasContext,i=t.italic?"italic ":"normal ",i=i+(t.bold?"bold ":"normal "),i=i+(t.size+"px "+t.fontFamily);e.font=i;e.textAlign="left";e.textBaseline="middle"};n.prototype.measureText=function(t){return this.canvasContext.measureText(t).width};n.prototype.renderGraphics=function(t){var e=this.gl,i=this.shaderManager.primitiveShader;this.graphicsPoints?(this.graphicsPoints.length=0,this.graphicsIndices.length=0):(this.graphicsPoints=[],this.graphicsIndices=[],this.graphicsBuffer=e.createBuffer(),this.graphicsIndexBuffer=e.createBuffer());this.updateGraphics(t);this.shaderManager.activateShader(i);e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA);e.uniformMatrix3fv(i.translationMatrix,!1,this.worldTransform.toArray(!0));e.uniform2f(i.projectionVector,this.projectionX,-this.projectionY);e.uniform2f(i.offsetVector,0,0);e.uniform3fv(i.tintColor,[1,1,1]);e.uniform1f(i.alpha,this.worldAlpha);e.bindBuffer(e.ARRAY_BUFFER,this.graphicsBuffer);e.vertexAttribPointer(i.aVertexPosition,2,e.FLOAT,!1,24,0);e.vertexAttribPointer(i.colorAttribute,4,e.FLOAT,!1,24,8);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.graphicsIndexBuffer);e.drawElements(e.TRIANGLE_STRIP,this.graphicsIndices.length,e.UNSIGNED_SHORT,0);this.shaderManager.activateShader(this.shaderManager.defaultShader)};n.prototype.updateGraphics=function(t){var e=this.gl;this.buildRectangle(t);e.bindBuffer(e.ARRAY_BUFFER,this.graphicsBuffer);e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.graphicsPoints),e.STATIC_DRAW);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.graphicsIndexBuffer);e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.graphicsIndices),e.STATIC_DRAW)};n.prototype.buildRectangle=function(t){var e=t.x,i=t.y,n=t.w;t=t.h;var r=this.graphicsPoints,o=this.graphicsIndices,s=r.length/6;r.push(e,i);r.push(0,0,0,1);r.push(e+n,i);r.push(0,0,0,1);r.push(e,i+t);r.push(0,0,0,1);r.push(e+n,i+t);r.push(0,0,0,1);o.push(s,s,s+1,s+2,s+3,s+3)};n.blendModesWebGL={};return n}(e.RendererContext);e.WebGLRenderer=i;i.prototype.__class__="egret.WebGLRenderer"})(egret);(function(t){var e=function(){function t(){}t.compileProgram=function(e,i,n){n=t.compileFragmentShader(e,n);i=t.compileVertexShader(e,i);var r=e.createProgram();e.attachShader(r,i);e.attachShader(r,n);e.linkProgram(r);e.getProgramParameter(r,e.LINK_STATUS)||console.log("无法初始化着色器");return r};t.compileFragmentShader=function(e,i){return t._compileShader(e,i,e.FRAGMENT_SHADER)};t.compileVertexShader=function(e,i){return t._compileShader(e,i,e.VERTEX_SHADER)};t._compileShader=function(t,e,i){i=t.createShader(i);t.shaderSource(i,e);t.compileShader(i);return t.getShaderParameter(i,t.COMPILE_STATUS)?i:(console.log(t.getShaderInfoLog(i)),null)};t.checkCanUseWebGL=function(){if(void 0==t.canUseWebGL)try{var e=document.createElement("canvas");t.canUseWebGL=!!window.WebGLRenderingContext&&!(!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(i){t.canUseWebGL=!1}return t.canUseWebGL};return t}();t.WebGLUtils=e;e.prototype.__class__="egret.WebGLUtils"})(egret);(function(t){var e=function(){function t(t){this.maxAttibs=10;this.attribState=[];this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.setContext(t)}t.prototype.setContext=function(t){this.gl=t;this.primitiveShader=new n(t);this.defaultShader=new i(t);this.activateShader(this.defaultShader)};t.prototype.activateShader=function(t){this.gl.useProgram(t.program);this.setAttribs(t.attributes)};t.prototype.setAttribs=function(t){var e,i;i=this.tempAttribState.length;for(e=0;e<i;e++)this.tempAttribState[e]=!1;i=t.length;for(e=0;e<i;e++)this.tempAttribState[t[e]]=!0;t=this.gl;i=this.attribState.length;for(e=0;e<i;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.tempAttribState[e]?t.enableVertexAttribArray(e):t.disableVertexAttribArray(e))};return t}();t.WebGLShaderManager=e;e.prototype.__class__="egret.WebGLShaderManager";var i=function(){function e(t){this.defaultVertexSrc="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nuniform vec2 offsetVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;\n   vColor = vec4(color * aColor.x, aColor.x);\n}";this.program=null;this.fragmentSrc="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nvoid main(void) {\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;\n}";this.gl=t;this.init()}e.prototype.init=function(){var e=this.gl,i=t.WebGLUtils.compileProgram(e,this.defaultVertexSrc,this.fragmentSrc);e.useProgram(i);this.uSampler=e.getUniformLocation(i,"uSampler");this.projectionVector=e.getUniformLocation(i,"projectionVector");this.offsetVector=e.getUniformLocation(i,"offsetVector");this.dimensions=e.getUniformLocation(i,"dimensions");this.aVertexPosition=e.getAttribLocation(i,"aVertexPosition");this.aTextureCoord=e.getAttribLocation(i,"aTextureCoord");this.colorAttribute=e.getAttribLocation(i,"aColor");-1===this.colorAttribute&&(this.colorAttribute=2);this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];this.program=i};return e}();t.EgretShader=i;i.prototype.__class__="egret.EgretShader";var n=function(){function e(t){this.alpha=this.translationMatrix=this.attributes=this.colorAttribute=this.aVertexPosition=this.tintColor=this.offsetVector=this.projectionVector=this.program=null;this.fragmentSrc="precision mediump float;\nvarying vec4 vColor;\nvoid main(void) {\n   gl_FragColor = vColor;\n}";this.vertexSrc="attribute vec2 aVertexPosition;\nattribute vec4 aColor;\nuniform mat3 translationMatrix;\nuniform vec2 projectionVector;\nuniform vec2 offsetVector;\nuniform float alpha;\nuniform vec3 tint;\nvarying vec4 vColor;\nvoid main(void) {\n   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);\n   v -= offsetVector.xyx;\n   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);\n   vColor = aColor * vec4(tint * alpha, alpha);\n}";this.gl=t;this.init()}e.prototype.init=function(){var e=this.gl,i=t.WebGLUtils.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(i);this.projectionVector=e.getUniformLocation(i,"projectionVector");this.offsetVector=e.getUniformLocation(i,"offsetVector");this.tintColor=e.getUniformLocation(i,"tint");this.aVertexPosition=e.getAttribLocation(i,"aVertexPosition");this.colorAttribute=e.getAttribLocation(i,"aColor");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=e.getUniformLocation(i,"translationMatrix");this.alpha=e.getUniformLocation(i,"alpha");this.program=i};return e}();t.PrimitiveShader=n;n.prototype.__class__="egret.PrimitiveShader"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(){i.call(this)}t(n,i);n.prototype.proceed=function(t){function i(i){e.IOErrorEvent.dispatchIOErrorEvent(t)}function n(i){switch(t.dataFormat){case e.URLLoaderDataFormat.TEXT:t.data=o.responseText;break;case e.URLLoaderDataFormat.VARIABLES:t.data=new e.URLVariables(o.responseText);break;case e.URLLoaderDataFormat.BINARY:t.data=o.response;break;default:t.data=o.responseText}e.callLater(e.Event.dispatchEvent,e.Event,t,e.Event.COMPLETE)}if(t.dataFormat==e.URLLoaderDataFormat.TEXTURE)this.loadTexture(t);else if(t.dataFormat==e.URLLoaderDataFormat.SOUND)this.loadSound(t);else{var r=t._request,o=this.getXHR();o.onerror=i;o.onload=n;o.open(r.method,r.url,!0);this.setResponseType(o,t.dataFormat);r.method!=e.URLRequestMethod.GET&&r.data?r.data instanceof e.URLVariables?(o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(r.data.toString())):(o.setRequestHeader("Content-Type","multipart/form-data"),o.send(r.data)):o.send()}};n.prototype.loadSound=function(t){function i(o){window.clearTimeout(r.__timeoutId);r.removeEventListener("canplaythrough",i,!1);r.removeEventListener("error",n,!1);o=new e.Sound;o.audio=r;t.data=o;e.callLater(e.Event.dispatchEvent,e.Event,t,e.Event.COMPLETE)}function n(o){window.clearTimeout(r.__timeoutId);r.removeEventListener("canplaythrough",i,!1);r.removeEventListener("error",n,!1);e.IOErrorEvent.dispatchIOErrorEvent(t)}var r=new Audio(t._request.url);r.__timeoutId=window.setTimeout(i,100);r.addEventListener("canplaythrough",i,!1);r.addEventListener("error",n,!1);r.load()};n.prototype.getXHR=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")};n.prototype.setResponseType=function(t,i){switch(i){case e.URLLoaderDataFormat.TEXT:case e.URLLoaderDataFormat.VARIABLES:t.responseType=e.URLLoaderDataFormat.TEXT;break;case e.URLLoaderDataFormat.BINARY:t.responseType="arraybuffer";break;default:t.responseType=i}};n.prototype.loadTexture=function(t){var i=t._request,n=new Image;n.crossOrigin="Anonymous";n.onload=function(i){n.onerror=null;n.onload=null;i=new e.Texture;i._setBitmapData(n);t.data=i;e.callLater(e.Event.dispatchEvent,e.Event,t,e.Event.COMPLETE)};n.onerror=function(i){n.onerror=null;n.onload=null;e.IOErrorEvent.dispatchIOErrorEvent(t)};n.src=i.url};return n}(e.NetContext);e.HTML5NetContext=i;i.prototype.__class__="egret.HTML5NetContext"})(egret);t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i};(function(e){var i=function(i){function n(t){i.call(this);this.canvas=t;this._isTouchDown=!1}t(n,i);n.prototype.run=function(){var t=this;window.navigator.msPointerEnabled?(this.canvas.addEventListener("MSPointerDown",function(e){t._onTouchBegin(e);e.stopPropagation();e.preventDefault()},!1),this.canvas.addEventListener("MSPointerMove",function(e){t._onTouchMove(e);e.stopPropagation();e.preventDefault()},!1),this.canvas.addEventListener("MSPointerUp",function(e){t._onTouchEnd(e);e.stopPropagation();e.preventDefault()},!1)):e.MainContext.deviceType==e.MainContext.DEVICE_MOBILE?this.addTouchListener():e.MainContext.deviceType==e.MainContext.DEVICE_PC&&(this.addTouchListener(),this.addMouseListener());window.addEventListener("mousedown",function(e){t.inOutOfCanvas(e)?t.dispatchLeaveStageEvent():t._isTouchDown=!0});window.addEventListener("mouseup",function(e){t._isTouchDown&&t.inOutOfCanvas(e)&&t.dispatchLeaveStageEvent();t._isTouchDown=!1})};n.prototype.addMouseListener=function(){var t=this;this.canvas.addEventListener("mousedown",function(e){t._onTouchBegin(e)});this.canvas.addEventListener("mousemove",function(e){t._onTouchMove(e)});this.canvas.addEventListener("mouseup",function(e){t._onTouchEnd(e)})};n.prototype.addTouchListener=function(){var t=this;this.canvas.addEventListener("touchstart",function(e){for(var i=e.changedTouches.length,n=0;n<i&&n<t.maxTouches;n++)t._onTouchBegin(e.changedTouches[n]);e.stopPropagation();e.preventDefault()},!1);this.canvas.addEventListener("touchmove",function(e){for(var i=e.changedTouches.length,n=0;n<i&&n<t.maxTouches;n++)t._onTouchMove(e.changedTouches[n]);e.stopPropagation();e.preventDefault()},!1);this.canvas.addEventListener("touchend",function(e){for(var i=e.changedTouches.length,n=0;n<i&&n<t.maxTouches;n++)t._onTouchEnd(e.changedTouches[n]);e.stopPropagation();e.preventDefault()},!1);this.canvas.addEventListener("touchcancel",function(e){for(var i=e.changedTouches.length,n=0;n<i&&n<t.maxTouches;n++)t._onTouchEnd(e.changedTouches[n]);e.stopPropagation();e.preventDefault()},!1)};n.prototype.inOutOfCanvas=function(t){t=this.getLocation(this.canvas,t);return 0>t.x||0>t.y||t.x>this.canvas.width||t.y>this.canvas.height?!0:!1};n.prototype.dispatchLeaveStageEvent=function(){e.MainContext.instance.stage.dispatchEventWith(e.Event.LEAVE_STAGE)};n.prototype._onTouchBegin=function(t){var e=this.getLocation(this.canvas,t),i=-1;t.hasOwnProperty("identifier")&&(i=t.identifier);this.onTouchBegan(e.x,e.y,i)};n.prototype._onTouchMove=function(t){var e=this.getLocation(this.canvas,t),i=-1;t.hasOwnProperty("identifier")&&(i=t.identifier);this.onTouchMove(e.x,e.y,i)};n.prototype._onTouchEnd=function(t){var e=this.getLocation(this.canvas,t),i=-1;t.hasOwnProperty("identifier")&&(i=t.identifier);this.onTouchEnd(e.x,e.y,i)};n.prototype.getLocation=function(t,i){var n=document.documentElement,r=window,o,s;"function"===typeof t.getBoundingClientRect?(s=t.getBoundingClientRect(),o=s.left,s=s.top):s=o=0;o+=r.pageXOffset-n.clientLeft;s+=r.pageYOffset-n.clientTop;null!=i.pageX?(n=i.pageX,r=i.pageY):(o-=document.body.scrollLeft,s-=document.body.scrollTop,n=i.clientX,r=i.clientY);var a=e.Point.identity;a.x=(n-o)/e.StageDelegate.getInstance().getScaleX();a.y=(r-s)/e.StageDelegate.getInstance().getScaleY();return a};return n}(e.TouchContext);e.HTML5TouchContext=i;i.prototype.__class__="egret.HTML5TouchContext"})(egret);var o;(function(t){var e=function(){function t(){}t.hitTest=function(t,e){var i=t.getBounds(),n=e.getBounds();i.x=t.x;i.y=t.y;n.x=e.x;n.y=e.y;return i.intersects(n)};return t}();t.GameUtil=e;e.prototype.__class__="utils.GameUtil";t.createBitmapByName=function(t){var e=new egret.Bitmap;t=n.getRes(t);e.texture=t;return e};t.createRectangular=function(t,e,i,n,r,o){"undefined"===typeof t&&(t=0);"undefined"===typeof e&&(e=0);"undefined"===typeof i&&(i=480);"undefined"===typeof n&&(n=640);"undefined"===typeof r&&(r=1);"undefined"===typeof o&&(o=0);var s=new egret.Sprite;s.graphics.beginFill(o,r);s.graphics.drawRect(t,e,i,n);s.graphics.endFill();s.width=i;s.height=n;return s};t.createCircle=function(t,e,i,n,r){"undefined"===typeof t&&(t=0);"undefined"===typeof e&&(e=0);"undefined"===typeof i&&(i=10);"undefined"===typeof n&&(n=1);"undefined"===typeof r&&(r=16777215);var o=new egret.Sprite;o.graphics.beginFill(r,n);o.graphics.drawCircle(t,e,i);o.graphics.endFill();return o};t.createTextLabel=function(t,e,i,n,r,o,s,a,h,c,u,p){"undefined"===typeof e&&(e=0);"undefined"===typeof i&&(i="left");"undefined"===typeof n&&(n="none");"undefined"===typeof r&&(r=14);"undefined"===typeof o&&(o=0);"undefined"===typeof s&&(s=0);"undefined"===typeof a&&(a=0);"undefined"===typeof h&&(h=0);"undefined"===typeof c&&(c=0);"undefined"===typeof u&&(u=0);"undefined"===typeof p&&(p=0);t=new egret.TextField;t.textColor=e;t.textAlign=i;t.text=n;t.size=r;0!=o&&(t.width=o);0!=s&&0!=a&&(t.strokeColor=s,t.stroke=a);t.rotation=u;0!=p&&(t.skewX=p);t.x=h;t.y=c;return t};t.randomInt=function(t,e){if(0>=e-t)return 0;var i=e-t;return Math.floor(Math.random()*i)+t};t.createBitmap=function(t,e,i,n){"undefined"===typeof i&&(i=0);"undefined"===typeof n&&(n=0);var r=new egret.Bitmap;r.texture=t.getTexture(e);r.x=i;r.y=n;return r}})(o||(o={}));var t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i},s=function(e){function i(){e.call(this);this.sprite=new egret.Sprite;this.downBool=!1;this.sprite=o.createCircle(5,5,h.stageWidth/4,1,10427238);this.addChild(this.sprite);this.sprite=o.createCircle(0,0,h.stageWidth/4,1,16777215);this.addChild(this.sprite);var t=new egret.TextField,t=o.createTextLabel(t,7342404,"center","START",60,0,7342404,3,0,0);this.addChild(t);t.x=(this.sprite.width-t.width)/2+this.sprite.x;t.y=(this.sprite.height-t.height)/2+this.sprite.y}t(i,e);i.prototype.down=function(){this.downBool||(this.sprite.x+=5,this.sprite.y+=5,this.downBool=!0)};i.prototype.up=function(){this.downBool&&(this.sprite.x-=5,this.sprite.y-=5,this.downBool=!1)};return i}(egret.Sprite);s.prototype.__class__="StartBtn";var t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i},a=function(e){function i(t,i,n,r,s){"undefined"===typeof t&&(t=400);"undefined"===typeof i&&(i=2);"undefined"===typeof n&&(n=20);"undefined"===typeof r&&(r=16777215);"undefined"===typeof s&&(s=0);e.call(this);t/=n;for(var a=new egret.Sprite,h=1;h<=n;h++)a=1==h||0==h%2||h==n?o.createRectangular(0,0,t,i,1,r):o.createRectangular(0,0,t,i,1,s),this.addChild(a),a.x=(h-1)*t,a.y=0}t(i,e);return i}(egret.Sprite);a.prototype.__class__="DottedLine";var h=function(){function t(){}t.initVar=function(e,i){t.stageWidth=e;t.stageHeight=i};t.setScoreText=function(e){t.score+=e;e=t.score.toString();var i=e.length;console.log(e.length);for(var n="";4>i;)n+="0",i+=1;c.scoreText.text=(n+e).toString()};t.stageWidth=480;t.stageHeight=640;t.score=0;return t}();h.prototype.__class__="Settings";var t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i},c=function(e){function i(){e.call(this);this.GameBg=new egret.Sprite;this.runway=new egret.Sprite;this.nameText=new egret.TextField;this.nameText=o.createTextLabel(this.nameText,16341428,"left","COLOR SQUARE",40,0,16341428,2);this.ui_line=new a(230,5,20,14952082,12587381);this.GameBg=o.createRectangular(0,0,h.stageWidth,h.stageHeight,1,14952082);this.runway=o.createRectangular(0,0,230,h.stageHeight,1,12587381);this.GameBg.width=h.stageWidth;this.GameBg.height=h.stageHeight;i.scoreText=new egret.TextField;i.scoreText=o.createTextLabel(i.scoreText,16341428,"left","0000",130,0,16341428,0,0,0,90);this.addChild(this.GameBg);this.GameBg.touchEnabled=!0;this.GameBg.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this);this.btn_start=new s;this.plan_start(!0)}t(i,e);i.prototype.plan_start=function(t){t?(this.addChild(this.btn_start),this.addChild(this.nameText),this.nameText.x=(h.stageWidth-this.nameText.width)/2,this.nameText.y=100,this.btn_start.width=h.stageWidth/2,this.btn_start.height=h.stageWidth/2,this.btn_start.touchChildren=!1,this.btn_start.x=h.stageWidth/2,this.btn_start.y=this.nameText.y+this.nameText.height+150,this.btn_start.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.start_btn_tap,this),this.btn_start.addEventListener(egret.TouchEvent.TOUCH_END,this.start_btn_end,this),this.btn_start.touchEnabled=!0):(this.btn_start.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.start_btn_tap,this),this.btn_start.removeEventListener(egret.TouchEvent.TOUCH_END,this.start_btn_end,this),this.removeChild(this.btn_start),this.removeChild(this.nameText))};i.prototype.plan_play=function(t){t?(this.addChild(this.runway),this.runway.x=70,this.addChild(this.ui_line),this.ui_line.x=70,this.ui_line.y=50,this.addChild(i.scoreText),i.scoreText.x=450,i.scoreText.y=50):(this.removeChild(this.runway),this.removeChild(this.ui_line))};i.prototype.start_btn_tap=function(t){this.btn_start.down();this.current_btn_name="btn_start"};i.prototype.start_btn_end=function(t){this.plan_start(!1);this.btn_start.up();this.dispatchEvent(new egret.Event("GamePlay",!1,!1));this.plan_play(!0)};i.prototype.onStageTouchEnd=function(t){if(""!=this.current_btn_name)switch(this.current_btn_name){case"btn_start":this.btn_start.up()}};return i}(egret.Sprite);c.prototype.__class__="GameUI";var t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i},u=function(e){function i(t,i,n,r,s,a,h){"undefined"===typeof t&&(t=100);"undefined"===typeof i&&(i=30);"undefined"===typeof n&&(n=1122867);"undefined"===typeof r&&(r=2241348);"undefined"===typeof s&&(s="btn");"undefined"===typeof a&&(a=12);"undefined"===typeof h&&(h=16777215);e.call(this);this.btn=new egret.Sprite;this.btn=o.createRectangular(5,5,t,i,1,r);this.addChild(this.btn);this.btn=o.createRectangular(0,0,t,i,1,n);this.addChild(this.btn);this.text=new egret.TextField;this.text=o.createTextLabel(this.text,h,"left",s,a);this.addChild(this.text);this.text.x=(this.btn.width-this.text.width)/2;this.text.y=(this.btn.height-this.text.height)/2}t(i,e);i.prototype.down=function(){this.btn.x+=5;this.btn.y+=5;this.text.x+=5;this.text.y+=5};i.prototype.up=function(){this.btn.x-=5;this.btn.y-=5;this.text.x-=5;this.text.y-=5};return i}(egret.Sprite);u.prototype.__class__="DrawRectBtn";var t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i},p=function(e){function i(t,i,n){e.call(this);this.colorArray=[16341428,3064569,16777215,7342404];this.boxScale=57.5;this.boxBGcolor=0;this.id=t;this.listId=i;this._index=n;this.boxSprite=new egret.Sprite;this.boxSprite=o.createRectangular(5,5,this.boxScale,this.boxScale,1,this.boxBGcolor);this.boxSprite.alpha=.2;this.addChild(this.boxSprite);this.boxSprite=o.createRectangular(0,0,this.boxScale,this.boxScale,1,this.colorArray[t]);this.addChild(this.boxSprite)}t(i,e);return i}(egret.Sprite);p.prototype.__class__="Box";var t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i},l=function(e){function i(){e.call(this);this.sprite=new egret.Sprite;this.btnIsbool=0;this.sprite=o.createRectangular(0,0,h.stageWidth,h.stageHeight,.3,0);this.addChild(this.sprite);this.sprite=o.createRectangular(5,5,340,300,.4,0);this.sprite.x=(h.stageWidth-this.sprite.width)/2;this.sprite.y=(h.stageHeight-this.sprite.height)/2;this.addChild(this.sprite);this.sprite=o.createRectangular(0,0,340,300,1,14952082);this.addChild(this.sprite);this.sprite.x=(h.stageWidth-this.sprite.width)/2;this.sprite.y=(h.stageHeight-this.sprite.height)/2;var t=new egret.TextField,t=o.createTextLabel(t,16407734,"left","GAME OVER",40);this.addChild(t);t.y=this.sprite.y+20;t.x=this.sprite.x+20;var i=new a(340,4,15,16407734,14952082);this.addChild(i);i.y=t.y+t.height;i.x=this.sprite.x;t=o.createTextLabel(t,16777215,"left",("SCORE:"+h.score).toString(),24);t.x=this.sprite.x+10;t.y=i.y+i.height+30;this.addChild(t);this.rStartBtn=new u(120,50,16777215,10361701,"重来",20,7342404);this.addChild(this.rStartBtn);this.rStartBtn.x=this.sprite.x+30;this.rStartBtn.y=this.sprite.y+this.sprite.height-this.rStartBtn.height-90;this.moreGameBtn=new u(120,50,16777215,10361701,"更多游戏",20,7342404);this.moreGameBtn.x=190;this.moreGameBtn.y=this.rStartBtn.y+70;this.addChild(this.moreGameBtn);this.moreGameBtn.touchEnabled=!0;this.moreGameBtn.addEventListener(egret.TouchEvent.TOUCH_END,function(){window.location.href="http://html5youxi.com"},this);this.shareBtn=new u(120,50,16777215,10361701,"分享",20,7342404);this.addChild(this.shareBtn);this.rStartBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.rStart_being,this);this.shareBtn.x=this.sprite.x+this.sprite.width-this.rStartBtn.width-30;this.shareBtn.y=this.rStartBtn.y;this.touchEnabled=!0;this.addEventListener(egret.TouchEvent.TOUCH_END,this.onPlanEnd,this);this.rStartBtn.touchEnabled=!0;this.shareBtn.touchEnabled=!0;this.rStartBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.rStart_being,this);this.rStartBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.rStartBtn_end,this);this.shareBtn.touchEnabled=!0;this.shareBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.shareBtn_begin,this);this.shareBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.shareBtn_end,this);this.sharPlan=new egret.Sprite;this.sharPlan=o.createRectangular(0,0,h.stageWidth,h.stageHeight,.3,0)}t(i,e);i.prototype.rStartBtn_end=function(t){this.dispatchEvent(new egret.Event("click_rStart",!1,!1))};i.prototype.shareBtn_end=function(t){console.log("cc")};i.prototype.sharBtnClick=function(t){this.removeChild(this.sharPlan)};i.prototype.rStart_being=function(t){this.rStartBtn.down();this.btnIsbool=-1};i.prototype.shareBtn_begin=function(t){t.preventDefault();showshare()};i.prototype.onPlanEnd=function(t){1==this.btnIsbool?this.shareBtn.up():-1==this.btnIsbool&&this.rStartBtn.up();this.btnIsbool=0};return i}(egret.Sprite);l.prototype.__class__="OverPlan";var t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i},d=function(e){function i(){e.call(this);this.btnMask=new egret.Sprite;var t=new egret.Sprite,t=o.createCircle(0,0,40,1,12587381);this.addChild(t);t=new egret.TextField;t=o.createTextLabel(t,16341428,"left","- 3",40,0,16341428,1);this.addChild(t);t.x=-t.width/2;t.y=-t.height/2;this.btnMask=o.createCircle(0,0,40,1,0);this.addChild(this.btnMask);this.btnMask.alpha=0}t(i,e);return i}(egret.Sprite);d.prototype.__class__="ReduceThreeBtn";var t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i},f=function(e){function i(){e.call(this);this.btnMask=new egret.Sprite;var t=new egret.Sprite,t=o.createCircle(0,0,40,1,12587381);this.addChild(t);t=o.createCircle(0,0,30,1,16341428);this.addChild(t);t=o.createCircle(0,0,25,1,12587381);this.addChild(t);t=o.createRectangular(0,0,15,5,1,16341428);this.addChild(t);t.x=10;t.y=-2.5;t=o.createRectangular(0,0,15,5,1,16341428);
this.addChild(t);t.x=-t.width-10;t.y=-2.5;t=o.createRectangular(0,0,15,5,1,16341428);t.rotation=90;this.addChild(t);t.x=2.5;t.y=10;t=o.createRectangular(0,0,15,5,1,16341428);t.rotation=90;t.y=-t.height-20;t.x=2.5;this.addChild(t);t=o.createRectangular(0,0,10,10,1,16341428);this.addChild(t);t.y=-5;t.x=-5;this.btnMask=o.createCircle(0,0,40,1,0);this.addChild(this.btnMask);this.btnMask.alpha=0}t(i,e);return i}(egret.Sprite);f.prototype.__class__="SelectAllBtn";var t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i},_=function(e){function i(){e.call(this);this.btnMask=new egret.Sprite;var t=new egret.Sprite,t=o.createCircle(0,0,40,1,12587381);this.addChild(t);t=new egret.TextField;t=o.createTextLabel(t,16341428,"left","STOP",24,0,16341428,1);this.addChild(t);t.x=-t.width/2;t.y=-t.height/2;this.btnMask=o.createCircle(0,0,40,1,0);this.addChild(this.btnMask);this.btnMask.alpha=0}t(i,e);return i}(egret.Sprite);_.prototype.__class__="StopBtn";var t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i},y=function(e){function i(){e.call(this);this.boxList1=[];this.boxList2=[];this.boxList3=[];this.boxList4=[];this.recycle=[];this.recycleSpeed=2;this.isTap=!1;this.bj=this.sortRun=0}t(i,e);i.prototype.onBoxTap=function(t){if(this.isTap)if(this.SelectAllBool){for(var e=1;5>e;e++)for(var i=this["boxList"+e].length-1;0<=i;i--)this["boxList"+e][i].id==t.target.id&&(this["container_"+e].removeChild(this["boxList"+e][i]),this.recycle.push(this["boxList"+e][i]),this["boxList"+e][i].anchorX=this["boxList"+e][i].anchorY=.5,this.addChild(this["boxList"+e][i]),this["boxList"+e][i].touchEnabled=!1,this["boxList"+e].splice(i,1));this.SelectAllBool=!1}else this.isTap=!1,this.sortRun+=1,this.boxDetection(t.target.id,t.target.listId,t.target._index)};i.prototype.sortBox=function(){for(var t=0,e=1;5>e;e++){for(var i=this["boxList"+e].length-1;0<=i;i--)this["boxList"+e][i]._delete&&(this["container_"+e].removeChild(this["boxList"+e][i]),this.recycle.push(this["boxList"+e][i]),this["boxList"+e][i].anchorX=this["boxList"+e][i].anchorY=.5,this.addChild(this["boxList"+e][i]),this["boxList"+e].splice(i,1),t+=1);this.StopBool||(i=new p(o.randomInt(0,4),e,0),this["boxList"+e].unshift(i),this["container_"+e].addChild(i),i.x=70+57.5*(e-1),i.y=h.stageHeight,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBoxTap,this))}this.StopBool=!1;h.setScoreText(t);this.isTap=!0};i.prototype.GameOver=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onBoxMove,this);this.isTap=!1;this.plan_over(!0);this.SelectAllBool=this.StopBool=!1;this.rtBtn.btnMask.alpha=this.sAllBtn.btnMask.alpha=this.stopBtn.btnMask.alpha=0;console.log("游戏结束");dp_share(h.score)};i.prototype.plan_over=function(t){"undefined"===typeof t&&(t=!0);t?(this.overPlan=new l,this.addChild(this.overPlan),this.overPlan.addEventListener("click_rStart",this.GameRstart,this)):(this.removeChild(this.overPlan),this.overPlan.removeEventListener("click_rStart",this.GameRstart,this),this.overPlan=null)};i.prototype.GameRstart=function(t){this.plan_over(!1);this.dispatchEvent(new egret.Event("GameRstart",!1,!1));this.boxDistory();this.boxInit();c.scoreText.text="0000".toString();h.score=0;console.log("游戏重玩点击")};i.prototype.boxDistory=function(){for(var t=1;5>t;t++)for(var e=this["boxList"+t].length-1;0<=e;e--)this["container_"+t].removeChild(this["boxList"+t][e]),this.recycle.push(this["boxList"+t][e]),this["boxList"+t][e].anchorX=this["boxList"+t][e].anchorY=.5,this.addChild(this["boxList"+t][e]),this["boxList"+t].splice(e,1)};i.prototype.onBoxMove=function(t){if(1<=this.recycle.length){for(t=0;t<this.recycle.length;t++)this.recycle[t].rotation+=this.recycleSpeed,this.recycle[t].y+=this.recycleSpeed,this.recycle[t].y>=h.stageHeight&&(this.removeChild(this.recycle[t]),this.recycle.splice(t,1));this.recycleSpeed+=6}else this.recycleSpeed=2;for(t=4;1<=t;t--)for(var e=0;e<=this["boxList"+t].length-1;e++){if(30>=this["boxList"+t][e].y){this.GameOver();return}this["boxList"+t][e]._index=e;this["boxList"+t][e].y+=(h.stageHeight-57.5*(e+1)-this["boxList"+t][e].y)/2}};i.prototype.onrtBtnTap=function(){console.log("执行！");console.log(this.rtBtn.btnMask.alpha);if(0==this.rtBtn.btnMask.alpha){this.rtBtn.btnMask.alpha=.2;for(var t=1;5>t;t++){var e;3<=this["boxList"+t].length?e=3:e=this["boxList"+t].length;for(var i=e-1;0<=i;i--)this["container_"+t].removeChild(this["boxList"+t][i]),this.recycle.push(this["boxList"+t][i]),this["boxList"+t][i].anchorX=this["boxList"+t][i].anchorY=.5,this.addChild(this["boxList"+t][i]),this["boxList"+t].splice(i,1)}}};i.prototype.onsAllBtnTap=function(){0==this.sAllBtn.btnMask.alpha&&(this.sAllBtn.btnMask.alpha=.2,this.SelectAllBool=!0)};i.prototype.onstopBtnTap=function(){0==this.stopBtn.btnMask.alpha&&(this.stopBtn.btnMask.alpha=.2,this.StopBool=!0)};i.prototype.GameInit=function(){this.container_1=new egret.Sprite;this.addChild(this.container_1);this.container_2=new egret.Sprite;this.addChild(this.container_2);this.container_3=new egret.Sprite;this.addChild(this.container_3);this.container_4=new egret.Sprite;this.addChild(this.container_4);this.rtBtn=new d;this.sAllBtn=new f;this.stopBtn=new _;this.rtBtn.x=this.sAllBtn.x=this.stopBtn.x=390;this.sAllBtn.y=c.scoreText.y+c.scoreText.width+2*this.sAllBtn.height;this.rtBtn.y=this.sAllBtn.y+1.8*this.sAllBtn.height;this.stopBtn.y=this.rtBtn.y+2.2*this.rtBtn.height;this.rtBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onrtBtnTap,this);this.sAllBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onsAllBtnTap,this);this.stopBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onstopBtnTap,this);this.addChild(this.rtBtn);this.addChild(this.sAllBtn);this.addChild(this.stopBtn);this.rtBtn.touchEnabled=!0;this.sAllBtn.touchEnabled=!0;this.stopBtn.touchEnabled=!0;this.boxInit()};i.prototype.boxInit=function(){for(var t=0;3>=t;t++)for(var e=3;0<=e;e--){var i=new p(o.randomInt(0,4),t+1,e);this["boxList"+(t+1)].unshift(i);this["container_"+(t+1)].addChild(i);i.x=70+57.5*t;i.y=h.stageHeight-(e+1)*i.height;i.touchEnabled=!0;i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBoxTap,this)}this.isTap=!0;this.addEventListener(egret.Event.ENTER_FRAME,this.onBoxMove,this)};i.prototype.boxDetection=function(t,e,i){this["boxList"+e][i]._delete=!0;this.bj+=1;i<this["boxList"+e].length-1&&void 0!=this["boxList"+e][i+1]&&this["boxList"+e][i].id==this["boxList"+e][i+1].id&&!this["boxList"+e][i+1]._delete&&(this["boxList"+e][i+1]._delete=!0,this.sortRun+=1,this.boxDetection(this["boxList"+e][i+1].id,e,i+1));1<=i&&null!=this["boxList"+e][i-1]&&this["boxList"+e][i].id==this["boxList"+e][i-1].id&&!this["boxList"+e][i-1]._delete&&(this["boxList"+e][i-1]._delete=!0,this.sortRun+=1,this.boxDetection(this["boxList"+e][i-1].id,e,i-1));2<=e&&null!=this["boxList"+(e-1)][i]&&this["boxList"+e][i].id==this["boxList"+(e-1)][i].id&&!this["boxList"+(e-1)][i]._delete&&(this["boxList"+(e-1)][i]._delete=!0,this.sortRun+=1,this.boxDetection(this["boxList"+(e-1)][i].id,e-1,i));3>=e&&null!=this["boxList"+(e+1)][i]&&this["boxList"+e][i].id==this["boxList"+(e+1)][i].id&&!this["boxList"+(e+1)][i]._delete&&(this.sortRun+=1,this["boxList"+(e+1)][i]._delete=!0,this.boxDetection(this["boxList"+(e+1)][i].id,e+1,i));this.sortRun-=1;0==this.sortRun&&this.sortBox()};return i}(egret.Sprite);y.prototype.__class__="Game";var t=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype;t.prototype=new i},g=function(e){function i(){e.call(this);this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}t(i,e);i.prototype.onAddToStage=function(t){this.GameStart()};i.prototype.GameStart=function(){h.initVar(this.stage.stageWidth,this.stage.stageHeight);this.ui=new c;this.addChild(this.ui);this.game=new y;this.addChild(this.game);this.ui.addEventListener("GamePlay",this.GamePlay,this)};i.prototype.GamePlay=function(){this.game.GameInit()};return i}(egret.DisplayObjectContainer);window["GameApp"]=g;g.prototype.__class__="GameApp"}();